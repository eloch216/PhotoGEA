<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analyzing C3 A-Ci Curves • PhotoGEA</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing C3 A-Ci Curves">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    padding-top: 70px;

    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PhotoGEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/PhotoGEA.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-user-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">User Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-user-guides">
<li><h6 class="dropdown-header" data-toc-skip>ANALYSIS GUIDES</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/analyzing_ball_berry_data.html">Analyzing Ball-Berry Data</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_c3_aci_curves.html">Analyzing C3 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_c4_aci_curves.html">Analyzing C4 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_gm_data.html">Analyzing Mesophyll Conductance Data</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_tdl_data.html">Analyzing TDL Data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>GENERAL PHOTOGEA ADVICE</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/combining_with_other_packages.html">Combining PhotoGEA With Other Packages</a></li>
    <li><a class="dropdown-item" href="../articles/creating_your_own_processing_tools.html">Creating Your Own Processing Tools</a></li>
    <li><a class="dropdown-item" href="../articles/developing_a_data_analysis_pipeline.html">Developing a Data Analysis Pipeline</a></li>
    <li><a class="dropdown-item" href="../articles/working_with_extended_data_frames.html">Working With Extended Data Frames</a></li>
    <li><a class="dropdown-item" href="../articles/frequent_questions.html">Frequently Asked Questions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>GENERAL GAS EXCHANGE ADVICE</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/LI6800_user_constants.html">Guide to Licor LI-6800 User Constants</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/publications.html">Publications</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/eloch216/PhotoGEA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Analyzing C3 A-Ci Curves</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/eloch216/PhotoGEA/blob/main/vignettes/analyzing_c3_aci_curves.Rmd" class="external-link"><code>vignettes/analyzing_c3_aci_curves.Rmd</code></a></small>
      <div class="d-none name"><code>analyzing_c3_aci_curves.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>In this vignette, we will give an example showing how to analyze
C<sub>3</sub><em>A-C<sub>i</sub></em> data using the
<code>PhotoGEA</code> package. The commands in this vignette can be used
to initialize your own script, as described in <a href="#customizing-your-script">Customizing Your Script</a>.</p>
</div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<div class="section level3">
<h3 id="understanding-c3-a-ci-curves">Understanding C<sub>3</sub><em>A-C<sub>i</sub></em> Curves<a class="anchor" aria-label="anchor" href="#understanding-c3-a-ci-curves"></a>
</h3>
<p>An <em>A-C<sub>i</sub> curve</em> (or <em>CO<sub>2</sub> response
curve</em>) is a particular type of gas exchange measurement where a
living leaf is exposed to varying concentrations of CO<sub>2</sub>. For
each CO<sub>2</sub> concentration in the sequence, the net assimilation
rate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>n</mi></msub><annotation encoding="application/x-tex">A_n</annotation></semantics></math>),
stomatal conductance to H<sub>2</sub>O
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mrow><mi>s</mi><mi>w</mi></mrow></msub><annotation encoding="application/x-tex">g_{sw}</annotation></semantics></math>),
intercellular CO<sub>2</sub> concentration
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>),
and other important quantities are measured and recorded. Typically,
other environmental variables such as temperature, humidity, and
incident photosynthetically-active photon flux density (PPFD) are held
constant during the measurement sequence so that changes in assimilation
rates can be attributed to CO<sub>2</sub> alone.</p>
<p>Because of their different cell structures and biochemical pathways,
C<sub>3</sub> and C<sub>4</sub> plants have very different responses to
CO<sub>2</sub>. Here, we will only be discussing C<sub>3</sub>
plants.</p>
<p>The full C<sub>3</sub> photosynthetic pathway is quite complicated,
consisting of at least two hundred individual reactions, each of which
may have an impact on a measured <em>A-C<sub>i</sub></em> curve.
However, simplified models for net CO<sub>2</sub> assimilation are
available and are much easier to understand and work with. These models
tend to be based around Rubisco kinetics, describing how the net
assimilation rate responds to the amount of CO<sub>2</sub> available in
the chloroplast. The most widely-used model is typically referred to as
the <em>Farquhar-von-Caemmerer-Berry</em> model (often shortened to the
<em>FvCB model</em> or <em>Farquhar model</em>) after the three
scientists who first published it. An excellent description of this
model can be found in <em>Biochemical Models of Leaf Photosynthesis</em>
<span class="citation">(<a href="#ref-caemmerer_biochemical_2000">Caemmerer 2000</a>)</span>,
subject to a few additional considerations discussed in <span class="citation">Lochocki and McGrath (<a href="#ref-lochocki_widely_2025">2025</a>)</span>.</p>
<p>This model provides a framework for understanding the changes in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>n</mi></msub><annotation encoding="application/x-tex">A_n</annotation></semantics></math>
that occur as a C<sub>3</sub> leaf is exposed to successively higher
concentrations of CO<sub>2</sub>. Overall, the response to
CO<sub>2</sub> under high light conditions can be divided into three
separate ranges:</p>
<ul>
<li><p>At low levels of CO<sub>2</sub> in the chloroplast,
CO<sub>2</sub> assimilation is primarily limited by Rubisco activity;
the maximum rate of Rubisco activity is denoted by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>c</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">V_{cmax}</annotation></semantics></math>.</p></li>
<li><p>At intermediate levels of CO<sub>2</sub> in the chloroplast,
CO<sub>2</sub> assimilation is primarily limited by the rate of electron
transport going to support RuBP regeneration; the potential rate of
electron transport at a given incident PPFD is denoted by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>.
(Note:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>
is distinct from the maximum rate of electron transport that could be
achieved at <em>any</em> incident PPFD, which is denoted by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>J</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">J_{max}</annotation></semantics></math>.)</p></li>
<li><p>At high levels of CO<sub>2</sub> in the chloroplast,
CO<sub>2</sub> assimilation is primarily limited by triose phosphate
utilization (TPU); the maximum rate of TPU is denoted by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>p</mi></msub><annotation encoding="application/x-tex">T_p</annotation></semantics></math>.</p></li>
</ul>
<p>More specifically, the model provides equations for potential RuBP
carboxylation rates (as catalyzed by Rubisco) that are each limited by
one of three important processes:</p>
<ul>
<li><p>The Rubisco-limited carboxylation rate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>W</mi><mi>c</mi></msub><annotation encoding="application/x-tex">W_c</annotation></semantics></math>).</p></li>
<li><p>The RuBP-regeneration-limited carboxylation rate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>W</mi><mi>j</mi></msub><annotation encoding="application/x-tex">W_j</annotation></semantics></math>).</p></li>
<li><p>The triose-phosphate-utilization-limited carboxylation rate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>W</mi><mi>p</mi></msub><annotation encoding="application/x-tex">W_p</annotation></semantics></math>).</p></li>
</ul>
<p>Each of these rates depend on the CO<sub>2</sub> concentration in the
chloroplast and other factors such as the incident light intensity. The
actual RuBP carboxylation rate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mi>c</mi></msub><annotation encoding="application/x-tex">V_c</annotation></semantics></math>)
for a particular set of conditions is taken to be the smallest of the
three potential rates. Then, the net CO<sub>2</sub> assimilation rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>n</mi></msub><annotation encoding="application/x-tex">A_n</annotation></semantics></math>
can be calculated from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mi>c</mi></msub><annotation encoding="application/x-tex">V_c</annotation></semantics></math>
by including carbon losses due to photorespiration and
non-photorespiratory CO<sub>2</sub> release; the rate of
non-photorespiratory CO<sub>2</sub> release in the light is denoted by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>L</mi></msub><annotation encoding="application/x-tex">R_L</annotation></semantics></math>.
It is also possible to calculate the net assimilation rates
corresponding to each potential carboxylation rate:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>c</mi></msub><annotation encoding="application/x-tex">A_c</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>j</mi></msub><annotation encoding="application/x-tex">A_j</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>p</mi></msub><annotation encoding="application/x-tex">A_p</annotation></semantics></math>.
The plot below illustrates the three different assimilation ranges
observed in a typical high-light <em>A-C<sub>i</sub></em> curve, as
predicted by the FvCB model.</p>
<p><img src="analyzing_c3_aci_curves_files/figure-html/unnamed-chunk-2-1.png" width="720" style="display: block; margin: auto;"></p>
<p>(Note: This figure was generated using the
<code>calculate_c3_assimilation</code> function from the
<code>PhotoGEA</code> package, and it represents the photosynethetic
response of a C<sub>3</sub> leaf according to the FvCB model with
<code>alpha_old</code> = 0.2, <code>J</code> = 170 micromol m^(-2)
s^(-1), <code>RL</code> = 1 micromol m^(-2) s^(-1), <code>Tp</code> =
11.8 , and <code>Vcmax</code> = 100 micromol m^(-2) s^(-1). Temperature
response parameters from <span class="citation">Thomas D. Sharkey et al.
(<a href="#ref-sharkey_fitting_2007">2007</a>)</span> were used for
these calculations.)</p>
<p>Thus, one of the most common reasons to measure an
<em>A-C<sub>i</sub></em> curve is to interpret it in the context of this
model. In other words, by fitting the model’s equations to a measured
curve, it is possible to estimate values for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>J</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">J_{max}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>L</mi></msub><annotation encoding="application/x-tex">R_L</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>p</mi></msub><annotation encoding="application/x-tex">T_p</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>c</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">V_{cmax}</annotation></semantics></math>.
See the documentation for <code>calculate_c3_assimilation</code> for
more information about these important quantities.</p>
</div>
<div class="section level3">
<h3 id="practicalities">Practicalities<a class="anchor" aria-label="anchor" href="#practicalities"></a>
</h3>
<p>There are a few important practicalities to keep in mind when
thinking about CO<sub>2</sub> response curves.</p>
<p>One point is that net assimilation models generally predict the
response of assimilation to the CO<sub>2</sub> concentration in the
chloroplast
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>c</mi></msub><annotation encoding="application/x-tex">C_c</annotation></semantics></math>),
but gas exchange measurements can only determine the CO<sub>2</sub>
concentration in the leaf’s intercellular spaces
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>).
Thus, an extra step is required when interpreting
<em>A-C<sub>i</sub></em> curves. If the mesophyll conductance to
CO<sub>2</sub> diffusion
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mrow><mi>m</mi><mi>c</mi></mrow></msub><annotation encoding="application/x-tex">g_{mc}</annotation></semantics></math>)
is known, then it is possible to calculate values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>c</mi></msub><annotation encoding="application/x-tex">C_c</annotation></semantics></math>
from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>n</mi></msub><annotation encoding="application/x-tex">A_n</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mrow><mi>m</mi><mi>c</mi></mrow></msub><annotation encoding="application/x-tex">g_{mc}</annotation></semantics></math>.
Otherwise, it is typical to assume an infinite mesophyll conductance; in
this case,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>c</mi></msub><mo>=</mo><msub><mi>C</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">C_c = C_i</annotation></semantics></math>,
and the estimated values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>c</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">V_{cmax}</annotation></semantics></math>
and other parameters can be considered to be “effective values”
describing the plant’s response to intercellular CO<sub>2</sub> rather
than the true response to chloroplastic CO<sub>2</sub>.</p>
<p>Another important point is that plants generally do not appreciate
being starved of CO<sub>2</sub>, so it is not usually possible to start
a response curve at low CO<sub>2</sub> and proceed upwards. A more
typical approach is to:</p>
<ol style="list-style-type: decimal">
<li><p>Begin at ambient atmospheric CO<sub>2</sub> levels.</p></li>
<li><p>Decrease towards a low value.</p></li>
<li><p>Return to ambient levels and wait for the plant to reacclimate;
this waiting period is usually accomplished by logging several points at
ambient CO<sub>2</sub> levels.</p></li>
<li><p>Increase to higher values.</p></li>
</ol>
<p>When taking this approach, it therefore becomes necessary to remove
the extra points measured at ambient CO<sub>2</sub> levels and to
reorder the points according to their CO<sub>2</sub> values before
plotting or analyzing them.</p>
<p>Note: while this approach is commonly used, some reasearchers
advocate for starting either at high or low CO<sub>2</sub>, and
continuously decreasing or increasing the CO<sub>2</sub> concentration
<span class="citation">(<a href="#ref-sharkey_is_2019">Thomas D. Sharkey
2019</a>)</span>.</p>
</div>
<div class="section level3">
<h3 id="the-data">The Data<a class="anchor" aria-label="anchor" href="#the-data"></a>
</h3>
<p><em>A-C<sub>i</sub></em> curves are commonly measured using a
portable photosynthesis system such as the Licor Li-6800. These machines
record values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>n</mi></msub><annotation encoding="application/x-tex">A_n</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mrow><mi>s</mi><mi>w</mi></mrow></msub><annotation encoding="application/x-tex">g_{sw}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>,
and many other important quantities. They produce two types of output
files: plain-text and Microsoft Excel. It is often more convenient to
work with the Excel files since the entries can be easily modified (for
example, to remove an extraneous row or add a new column). On the other
hand, it can be more difficult to access the file contents using other
pieces of software such as R. However, the <code>PhotoGEA</code> package
reduces this barrier by including tools for reading Licor Excel files in
R, which will be demonstrated in the following section.</p>
</div>
</div>
<div class="section level2">
<h2 id="loading-packages">Loading Packages<a class="anchor" aria-label="anchor" href="#loading-packages"></a>
</h2>
<p>As always, the first step is to load the packages we will be using.
In addition to <code>PhotoGEA</code>, we will also use the
<code>lattice</code> package for generating plots.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/eloch216/PhotoGEA" class="external-link">PhotoGEA</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lattice.r-forge.r-project.org/" class="external-link">lattice</a></span><span class="op">)</span></span></code></pre></div>
<p>If the <code>lattice</code> package is not installed on your R setup,
you can install it by typing
<code>install.packages('lattice')</code>.</p>
</div>
<div class="section level2">
<h2 id="loading-licor-data">Loading Licor Data<a class="anchor" aria-label="anchor" href="#loading-licor-data"></a>
</h2>
<p>The <code>PhotoGEA</code> package includes two files representing
<em>A-C<sub>i</sub></em> curves measured using two Li-6800 instruments.
The data is stored in Microsoft Excel files, and includes curves
measured from two different crop species (tobacco and soybean) and
several different plots of each. Each curve is a sixteen-point
CO<sub>2</sub> response curve; in other words, the CO<sub>2</sub>
concentration in the air surrounding the leaf was varied, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>n</mi></msub><annotation encoding="application/x-tex">A_n</annotation></semantics></math>
(among other variables) was measured at each CO<sub>2</sub> setpoint.
Although these two files are based on real data, noise was added to it
since it is unpublished.</p>
<p>The files will be stored on your computer somewhere in your R package
installation directory, and full paths to these files can be obtained
with <code>PhotoGEA_example_file_path</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define a vector of paths to the files we wish to load; in this case, we are</span></span>
<span><span class="co"># loading example files included with the PhotoGEA package</span></span>
<span><span class="va">file_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/PhotoGEA_example_file_path.html">PhotoGEA_example_file_path</a></span><span class="op">(</span><span class="st">'c3_aci_1.xlsx'</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/PhotoGEA_example_file_path.html">PhotoGEA_example_file_path</a></span><span class="op">(</span><span class="st">'c3_aci_2.xlsx'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>(<strong>Note:</strong> When loading your own files for analysis, it
is not advisable to use <code>PhotoGEA_example_file_path</code> as we
have done here. Instead, file paths can be directly written, or files
can be chosen using an interactive window. See <a href="#input-files">Input Files</a> below for more information.)</p>
<p>To actually read the data in the files and store them in R objects,
we will use the <code>read_gasex_file</code> function from
<code>PhotoGEA</code>. Since there are multiple files to read, we will
call this function once for each file using <code>lapply</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load each file, storing the result in a list</span></span>
<span><span class="va">licor_exdf_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">file_paths</span>, <span class="kw">function</span><span class="op">(</span><span class="va">fpath</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/read_gasex_file.html">read_gasex_file</a></span><span class="op">(</span><span class="va">fpath</span>, <span class="st">'time'</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>The result from this command is an R list of “extended data frames”
(abbreviated as <code>exdf</code> objects). The <code>exdf</code> class
is a special data structure defined by the <code>PhotoGEA</code>
package. In many ways, an <code>exdf</code> object is equivalent to a
data frame, with the major difference being that an <code>exdf</code>
object includes the units of each column. For more information, type
<code><a href="../reference/exdf.html">?exdf</a></code> in the R terminal to access the built-in help menu
entry, or check out the <a href="working_with_extended_data_frames.html">Working With Extended Data
Frames</a> vignette.</p>
<p>Generally, it is more convenient to work with a single
<code>exdf</code> object rather than a list of them, so our next step
will be to combine the objects in the list. This action can be
accomplished using the <code>rbind</code> function, which combines
table-like objects by their rows; in other words, it stacks two or more
tables vertically. This action only makes sense if the tables have the
same columns, so before we combine the <code>exdf</code> objects, we
should make sure this is the case.</p>
<p>The <code>PhotoGEA</code> package includes a function called
<code>identify_common_columns</code> that can be used to get the names
of all columns that are present in all of the Licor files. Then, we can
extract just those columns, and then combine the <code>exdf</code>
objects into a single one.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the names of all columns that are present in all of the Licor files</span></span>
<span><span class="va">columns_to_keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">identify_common_columns</span>, <span class="va">licor_exdf_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract just these columns</span></span>
<span><span class="va">licor_exdf_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">licor_exdf_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span> , <span class="va">columns_to_keep</span>, <span class="cn">TRUE</span><span class="op">]</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use `rbind` to combine all the data</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">licor_exdf_list</span><span class="op">)</span></span></code></pre></div>
<p>Now we have a single R object called <code>licor_data</code> that
includes all the data from several Licor Excel files. For more
information about consolidating information from multiple files, see the
<em>Common Patterns</em> section of the <a href="working_with_extended_data_frames.html#combining-data-from-several-files">Working
With Extended Data Frames</a> vignette.</p>
</div>
<div class="section level2">
<h2 id="validating-the-data">Validating the Data<a class="anchor" aria-label="anchor" href="#validating-the-data"></a>
</h2>
<p>Before attempting to fit the curves, it is a good idea to do some
basic checks of the data to ensure it is organized properly and that it
was measured properly.</p>
<div class="section level3">
<h3 id="basic-checks">Basic Checks<a class="anchor" aria-label="anchor" href="#basic-checks"></a>
</h3>
<p>First, we should make sure there is a column in the data whose value
uniquely identifies each curve. In this particular data set, several
“user constants” were defined while making the measurements that help to
identify each curve: <code>instrument</code>, <code>species</code>, and
<code>plot</code>. However, neither of these columns alone are
sufficient to uniquely identify each curve. We can solve this issue by
creating a new column that combines the values from each of these:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a new identifier column formatted like `instrument - species - plot`</span></span>
<span><span class="va">licor_data</span><span class="op">[</span> , <span class="st">'curve_identifier'</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">licor_data</span><span class="op">[</span> , <span class="st">'instrument'</span><span class="op">]</span>, <span class="st">'-'</span>, <span class="va">licor_data</span><span class="op">[</span> , <span class="st">'species'</span><span class="op">]</span>, <span class="st">'-'</span>, <span class="va">licor_data</span><span class="op">[</span> , <span class="st">'plot'</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>When measuring response curves (or any other type of gas exchange
data), it is strongly recommended to record key pieces of metadata in
the log files using “user constants,” as was done in this example. For
more information, please see the <a href="LI6800_user_constants.html">Guide to Licor LI-6800 User
Constants</a>, which also includes advice for dealing with data sets
that do not contain such metadata.</p>
<p>The next step is to make sure that this column correctly identifies
each response curve. To do this, we can use the
<code>check_response_curve_data</code> function from
<code>PhotoGEA</code>. Here we will supply the name of a column that
should uniquely identify each response curve
(<code>curve_identifier</code>), the expected number of points in each
curve (<code>16</code>), the name of a “driving” column that should
follow the same sequence in each curve (<code>CO2_r_sp</code>). If the
data passes the checks, this function will have no output and will not
produce any messages. (For more information, see the built-in help menu
entry by typing <code><a href="../reference/check_response_curve_data.html">?check_response_curve_data</a></code>, or visit the <a href="frequent_questions.html">Frequently Asked Questions</a>.)</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make sure the data meets basic requirements</span></span>
<span><span class="fu"><a href="../reference/check_response_curve_data.html">check_response_curve_data</a></span><span class="op">(</span><span class="va">licor_data</span>, <span class="st">'curve_identifier'</span>, <span class="fl">16</span>, <span class="st">'CO2_r_sp'</span><span class="op">)</span></span></code></pre></div>
<p>However, if <code>check_response_curve_data</code> detects an issue,
it will print a helpful message to the R terminal. For example, if we
had specified the wrong number of points or the wrong identifier column,
we would get error messages:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_response_curve_data.html">check_response_curve_data</a></span><span class="op">(</span><span class="va">licor_data</span>, <span class="st">'curve_identifier'</span>, <span class="fl">15</span><span class="op">)</span></span>
<span><span class="co">#&gt;       curve_identifier npts</span></span>
<span><span class="co">#&gt; 1 ripe1 - soybean - 5a   16</span></span>
<span><span class="co">#&gt; 2  ripe1 - tobacco - 1   16</span></span>
<span><span class="co">#&gt; 3  ripe1 - tobacco - 2   16</span></span>
<span><span class="co">#&gt; 4  ripe2 - soybean - 1   16</span></span>
<span><span class="co">#&gt; 5 ripe2 - soybean - 5b   16</span></span>
<span><span class="co">#&gt; 6  ripe2 - tobacco - 4   16</span></span>
<span><span class="co">#&gt; Error in check_response_curve_data(licor_data, "curve_identifier", 15): One or more curves does not have the expected number of points.</span></span>
<span></span>
<span><span class="fu"><a href="../reference/check_response_curve_data.html">check_response_curve_data</a></span><span class="op">(</span><span class="va">licor_data</span>, <span class="st">'species'</span>, <span class="fl">16</span><span class="op">)</span></span>
<span><span class="co">#&gt;   species npts</span></span>
<span><span class="co">#&gt; 1 soybean   48</span></span>
<span><span class="co">#&gt; 2 tobacco   48</span></span>
<span><span class="co">#&gt; Error in check_response_curve_data(licor_data, "species", 16): One or more curves does not have the expected number of points.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="reorganizing-the-data">Reorganizing the Data<a class="anchor" aria-label="anchor" href="#reorganizing-the-data"></a>
</h3>
<p>As discussed in <a href="#practicalities">Practicalities</a>, there
are several repeated points logged at the same CO<sub>2</sub>
concentration, and the points are not logged in order of ascending or
descending concentration. In fact, the sequence of CO<sub>2</sub>
setpoints is as follows:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">licor_data</span><span class="op">[</span><span class="va">licor_data</span><span class="op">[</span>, <span class="st">'curve_identifier'</span><span class="op">]</span> <span class="op">==</span> <span class="st">'ripe2 - soybean - 1'</span>, <span class="st">'CO2_r_sp'</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1]  400  300  200  150  100   75   50   20  400  400  600  800 1000 1200 1500</span></span>
<span><span class="co">#&gt; [16] 1800</span></span></code></pre></div>
<p>The extra recovery points should not be used when plotting or fitting
the curves. Additionally, any plots may look strange if the points are
not ordered by their <code>Ci</code> values.</p>
<p>So, we would like to remove the ninth and tenth points (where the
setpoint has been reset to 400 to allow the leaf to reacclimate to
ambient CO<sub>2</sub> levels), and reorder the data so it is arranged
from low to high values of <code>Ci</code>. This can be done using the
<code>organize_response_curve</code> function from
<code>PhotoGEA</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove points with duplicated `CO2_r_sp` values, reorder by `Ci`, and</span></span>
<span><span class="co"># calculate average values of leaf temperature and Qin</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/organize_response_curve_data.html">organize_response_curve_data</a></span><span class="op">(</span></span>
<span>    <span class="va">licor_data</span>,</span>
<span>    <span class="st">'curve_identifier'</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    <span class="st">'Ci'</span>,</span>
<span>    columns_to_average <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'TleafCnd'</span>, <span class="st">'Qin'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>In this command, we also used the optional
<code>columns_to_average</code> input argument to calculate average
values of leaf temperature and incident PPFD for each curve, which are
attached as new columns called <code>TleafCnd_avg</code> and
<code>Qin_avg</code>, respectively. These will be important later for
calculating values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>J</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">J_{max}</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="plotting-the-a-ci-curves">Plotting the <em>A-C<sub>i</sub></em> Curves<a class="anchor" aria-label="anchor" href="#plotting-the-a-ci-curves"></a>
</h3>
<p>One qualitative way to check the data is to simply create a plot of
the <em>A-C<sub>i</sub></em> curves. In this situation, the
<code>lattice</code> library makes it simple to include each curve as
its own separate subplot of a figure. For example:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot all A-Ci curves in the data set</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">A</span> <span class="op">~</span> <span class="va">Ci</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  data <span class="op">=</span> <span class="va">licor_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'b'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">']'</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Net CO2 assimilation rate ['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">A</span>, <span class="st">']'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_c3_aci_curves_files/figure-html/plot_aci-1.png" width="720" style="display: block; margin: auto;"></p>
<p>Some of these curves look a bit strange, but this is related to the
noise that was intentionally added to the data. Three curves exhibit a
sharp and likely unrealistic downturn in assimilation at their highest
values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>.
These will pose a problem for fitting, and we will remove them later
after making some other quality checks.</p>
</div>
<div class="section level3">
<h3 id="additional-plots-for-qualitative-validation">Additional Plots for Qualitative Validation<a class="anchor" aria-label="anchor" href="#additional-plots-for-qualitative-validation"></a>
</h3>
<p>Sometimes a Licor will override the temperature or humidity controls
while making measurements; in this case, conditions inside the
measurement chamber may not be stable, and we may wish to exclude some
of these points. We can check for these types of issues by making more
plots. In the following sections, we will generate several different
plots to check each curve for quality.</p>
<div class="section level4">
<h4 id="humidity-control">Humidity Control<a class="anchor" aria-label="anchor" href="#humidity-control"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make a plot to check humidity control</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">RHcham</span> <span class="op">+</span> <span class="va">`Humidifier_%`</span> <span class="op">+</span> <span class="va">`Desiccant_%`</span> <span class="op">~</span> <span class="va">Ci</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  data <span class="op">=</span> <span class="va">licor_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'b'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">']'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_c3_aci_curves_files/figure-html/plot_humidity-1.png" width="720" style="display: block; margin: auto;"></p>
<p>Here, <code>Humidifier_%</code> and <code>Desiccant_%</code>
represent the flow from the humidifier and desiccant columns, where a
value of 0 indicates that the valve to the column is fully closed and a
value of 100 indicates that the valve to the column is fully opened.
<code>RHcham</code> represents the relative humidity inside the chamber
as a percentage (in other words, as a value between 0 and 100).</p>
<p>When these curves were measured, a chamber humidity setpoint was
specified. So, when looking at this plot, we should check that the
relative humidity is fairly constant during each curve. Typically, this
should be accompanied by relatively smooth changes in the valve
percentages as they accomodate changes in ambient humidity and leaf
photosynthesis. In this plot, all the data looks good.</p>
</div>
<div class="section level4">
<h4 id="temperature-control">Temperature Control<a class="anchor" aria-label="anchor" href="#temperature-control"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make a plot to check temperature control</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">TleafCnd</span> <span class="op">+</span> <span class="va">Txchg</span> <span class="op">~</span> <span class="va">Ci</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  data <span class="op">=</span> <span class="va">licor_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'b'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">40</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">']'</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Temperature ('</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">TleafCnd</span>, <span class="st">')'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_c3_aci_curves_files/figure-html/plot_temperature-1.png" width="720" style="display: block; margin: auto;"></p>
<p>Here, <code>TleafCnd</code> is the leaf temperature measured using a
thermocouple, and <code>Txchg</code> is the temperature of the heat
exhanger that is used to control the air temperature in the measurement
instrument. When these curves were measured, an exchanger setpoint was
specified. So, when looking at this plot, we should check that
<code>Txchg</code> is constant during each curve and that the leaf
temperature does not vary in an erratic way. In this plot, all the data
looks good.</p>
</div>
<div class="section level4">
<h4 id="co2-control">CO<sub>2</sub> Control<a class="anchor" aria-label="anchor" href="#co2-control"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make a plot to check CO2 control</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">CO2_s</span> <span class="op">+</span> <span class="va">CO2_r</span> <span class="op">+</span> <span class="va">CO2_r_sp</span> <span class="op">~</span> <span class="va">Ci</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  data <span class="op">=</span> <span class="va">licor_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'b'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">']'</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'CO2 concentration ('</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">CO2_r</span>, <span class="st">')'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_c3_aci_curves_files/figure-html/plot_co2-1.png" width="720" style="display: block; margin: auto;"></p>
<p>Here, <code>CO2_s</code> is the CO<sub>2</sub> concentration in the
sample cell, <code>CO2_r</code> is the CO<sub>2</sub> concentration in
the reference cell, and <code>CO2_r_sp</code> is the setpoint for
<code>CO2_r</code>. When these curves were measured, a sequence of
<code>CO2_r</code> values was specified, so, when looking at this plot,
we should check that <code>CO2_r</code> is close to
<code>CO2_r_sp</code>. We also expect that <code>CO2_s</code> should be
a bit lower than <code>CO2_r</code> because the leaf in the sample
chamber is assimilating CO<sub>2</sub>, which should reduce its
concentration in the surrounding air. (An exception to this rule occurs
at very low values of <code>CO2_r_sp</code>, where the leaf actually
releases CO<sub>2</sub>.) In this plot, all the data looks good.</p>
</div>
<div class="section level4">
<h4 id="stability">Stability<a class="anchor" aria-label="anchor" href="#stability"></a>
</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make a plot to check stability criteria</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">`A:OK`</span> <span class="op">+</span> <span class="va">`gsw:OK`</span> <span class="op">+</span> <span class="va">Stable</span> <span class="op">~</span> <span class="va">Ci</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  data <span class="op">=</span> <span class="va">licor_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'b'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">']'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_c3_aci_curves_files/figure-html/plot_stability-1.png" width="720" style="display: block; margin: auto;"></p>
<p>When measuring response curves with a Licor, it is possible to
specify stability criteria for each point in addition to minimum and
maximum wait times. In other words, once the set point for the driving
variable is changed, the machine waits until the stability criteria are
met; there is a minimum waiting period, and also a maximum to prevent
the machine from waiting for too long.</p>
<p>When these curves were measured, stability criteria were supplied for
the net assimilation rate <code>A</code> and the stomatal conductance
<code>gsw</code>. The stability status for each was stored in the log
file because the appropriate logging option for stability was set. Now,
for each point, it is possible to check whether stability was achieved
or whether the point was logged because the maximum waiting period had
been met. If the maximum waiting period is reached and the plant has
still not stabilized, the data point may be unreliable, so it can be
helpful to check this information.</p>
<p>In the plot, <code>A:OK</code> indicates whether <code>A</code> was
stable (0 for no, 1 for yes), <code>gsw:OK</code> indicates whether
<code>gsw</code> was stable (0 for no, 1 for yes), and
<code>Stable</code> indicates the total number of stability conditions
that were met. So, we are looking for points where <code>Stable</code>
is 2. Otherwise, we can check the other traces to see whether
<code>A</code> or <code>gsw</code> was unstable.</p>
<p>Comparing these plots with the ones in <a href="#plotting-the-a-ci-curves">Plotting the <em>A-C<sub>i</sub></em>
Curves</a>, it seems that the unstable points correspond with some of
the “odd-looking” points in the <em>A-C<sub>i</sub></em> curves, so it
is probably a good idea to remove them before fitting the data.</p>
</div>
</div>
<div class="section level3">
<h3 id="cleaning-the-licor-data">Cleaning the Licor Data<a class="anchor" aria-label="anchor" href="#cleaning-the-licor-data"></a>
</h3>
<p>While checking over the plots in the previous sections, two issues
were noticed: (1) some points were logged before stability was achieved
and (2) some curves have strange points at high
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>.
In this section, we will demonstrate how to remove the unstable and
unusual points.</p>
<p>The following command will keep only the points where
<code>Stable</code> is exactly 2; this condition means that all of the
stability criteria were satisfied. Sometimes, following this procedure,
a curve will have very few stable points remaining; it is usually a good
idea to automatically exclude any curve with fewer than three stable
points.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Only keep points where stability was achieved</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="va">licor_data</span><span class="op">[</span><span class="va">licor_data</span><span class="op">[</span>, <span class="st">'Stable'</span><span class="op">]</span> <span class="op">==</span> <span class="fl">2</span>, , <span class="cn">TRUE</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Remove any curves that have fewer than three remaining points</span></span>
<span><span class="va">npts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span><span class="op">(</span><span class="va">licor_data</span>, <span class="va">licor_data</span><span class="op">[</span>, <span class="st">'curve_identifier'</span><span class="op">]</span>, <span class="va">nrow</span><span class="op">)</span></span>
<span><span class="va">ids_to_keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">npts</span><span class="op">[</span><span class="va">npts</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="va">licor_data</span><span class="op">[</span><span class="va">licor_data</span><span class="op">[</span>, <span class="st">'curve_identifier'</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">ids_to_keep</span>, , <span class="cn">TRUE</span><span class="op">]</span></span></code></pre></div>
<p>Next, we can use the <code>remove_points</code> function from
<code>PhotoGEA</code> to exclude the points where there is a decrease in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
at high
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>.
It just so happens that all of these points were measured by the
<code>ripe1</code> instrument and occur at the highest CO<sub>2</sub>
setpoint value, so it is easy to specify them all at once:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove points where `instrument` is `ripe1` and `CO2_r_sp` is 1800</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/remove_points.html">remove_points</a></span><span class="op">(</span></span>
<span>  <span class="va">licor_data</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>instrument <span class="op">=</span> <span class="st">'ripe1'</span>, CO2_r_sp <span class="op">=</span> <span class="fl">1800</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">'exclude'</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="fitting-licor-data">Fitting Licor Data<a class="anchor" aria-label="anchor" href="#fitting-licor-data"></a>
</h2>
<p>Now that we have checked the data quality, we are ready to perform
the fitting. In order to fit the curves, there are several required
pieces of information that are not included in the Licor data files as
produced by the instrument: values of the total pressure and
temperature-dependent values of important photosynthetic parameters such
as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Γ</mi><mo>*</mo></msup><annotation encoding="application/x-tex">\Gamma^*</annotation></semantics></math>.
However, the <code>PhotoGEA</code> package includes two functions to
help with these calculations:
<code>calculate_temperature_response</code> and
<code>calculate_total_pressure</code>. Each of these requires an
<code>exdf</code> object containing Licor data. The units for each
required column will be checked in an attempt to avoid unit-related
errors. More information about these functions can be obtained from the
built-in help system by typing <code><a href="../reference/calculate_total_pressure.html">?calculate_total_pressure</a></code> or
<code><a href="../reference/calculate_total_pressure.html">?calculate_total_pressure</a></code>.</p>
<p>First, we can use <code>calculate_temperature_response</code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate temperature-dependent values of C3 photosynthetic parameters</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_temperature_response.html">calculate_temperature_response</a></span><span class="op">(</span><span class="va">licor_data</span>, <span class="va">c3_temperature_param_sharkey</span><span class="op">)</span></span></code></pre></div>
<p>With this simple command, we have used the leaf temperature from the
Licor file to calculate values of several key C<sub>3</sub>
photosynthetic parameters (Gamma_star_norm, J_norm, Kc_norm, Ko_norm,
RL_norm, Vcmax_norm, gmc_norm, Tp_norm, Gamma_star_at_25, Kc_at_25,
Ko_at_25) according to the temperature response parameters specified in
<span class="citation">Thomas D. Sharkey et al. (<a href="#ref-sharkey_fitting_2007">2007</a>)</span>.</p>
<p>Now we can use <code>calculate_total_pressure</code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate the total pressure in the Licor chamber</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_total_pressure.html">calculate_total_pressure</a></span><span class="op">(</span><span class="va">licor_data</span><span class="op">)</span></span></code></pre></div>
<p>Together, these functions add several new columns to
<code>licor_data</code>, including <code>total_pressure</code>,
<code>Gamma_star</code>, and others. With this information, we are now
ready to perform the fitting procedure.</p>
<p>For this operation, we can use the <code>fit_c3_aci</code> function
from the <code>PhotoGEA</code> package, which fits a single response
curve to extract the values of key photosynthetic parameters. To apply
this function to each curve in a larger data set and then consolidate
the results, we can use it in conjunction with <code>by</code> and
<code>consolidate</code>, which are also part of <code>PhotoGEA</code>.
(For more information about these functions, see the built-in help menu
entries by typing <code><a href="../reference/fit_c3_aci.html">?fit_c3_aci</a></code>, <code><a href="../reference/by.exdf.html">?by.exdf</a></code>, or
<code><a href="../reference/consolidate.html">?consolidate</a></code>, or check out the <em>Common Patterns</em>
section of the <a href="working_with_extended_data_frames.html#processing-multiple-pieces-of-an-extended-data-frame">Working
With Extended Data Frames</a> vignette.) Together, these functions will
split apart the main data using the curve identifier column we defined
before (<a href="#basic-checks">Basic Checks</a>), fit each
<em>A-C<sub>i</sub></em> curve using the FvCB model discussed in <a href="#understanding-c3-a-ci-curves">Understanding C<sub>3</sub><em>A-C<sub>i</sub></em> Curves</a>, and return the resulting parameters
and fits:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The default optimizer uses randomness, so we will set a seed to ensure the</span></span>
<span><span class="co"># results from this fit are always identical</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit the C3 A-Ci curves</span></span>
<span><span class="va">c3_aci_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/consolidate.html">consolidate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span><span class="op">(</span></span>
<span>  <span class="va">licor_data</span>,                       <span class="co"># The `exdf` object containing the curves</span></span>
<span>  <span class="va">licor_data</span><span class="op">[</span>, <span class="st">'curve_identifier'</span><span class="op">]</span>, <span class="co"># A factor used to split `licor_data` into chunks</span></span>
<span>  <span class="va">fit_c3_aci</span>,                       <span class="co"># The function to apply to each chunk of `licor_data`</span></span>
<span>  Ca_atmospheric <span class="op">=</span> <span class="fl">420</span>              <span class="co"># Additional argument passed to `fit_c3_aci`</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Note that in this command, we used the default fitting settings. In
this case, we will vary all five key photosynthetic parameters:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mrow><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msub><annotation encoding="application/x-tex">\alpha_{old}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>L</mi></msub><annotation encoding="application/x-tex">R_L</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>p</mi></msub><annotation encoding="application/x-tex">T_p</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>c</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">V_{cmax}</annotation></semantics></math>.
The mesophyll conductance
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mrow><mi>m</mi><mi>c</mi></mrow></msub><annotation encoding="application/x-tex">g_{mc}</annotation></semantics></math>)
is set to infinity by default, so these fits are made assuming
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>c</mi></msub><mo>=</mo><msub><mi>C</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">C_c = C_i</annotation></semantics></math>,
and hence the estimates of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>c</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">V_{cmax}</annotation></semantics></math>
and other parameters should be considered as “effective” values rather
than chloroplastic values.</p>
<div class="section level3">
<h3 id="viewing-the-fitted-curves">Viewing the Fitted Curves<a class="anchor" aria-label="anchor" href="#viewing-the-fitted-curves"></a>
</h3>
<p>Having made the fits, it is now a good idea to visually check them,
making sure they look reasonable. This can be done using a built-in
plotting function called <code>plot_c3_aci_fit</code>. In addition to
the fitted values of <code>An</code>, the output also includes values of
the potential limiting rates <code>Ac</code>, <code>Aj</code>, and
<code>Ap</code>, as well as the estimated operating point.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the C3 A-Cc fits (including limiting rates)</span></span>
<span><span class="fu"><a href="../reference/plot_c3_aci_fit.html">plot_c3_aci_fit</a></span><span class="op">(</span><span class="va">c3_aci_results</span>, <span class="st">'curve_identifier'</span>, <span class="st">'Ci'</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">80</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_c3_aci_curves_files/figure-html/plot_fits-1.png" width="720" style="display: block; margin: auto;"></p>
<p>In general, these fits look good. There are a few specific things to
notice:</p>
<ul>
<li><p>The fitted values of <code>An</code> closely match the measured
ones. This is a good sign.</p></li>
<li><p>Each curve begins with a Rubisco-limited portion (where
<code>An = Ac</code>). This is expected for light-saturated
<em>A-C<sub>i</sub></em> curves.</p></li>
<li><p>Some curves do not have values of <code>Aj</code>. This means
that no points were identified as being limited by RuBP regeneration. It
is not possible to estimate values of <code>J</code> from such
curves.</p></li>
<li><p>Some curves do not have values of <code>Ap</code>. This means
that no points were identified as being limited by TPU. It is not
possible to estimate values of <code>Tp</code> from such
curves.</p></li>
<li><p>One curve is almost entirely limited by Rubisco activity. Based
on its values of <code>Ci</code>, it seems that this plant’s stomata did
not fully open during the measurement, almost fully restricting the
measured assimilation values to the Rubisco-limited range. For this
curve, the optimizer identified just one point as being
RuBP-regeneration-limited, so the associated value of <code>J</code> may
not be reliable.</p></li>
</ul>
<p>It is typical that some parameters cannot be estimated from some
<em>A-C<sub>i</sub></em> curves. This is an unavoidable consquence of
the inherent variability between plant leaves.</p>
<p>Checking the residuals is also a powerful way to gauge the quality of
a fit. The output from <code>fit_c3_aci</code> includes the residuals
(calculated as <code>A - A_fit</code>) in its output, so it is easy to
plot them:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the residuals</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">A_residuals</span> <span class="op">~</span> <span class="va">Ci</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  data <span class="op">=</span> <span class="va">c3_aci_results</span><span class="op">$</span><span class="va">fits</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'b'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ('</span>, <span class="va">c3_aci_results</span><span class="op">$</span><span class="va">fits</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">')'</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Assimilation rate residual (measured - fitted)\n('</span>, <span class="va">c3_aci_results</span><span class="op">$</span><span class="va">fits</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">A</span>, <span class="st">')'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_c3_aci_curves_files/figure-html/plot_residuals-1.png" width="720" style="display: block; margin: auto;"></p>
<p>A good fit should produce small and randomly-distributed residuals;
here there is no clear pattern to the residuals, so this model is able
to reproduce the measured values well.</p>
</div>
<div class="section level3">
<h3 id="calculating-jmax">Calculating Jmax<a class="anchor" aria-label="anchor" href="#calculating-jmax"></a>
</h3>
<p>The <code>fit_c3_aci</code> function estimates values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>,
but not
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>J</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">J_{max}</annotation></semantics></math>.
However, estimates of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>J</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">J_{max}</annotation></semantics></math>
can be obtained after fitting by applying the
<code>calculate_jmax</code> function to the results from
<code>fit_c3_aci</code>. For more information about this function, see
the built-in help menu entry by typing <code><a href="../reference/calculate_jmax.html">?calculate_jmax</a></code>.</p>
<p>In order to do this, we need values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Q</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><annotation encoding="application/x-tex">Q_{in}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mrow><mi>l</mi><mi>e</mi><mi>a</mi><mi>f</mi></mrow></msub><annotation encoding="application/x-tex">T_{leaf}</annotation></semantics></math>
for each curve. This information is not typically included in a Licor
file, but we calculated average values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Q</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><annotation encoding="application/x-tex">Q_{in}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mrow><mi>l</mi><mi>e</mi><mi>a</mi><mi>f</mi></mrow></msub><annotation encoding="application/x-tex">T_{leaf}</annotation></semantics></math>
in the <a href="#reorganizing-the-data">Reorganizing the Data</a>
section when calling <code>organize_response_curve_data</code>, so this
is taken care of.</p>
<p>It is also necessary to have temperature-dependent values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>J</mi></msub><annotation encoding="application/x-tex">\alpha_J</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>J</mi></msub><annotation encoding="application/x-tex">\theta_J</annotation></semantics></math>,
two parameters related to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>J</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">J_{max}</annotation></semantics></math>.
These can be obtained using the
<code>calculate_temperature_response</code> function, which was also
used in the <a href="#fitting-licor-data">Fitting Licor Data</a> section
above.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate temperature-dependent values of Jmax-related parameters</span></span>
<span><span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_temperature_response.html">calculate_temperature_response</a></span><span class="op">(</span></span>
<span>    <span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span>,</span>
<span>    <span class="va">jmax_temperature_param_bernacchi</span>,</span>
<span>    <span class="st">'TleafCnd_avg'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate Jmax</span></span>
<span><span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_jmax.html">calculate_jmax</a></span><span class="op">(</span><span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span></span></code></pre></div>
<p>With these commands, the <code>parameters</code> element of
<code>c3_aci_results</code> now includes estimates of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>J</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">J_{max}</annotation></semantics></math>.</p>
<p>Be aware that estimates of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>J</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">J_{max}</annotation></semantics></math>
are dependent on the assumed values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>J</mi></msub><annotation encoding="application/x-tex">\alpha_J</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>J</mi></msub><annotation encoding="application/x-tex">\theta_J</annotation></semantics></math>
at 25 degrees C, especially for curves measured at low values of
incident PPFD; see the documentation for <code>calculate_jmax</code> for
more information.</p>
</div>
</div>
<div class="section level2">
<h2 id="examining-the-results">Examining the Results<a class="anchor" aria-label="anchor" href="#examining-the-results"></a>
</h2>
<div class="section level3">
<h3 id="accessing-best-fit-estimates-and-confidence-intervals">Accessing Best-Fit Estimates and Confidence Intervals<a class="anchor" aria-label="anchor" href="#accessing-best-fit-estimates-and-confidence-intervals"></a>
</h3>
<p>Each fit returns best-fit values and confidence limits for each
parameter, which are stored in <code>c3_aci_results$parameters</code>,
another <code>exdf</code> object. For example, we can look at the
estimated
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>
values from each curve as follows:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View values of J from each fit</span></span>
<span><span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'curve_identifier'</span>, <span class="st">'J_at_25_lower'</span>, <span class="st">'J_at_25'</span>, <span class="st">'J_at_25_upper'</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;       curve_identifier J_at_25_lower  J_at_25 J_at_25_upper</span></span>
<span><span class="co">#&gt; 1 ripe1 - soybean - 5a      183.4704       NA           Inf</span></span>
<span><span class="co">#&gt; 2  ripe1 - tobacco - 1      229.6193 236.1173      242.6154</span></span>
<span><span class="co">#&gt; 3  ripe1 - tobacco - 2      201.4352 208.5933      215.7515</span></span>
<span><span class="co">#&gt; 4  ripe2 - soybean - 1      160.3528       NA           Inf</span></span>
<span><span class="co">#&gt; 5 ripe2 - soybean - 5b      152.3077 160.9145      169.5211</span></span>
<span><span class="co">#&gt; 6  ripe2 - tobacco - 4      165.4966       NA           Inf</span></span></code></pre></div>
<p>Here we can see that some curves have an upper limit of infinity
(<code>Inf</code>) and a best-fit value of “not available”
(<code>NA</code>). Comparing this table to the figure showing the fits,
we can see that these are the curves where one or fewer points are
limited by RuBP regeneration. For these curves, values of <code>J</code>
cannot be reliably estimated, so <code>fit_c3_aci</code> returns a value
of <code>NA</code> for <code>J_at_25</code>.</p>
<p>Because the values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>J</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">J_{max}</annotation></semantics></math>
are calculated from the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>
estimates, <code>Jmax_at_25</code> will also be <code>NA</code> whenever
<code>J_at_25</code> is NA:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View values of Jmax from each fit</span></span>
<span><span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'curve_identifier'</span>, <span class="st">'Jmax_at_25_lower'</span>, <span class="st">'Jmax_at_25'</span>, <span class="st">'Jmax_at_25_upper'</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;       curve_identifier Jmax_at_25_lower Jmax_at_25 Jmax_at_25_upper</span></span>
<span><span class="co">#&gt; 1 ripe1 - soybean - 5a         185.2471         NA               NA</span></span>
<span><span class="co">#&gt; 2  ripe1 - tobacco - 1         232.7625   239.5027         246.2574</span></span>
<span><span class="co">#&gt; 3  ripe1 - tobacco - 2         203.6768   211.0427         218.4225</span></span>
<span><span class="co">#&gt; 4  ripe2 - soybean - 1         161.6362         NA               NA</span></span>
<span><span class="co">#&gt; 5 ripe2 - soybean - 5b         153.4441   162.2087         170.9871</span></span>
<span><span class="co">#&gt; 6  ripe2 - tobacco - 4         166.8804         NA               NA</span></span></code></pre></div>
<p>In contrast, each curve has an associated value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>c</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">V_{cmax}</annotation></semantics></math>
with a finite confidence interval:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View values of Vcmax from each fit</span></span>
<span><span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'curve_identifier'</span>, <span class="st">'Vcmax_at_25_lower'</span>, <span class="st">'Vcmax_at_25'</span>, <span class="st">'Vcmax_at_25_upper'</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;       curve_identifier Vcmax_at_25_lower Vcmax_at_25 Vcmax_at_25_upper</span></span>
<span><span class="co">#&gt; 1 ripe1 - soybean - 5a          96.90014   103.76133         111.42324</span></span>
<span><span class="co">#&gt; 2  ripe1 - tobacco - 1         126.18030   133.10357         140.02684</span></span>
<span><span class="co">#&gt; 3  ripe1 - tobacco - 2         104.97289   113.58840         121.19946</span></span>
<span><span class="co">#&gt; 4  ripe2 - soybean - 1         102.25501   109.06224         121.15487</span></span>
<span><span class="co">#&gt; 5 ripe2 - soybean - 5b         105.28778   122.01155         138.73580</span></span>
<span><span class="co">#&gt; 6  ripe2 - tobacco - 4          84.24146    87.79944          91.35828</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualizing-average-best-fit-parameters">Visualizing Average Best-Fit Parameters<a class="anchor" aria-label="anchor" href="#visualizing-average-best-fit-parameters"></a>
</h3>
<p>We can also visualize the best-fit parameters using plots. One way to
do this is by using the <code>barchart_with_errorbars</code> function
from <code>PhotoGEA</code> to create barcharts of the average values for
each species. This function will ignore any <code>NA</code> values from
curves where a parameter could not be reliably estimated, and the error
bars will show the standard error of the mean for each species.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make a barchart showing average Vcmax values</span></span>
<span><span class="fu"><a href="../reference/barchart_with_errorbars.html">barchart_with_errorbars</a></span><span class="op">(</span></span>
<span>  <span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span>, <span class="st">'Vcmax_at_25'</span><span class="op">]</span>,</span>
<span>  <span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span>, <span class="st">'species'</span><span class="op">]</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">180</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">'Species'</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Vcmax at 25 degrees C ('</span>, <span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Vcmax_at_25</span>, <span class="st">')'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_c3_aci_curves_files/figure-html/vcmax_barchart-1.png" width="720" style="display: block; margin: auto;"></p>
<p>Another option is to create box-whisper plots using the
<code>bwplot</code> function from the <code>lattice</code> package:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make a boxplot showing the distribution of Vcmax values</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">bwplot</a></span><span class="op">(</span></span>
<span>  <span class="va">Vcmax_at_25</span> <span class="op">~</span> <span class="va">species</span>,</span>
<span>  data <span class="op">=</span> <span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">180</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">'Species'</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Vcmax at 25 degrees C ('</span>, <span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Vcmax_at_25</span>, <span class="st">')'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_c3_aci_curves_files/figure-html/vcmax_bwplot-1.png" width="720" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="calculating-average-best-fit-parameters">Calculating Average Best-Fit Parameters<a class="anchor" aria-label="anchor" href="#calculating-average-best-fit-parameters"></a>
</h3>
<p>We can also calculate average values and standard errors of the
best-fit parameters for each species using the <code>basic_stats</code>
function from <code>PhotoGEA</code>:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute the average and standard error of each parameter for each species</span></span>
<span><span class="va">c3_aci_averages</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basic_stats.html">basic_stats</a></span><span class="op">(</span><span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span>, <span class="st">'species'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the averages and errors</span></span>
<span><span class="va">columns_to_view</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">'species'</span>,</span>
<span>  <span class="st">'Vcmax_at_25_avg'</span>, <span class="st">'Vcmax_at_25_stderr'</span>,</span>
<span>  <span class="st">'J_at_25_avg'</span>, <span class="st">'J_at_25_stderr'</span>,</span>
<span>  <span class="st">'RL_at_25_avg'</span>, <span class="st">'RL_at_25_stderr'</span>,</span>
<span>  <span class="st">'Tp_at_25_avg'</span>, <span class="st">'Tp_at_25_stderr'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">c3_aci_averages</span><span class="op">[</span> , <span class="va">columns_to_view</span><span class="op">]</span></span>
<span><span class="co">#&gt;   species Vcmax_at_25_avg Vcmax_at_25_stderr J_at_25_avg J_at_25_stderr</span></span>
<span><span class="co">#&gt; 1 soybean        111.6117           5.420409    160.9145             NA</span></span>
<span><span class="co">#&gt; 2 tobacco        111.4971          13.119908    222.3553         13.762</span></span>
<span><span class="co">#&gt;   RL_at_25_avg RL_at_25_stderr Tp_at_25_avg Tp_at_25_stderr</span></span>
<span><span class="co">#&gt; 1     1.938940       0.5729344     9.834033              NA</span></span>
<span><span class="co">#&gt; 2     1.925908       0.1694586    11.178309              NA</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="other-ideas-for-synthesizing-results">Other Ideas for Synthesizing Results<a class="anchor" aria-label="anchor" href="#other-ideas-for-synthesizing-results"></a>
</h3>
<p>Statistical tests to check for differences between groups can be
performed within R using other packages such as <code>onewaytests</code>
or <code>DescTools</code>. Alternatively, the parameter values can be
exported to a comma-separated-value (CSV) file and analyzed in another
software environment like <code>jmp</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="customizing-your-script">Customizing Your Script<a class="anchor" aria-label="anchor" href="#customizing-your-script"></a>
</h2>
<p>Note that most of the commands in this vignette have been written in
a general way so they can be used as the basis for your own analysis
script (see <a href="#commands-from-this-document">Commands From This
Document</a>). In order to use them in your own script, some or all of
the following changes may be required. There may also be others not
specifically mentioned here.</p>
<div class="section level3">
<h3 id="input-files">Input Files<a class="anchor" aria-label="anchor" href="#input-files"></a>
</h3>
<p>The file paths specified in <code>file_paths</code> will need to be
modified so they point to your Licor files. One way to do this in your
own script is to simply write out relative or absolute paths to the
files you wish to load. For example, you could replace the previous
definition of <code>file_paths</code> with this one:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define a vector of paths to the files we wish to load</span></span>
<span><span class="va">file_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">'myfile1.xlsx'</span>,        <span class="co"># `myfile1.xlsx` must be in the current working directory</span></span>
<span>  <span class="st">'C:/documents/myfile2'</span> <span class="co"># This is an absolute path to `myfile2`</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>You may also want to consider using the
<code>choose_input_licor_files</code> function from
<code>PhotoGEA</code>; this function will create a pop-up browser window
where you can interactively select a set of files. Sometimes this is
more convenient than writing out file paths or names. For example, you
could replace the previous definition of <code>file_paths</code> with
this one:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Interactively define a vector of paths to the files we wish to load</span></span>
<span><span class="va">file_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/choose_input_files.html">choose_input_licor_files</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Unfortunately, <code>choose_input_licor_files</code> is only
available in interactive R sessions running on Microsoft Windows, but
there is also a platform-independent option:
<code>choose_input_files</code>. See the <em>Translation</em> section of
the <a href="developing_a_data_analysis_pipeline.html#translation">Developing a
Data Analysis Pipeline</a> vignette for more details.</p>
</div>
<div class="section level3">
<h3 id="curve-identifier">Curve Identifier<a class="anchor" aria-label="anchor" href="#curve-identifier"></a>
</h3>
<p>Depending on which user constants are defined in your Licor Excel
files, you may need to modify the definition of the
<code>curve_identifier</code> column.</p>
</div>
<div class="section level3">
<h3 id="data-cleaning">Data Cleaning<a class="anchor" aria-label="anchor" href="#data-cleaning"></a>
</h3>
<p>Depending on the qualitative data checks, you may need to change the
input arguments to <code>remove_points</code>. It might also not be
necessary to remove the unstable points before performing the fits.
Often, it is helpful to not perform any data cleaning at first, and then
remove problematic points if they seem to cause problems with the
fits.</p>
</div>
<div class="section level3">
<h3 id="plots">Plots<a class="anchor" aria-label="anchor" href="#plots"></a>
</h3>
<p>You may need to change the axis limits in some or all of the plots.
Alternatively, you can remove them, allowing <code>xyplot</code> to
automatically choose them for you.</p>
<p>You may also want to consider using the <code>pdf_print</code>
function from <code>PhotoGEA</code> to save some or all of your plots as
PDFs. See the help page for more info: <code><a href="../reference/pdf_print.html">?pdf_print</a></code>.</p>
</div>
<div class="section level3">
<h3 id="saving-results">Saving Results<a class="anchor" aria-label="anchor" href="#saving-results"></a>
</h3>
<p>You may want to use <code>write.csv.exdf</code> to save some or all
of the fitting results as CSV files. When writing the contents of an
<code>exdf</code> object to a CSV file, using
<code>write.csv.exdf</code> rather than <code>write.csv</code> will
ensure that units are included with each column.</p>
<p>For example, the following commands will allow you to interactively
choose output filenames for the resulting CSV files:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/csv.exdf.html">write.csv.exdf</a></span><span class="op">(</span><span class="va">c3_aci_results</span><span class="op">$</span><span class="va">fits</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.choose.html" class="external-link">file.choose</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/csv.exdf.html">write.csv.exdf</a></span><span class="op">(</span><span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.choose.html" class="external-link">file.choose</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/csv.exdf.html">write.csv.exdf</a></span><span class="op">(</span><span class="va">c3_aci_averages</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.choose.html" class="external-link">file.choose</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="commands-from-this-document">Commands From This Document<a class="anchor" aria-label="anchor" href="#commands-from-this-document"></a>
</h2>
<p>The following code chunk includes all the central commands used
throughout this document. They are compiled here to make them easy to
copy/paste into a text file to initialize your own script. Annotation
has also been added to clearly indicate the four steps involved in data
analysis, as described in the <a href="developing_a_data_analysis_pipeline.html">Developing a Data
Analysis Pipeline</a> vignette.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">###</span></span>
<span><span class="co">### PRELIMINARIES:</span></span>
<span><span class="co">### Loading packages, defining constants, creating helping functions, etc.</span></span>
<span><span class="co">###</span></span>
<span></span>
<span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/eloch216/PhotoGEA" class="external-link">PhotoGEA</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lattice.r-forge.r-project.org/" class="external-link">lattice</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">###</span></span>
<span><span class="co">### TRANSLATION:</span></span>
<span><span class="co">### Creating convenient R objects from raw data files</span></span>
<span><span class="co">###</span></span>
<span></span>
<span><span class="co">## IMPORTANT: When loading your own files, it is not advised to use</span></span>
<span><span class="co">## `PhotoGEA_example_file_path` as in the code below. Instead, write out the</span></span>
<span><span class="co">## names or use the `choose_input_licor_files` function.</span></span>
<span></span>
<span><span class="co"># Define a vector of paths to the files we wish to load; in this case, we are</span></span>
<span><span class="co"># loading example files included with the PhotoGEA package</span></span>
<span><span class="va">file_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/PhotoGEA_example_file_path.html">PhotoGEA_example_file_path</a></span><span class="op">(</span><span class="st">'c3_aci_1.xlsx'</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/PhotoGEA_example_file_path.html">PhotoGEA_example_file_path</a></span><span class="op">(</span><span class="st">'c3_aci_2.xlsx'</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load each file, storing the result in a list</span></span>
<span><span class="va">licor_exdf_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">file_paths</span>, <span class="kw">function</span><span class="op">(</span><span class="va">fpath</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/read_gasex_file.html">read_gasex_file</a></span><span class="op">(</span><span class="va">fpath</span>, <span class="st">'time'</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get the names of all columns that are present in all of the Licor files</span></span>
<span><span class="va">columns_to_keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">identify_common_columns</span>, <span class="va">licor_exdf_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract just these columns</span></span>
<span><span class="va">licor_exdf_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">licor_exdf_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span> , <span class="va">columns_to_keep</span>, <span class="cn">TRUE</span><span class="op">]</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use `rbind` to combine all the data</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">licor_exdf_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co">###</span></span>
<span><span class="co">### VALIDATION:</span></span>
<span><span class="co">### Organizing the data, checking its consistency and quality, cleaning it</span></span>
<span><span class="co">###</span></span>
<span></span>
<span><span class="co"># Create a new identifier column formatted like `instrument - species - plot`</span></span>
<span><span class="va">licor_data</span><span class="op">[</span> , <span class="st">'curve_identifier'</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">licor_data</span><span class="op">[</span> , <span class="st">'instrument'</span><span class="op">]</span>, <span class="st">'-'</span>, <span class="va">licor_data</span><span class="op">[</span> , <span class="st">'species'</span><span class="op">]</span>, <span class="st">'-'</span>, <span class="va">licor_data</span><span class="op">[</span> , <span class="st">'plot'</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make sure the data meets basic requirements</span></span>
<span><span class="fu"><a href="../reference/check_response_curve_data.html">check_response_curve_data</a></span><span class="op">(</span><span class="va">licor_data</span>, <span class="st">'curve_identifier'</span>, <span class="fl">16</span>, <span class="st">'CO2_r_sp'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Remove points with duplicated `CO2_r_sp` values, reorder by `Ci`, and</span></span>
<span><span class="co"># calculate average values of leaf temperature and Qin</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/organize_response_curve_data.html">organize_response_curve_data</a></span><span class="op">(</span></span>
<span>    <span class="va">licor_data</span>,</span>
<span>    <span class="st">'curve_identifier'</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    <span class="st">'Ci'</span>,</span>
<span>    columns_to_average <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'TleafCnd'</span>, <span class="st">'Qin'</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot all A-Ci curves in the data set</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">A</span> <span class="op">~</span> <span class="va">Ci</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  data <span class="op">=</span> <span class="va">licor_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'b'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">']'</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Net CO2 assimilation rate ['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">A</span>, <span class="st">']'</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make a plot to check humidity control</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">RHcham</span> <span class="op">+</span> <span class="va">`Humidifier_%`</span> <span class="op">+</span> <span class="va">`Desiccant_%`</span> <span class="op">~</span> <span class="va">Ci</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  data <span class="op">=</span> <span class="va">licor_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'b'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">']'</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make a plot to check temperature control</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">TleafCnd</span> <span class="op">+</span> <span class="va">Txchg</span> <span class="op">~</span> <span class="va">Ci</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  data <span class="op">=</span> <span class="va">licor_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'b'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">40</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">']'</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Temperature ('</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">TleafCnd</span>, <span class="st">')'</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make a plot to check CO2 control</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">CO2_s</span> <span class="op">+</span> <span class="va">CO2_r</span> <span class="op">+</span> <span class="va">CO2_r_sp</span> <span class="op">~</span> <span class="va">Ci</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  data <span class="op">=</span> <span class="va">licor_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'b'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">']'</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'CO2 concentration ('</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">CO2_r</span>, <span class="st">')'</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make a plot to check stability criteria</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">`A:OK`</span> <span class="op">+</span> <span class="va">`gsw:OK`</span> <span class="op">+</span> <span class="va">Stable</span> <span class="op">~</span> <span class="va">Ci</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  data <span class="op">=</span> <span class="va">licor_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'b'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">']'</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## IMPORTANT: When analyzing your own files, it is not advised to remove any</span></span>
<span><span class="co">## points for the initial fits. Only remove unstable or unusual points if it is</span></span>
<span><span class="co">## necessary in order to get good fits. See the "Cleaning the Licor Data"</span></span>
<span><span class="co">## section above for instructions.</span></span>
<span></span>
<span><span class="co">###</span></span>
<span><span class="co">### PROCESSING:</span></span>
<span><span class="co">### Extracting new pieces of information from the data</span></span>
<span><span class="co">###</span></span>
<span></span>
<span><span class="co"># Calculate temperature-dependent values of C3 photosynthetic parameters</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_temperature_response.html">calculate_temperature_response</a></span><span class="op">(</span><span class="va">licor_data</span>, <span class="va">c3_temperature_param_sharkey</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate the total pressure in the Licor chamber</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_total_pressure.html">calculate_total_pressure</a></span><span class="op">(</span><span class="va">licor_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The default optimizer uses randomness, so we will set a seed to ensure the</span></span>
<span><span class="co"># results from this fit are always identical</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit the C3 A-Ci curves</span></span>
<span><span class="va">c3_aci_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/consolidate.html">consolidate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span><span class="op">(</span></span>
<span>  <span class="va">licor_data</span>,                       <span class="co"># The `exdf` object containing the curves</span></span>
<span>  <span class="va">licor_data</span><span class="op">[</span>, <span class="st">'curve_identifier'</span><span class="op">]</span>, <span class="co"># A factor used to split `licor_data` into chunks</span></span>
<span>  <span class="va">fit_c3_aci</span>,                       <span class="co"># The function to apply to each chunk of `licor_data`</span></span>
<span>  Ca_atmospheric <span class="op">=</span> <span class="fl">420</span>              <span class="co"># Additional argument passed to `fit_c3_aci`</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the C3 A-Cc fits (including limiting rates)</span></span>
<span><span class="fu"><a href="../reference/plot_c3_aci_fit.html">plot_c3_aci_fit</a></span><span class="op">(</span><span class="va">c3_aci_results</span>, <span class="st">'curve_identifier'</span>, <span class="st">'Ci'</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">80</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the residuals</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">A_residuals</span> <span class="op">~</span> <span class="va">Ci</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  data <span class="op">=</span> <span class="va">c3_aci_results</span><span class="op">$</span><span class="va">fits</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'b'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ('</span>, <span class="va">c3_aci_results</span><span class="op">$</span><span class="va">fits</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">')'</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Assimilation rate residual (measured - fitted)\n('</span>, <span class="va">c3_aci_results</span><span class="op">$</span><span class="va">fits</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">A</span>, <span class="st">')'</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate temperature-dependent values of Jmax-related parameters</span></span>
<span><span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_temperature_response.html">calculate_temperature_response</a></span><span class="op">(</span></span>
<span>    <span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span>,</span>
<span>    <span class="va">jmax_temperature_param_bernacchi</span>,</span>
<span>    <span class="st">'TleafCnd_avg'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate Jmax</span></span>
<span><span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_jmax.html">calculate_jmax</a></span><span class="op">(</span><span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">)</span></span>
<span></span>
<span><span class="co">###</span></span>
<span><span class="co">### SYNTHESIS:</span></span>
<span><span class="co">### Using plots and statistics to help draw conclusions from the data</span></span>
<span><span class="co">###</span></span>
<span></span>
<span><span class="co"># View values of J from each fit</span></span>
<span><span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'curve_identifier'</span>, <span class="st">'J_at_25_lower'</span>, <span class="st">'J_at_25'</span>, <span class="st">'J_at_25_upper'</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># View values of Jmax from each fit</span></span>
<span><span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'curve_identifier'</span>, <span class="st">'Jmax_at_25_lower'</span>, <span class="st">'Jmax_at_25'</span>, <span class="st">'Jmax_at_25_upper'</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># View values of Vcmax from each fit</span></span>
<span><span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'curve_identifier'</span>, <span class="st">'Vcmax_at_25_lower'</span>, <span class="st">'Vcmax_at_25'</span>, <span class="st">'Vcmax_at_25_upper'</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Make a barchart showing average Vcmax values</span></span>
<span><span class="fu"><a href="../reference/barchart_with_errorbars.html">barchart_with_errorbars</a></span><span class="op">(</span></span>
<span>  <span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span>, <span class="st">'Vcmax_at_25'</span><span class="op">]</span>,</span>
<span>  <span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span>, <span class="st">'species'</span><span class="op">]</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">180</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">'Species'</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Vcmax at 25 degrees C ('</span>, <span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Vcmax_at_25</span>, <span class="st">')'</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make a boxplot showing the distribution of Vcmax values</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">bwplot</a></span><span class="op">(</span></span>
<span>  <span class="va">Vcmax_at_25</span> <span class="op">~</span> <span class="va">species</span>,</span>
<span>  data <span class="op">=</span> <span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">180</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">'Species'</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Vcmax at 25 degrees C ('</span>, <span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Vcmax_at_25</span>, <span class="st">')'</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute the average and standard error of each parameter for each species</span></span>
<span><span class="va">c3_aci_averages</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basic_stats.html">basic_stats</a></span><span class="op">(</span><span class="va">c3_aci_results</span><span class="op">$</span><span class="va">parameters</span>, <span class="st">'species'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the averages and errors</span></span>
<span><span class="va">columns_to_view</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">'species'</span>,</span>
<span>  <span class="st">'Vcmax_at_25_avg'</span>, <span class="st">'Vcmax_at_25_stderr'</span>,</span>
<span>  <span class="st">'J_at_25_avg'</span>, <span class="st">'J_at_25_stderr'</span>,</span>
<span>  <span class="st">'RL_at_25_avg'</span>, <span class="st">'RL_at_25_stderr'</span>,</span>
<span>  <span class="st">'Tp_at_25_avg'</span>, <span class="st">'Tp_at_25_stderr'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">c3_aci_averages</span><span class="op">[</span> , <span class="va">columns_to_view</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-caemmerer_biochemical_2000" class="csl-entry">
Caemmerer, S. von. 2000. <em>Biochemical <span>Models</span> of
<span>Leaf</span> <span>Photosynthesis</span></em>. CSIRO Publishing. <a href="https://doi.org/10.1071/9780643103405" class="external-link">https://doi.org/10.1071/9780643103405</a>.
</div>
<div id="ref-lochocki_widely_2025" class="csl-entry">
Lochocki, Edward B., and Justin M. McGrath. 2025. <span>“Widely
<span>Used</span> <span>Variants</span> of the
<span>Farquhar</span>-von-<span>Caemmerer</span>-<span>Berry</span>
<span>Model</span> <span>Can</span> <span>Cause</span>
<span>Errors</span> in <span>Parameter</span>
<span>Estimation</span>.”</span> <em>Under Review</em>.
</div>
<div id="ref-sharkey_is_2019" class="csl-entry">
Sharkey, Thomas D. 2019. <span>“Is Triose Phosphate Utilization
Important for Understanding Photosynthesis?”</span> <em>Journal of
Experimental Botany</em> 70 (20): 5521–25. <a href="https://doi.org/10.1093/jxb/erz393" class="external-link">https://doi.org/10.1093/jxb/erz393</a>.
</div>
<div id="ref-sharkey_fitting_2007" class="csl-entry">
Sharkey, Thomas D., Carl J. Bernacchi, Graham D. Farquhar, and Eric L.
Singsaas. 2007. <span>“Fitting Photosynthetic Carbon Dioxide Response
Curves for <span>C3</span> Leaves.”</span> <em>Plant, Cell &amp;
Environment</em> 30 (9): 1035–40. <a href="https://doi.org/10.1111/j.1365-3040.2007.01710.x" class="external-link">https://doi.org/10.1111/j.1365-3040.2007.01710.x</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward B. Lochocki, Coralie E. Salesse-Smith, Justin M. McGrath.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
