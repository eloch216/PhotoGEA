<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analyzing C4 A-Ci Curves • PhotoGEA</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing C4 A-Ci Curves">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    padding-top: 70px;

    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PhotoGEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/PhotoGEA.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/analyzing_ball_berry_data.html">Analyzing Ball-Berry Data</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_c3_aci_curves.html">Analyzing C3 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_c4_aci_curves.html">Analyzing C4 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_gm_data.html">Analyzing Mesophyll Conductance Data</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_tdl_data.html">Analyzing TDL Data</a></li>
    <li><a class="dropdown-item" href="../articles/combining_with_other_packages.html">Combining PhotoGEA With Other Packages</a></li>
    <li><a class="dropdown-item" href="../articles/creating_your_own_processing_tools.html">Creating Your Own Processing Tools</a></li>
    <li><a class="dropdown-item" href="../articles/developing_a_data_analysis_pipeline.html">Developing a Data Analysis Pipeline</a></li>
    <li><a class="dropdown-item" href="../articles/working_with_extended_data_frames.html">Working With Extended Data Frames</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/eloch216/PhotoGEA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Analyzing C4 A-Ci Curves</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/eloch216/PhotoGEA/blob/v1.1.0/vignettes/analyzing_c4_aci_curves.Rmd" class="external-link"><code>vignettes/analyzing_c4_aci_curves.Rmd</code></a></small>
      <div class="d-none name"><code>analyzing_c4_aci_curves.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>In this vignette, we will give an example showing how to analyze
C<sub>4</sub><em>A-C<sub>i</sub></em> data using the
<code>PhotoGEA</code> package. The commands in this vignette can be used
to initialize your own script, as described in <a href="#customizing-your-script">Customizing Your Script</a>.</p>
</div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<div class="section level3">
<h3 id="understanding-c4-a-ci-curves">Understanding C<sub>4</sub><em>A-C<sub>i</sub></em> Curves<a class="anchor" aria-label="anchor" href="#understanding-c4-a-ci-curves"></a>
</h3>
<p>An <em>A-C<sub>i</sub> curve</em> (or <em>CO<sub>2</sub> response
curve</em>) is a particular type of gas exchange measurement where a
living leaf is exposed to varying concentrations of CO<sub>2</sub>. For
each CO<sub>2</sub> concentration in the sequence, the net assimilation
rate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>n</mi></msub><annotation encoding="application/x-tex">A_n</annotation></semantics></math>),
stomatal conductance to H<sub>2</sub>O
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mrow><mi>s</mi><mi>w</mi></mrow></msub><annotation encoding="application/x-tex">g_{sw}</annotation></semantics></math>),
intercellular CO<sub>2</sub> concentration
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>),
and other important quantities are measured and recorded. Typically,
other environmental variables such as temperature, humidity, and
incident photosynthetically-active photon flux density (PPFD) are held
constant during the measurement sequence so that changes in
photosynthesis can be attributed to CO<sub>2</sub> alone.</p>
<p>Because of their different cell structures and biochemical pathways,
C<sub>3</sub> and C<sub>4</sub> plants have very different responses to
CO<sub>2</sub>. Here, we will only be discussing C<sub>3</sub>
plants.</p>
<p>The full C<sub>4</sub> photosynthetic pathway is quite complicated,
consisting of at least two hundred individual reactions, each of which
may have an impact on a measured <em>A-C<sub>i</sub></em> curve.
However, simplified models for photosynthesis are available and are much
easier to understand and work with. These models tend to be based around
PEP carboxylase and rubisco kinetics, describing how the net
assimilation rate responds to the partial pressure of CO<sub>2</sub> in
the mesophyll or bundle sheath cells. The most widely-used model is
described in in <em>Biochemical Models of Leaf Photosynthesis</em> <span class="citation">(<a href="#ref-caemmerer_biochemical_2000">S. von
Caemmerer 2000</a>)</span>.</p>
<p>This model provides a framework for understanding the changes in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>n</mi></msub><annotation encoding="application/x-tex">A_n</annotation></semantics></math>
that occur as a C<sub>4</sub> plant is exposed to successively higher
concentrations of CO<sub>2</sub>. Overall, the photosynthetic response
to CO<sub>2</sub> under high light conditions can be understood as
follows:</p>
<ul>
<li><p>For low levels of CO<sub>2</sub>, CO<sub>2</sub> assimilation is
primarily limited by PEP carboxylase activity in the mesophyll
cells.</p></li>
<li><p>For higher levels of CO<sub>2</sub>, CO<sub>2</sub> assimilation
can be limited by Rubisco activity in the bundle sheath cells, PEP
regeneration in the mesophyll cells, or light availability.</p></li>
</ul>
<p>More specifically, the model provides equations that calculate the
net assimilation rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>n</mi></msub><annotation encoding="application/x-tex">A_n</annotation></semantics></math>
from the maximumum rate of PEP carboxylation
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>p</mi><mo>,</mo><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">V_{p,max}</annotation></semantics></math>),
the maximum rate of Rubisco activity
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>c</mi><mo>,</mo><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">V_{c,max}</annotation></semantics></math>),
the maximum rate of PEP carboxylase regeneration
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>p</mi><mo>,</mo><mi>r</mi></mrow></msub><annotation encoding="application/x-tex">V_{p,r}</annotation></semantics></math>),
the electron transport rate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>),
the total rate of mitochondrial respiration across the mesophyll and
bundle sheath cells
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>L</mi></msub><annotation encoding="application/x-tex">R_L</annotation></semantics></math>),
the partial pressure of CO<sub>2</sub> in the mesophyll
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mrow><mi>c</mi><mi>m</mi></mrow></msub><annotation encoding="application/x-tex">P_{cm}</annotation></semantics></math>),
and several other parameters. The full equations are quite complicated.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>n</mi></msub><annotation encoding="application/x-tex">A_n</annotation></semantics></math>
is given by the smaller of the enzyme-limited rate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>c</mi></msub><annotation encoding="application/x-tex">A_c</annotation></semantics></math>)
and the light-limited rate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>j</mi></msub><annotation encoding="application/x-tex">A_j</annotation></semantics></math>).
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>c</mi></msub><annotation encoding="application/x-tex">A_c</annotation></semantics></math>
is co-limited by PEP carboxylase activity, Rubisco activity, and PEP
regeneration, while
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>j</mi></msub><annotation encoding="application/x-tex">A_j</annotation></semantics></math>
is co-limited by electron transport in the mesophyll and bundle-sheath
cells. Under certain circumstances (when bundle sheath conductance is
zero and all photosystem II activity occurs in the mesophyll), then the
complicated equations reduce to a simpler situation where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>n</mi></msub><annotation encoding="application/x-tex">A_n</annotation></semantics></math>
is given by the minimum of five separate rates:</p>
<ul>
<li><p>The PEP-carboxylase-limited rate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mrow><mi>p</mi><mi>c</mi></mrow></msub><annotation encoding="application/x-tex">A_{pc}</annotation></semantics></math>)</p></li>
<li><p>The Rubisco-limited rate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>r</mi></msub><annotation encoding="application/x-tex">A_r</annotation></semantics></math>)</p></li>
<li><p>The PEP-regeneration-limited rate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mrow><mi>p</mi><mi>r</mi></mrow></msub><annotation encoding="application/x-tex">A_{pr}</annotation></semantics></math>)</p></li>
<li><p>The electron-transport-limited rate in the mesophyll
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mrow><mi>j</mi><mi>m</mi></mrow></msub><annotation encoding="application/x-tex">A_{jm}</annotation></semantics></math>)</p></li>
<li><p>The electron-transport-limited rate in the bundle sheath
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mrow><mi>j</mi><mi>b</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">A_{jbs}</annotation></semantics></math>)</p></li>
</ul>
<p>The simplified version can be helpful for understanding the rough
model behavior, but it is important to keep in mind that the real model
is different, and that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>n</mi></msub><annotation encoding="application/x-tex">A_n</annotation></semantics></math>
is generally not equal to the minimum of these five rates in the full
model. The plot below shows an example of the full model output:</p>
<p><img src="analyzing_c4_aci_curves_files/figure-html/unnamed-chunk-2-1.png" width="720" style="display: block; margin: auto;"></p>
<p>(Note: this figure was generated using the
<code>calculate_c4_assimilation</code> function from the
<code>PhotoGEA</code> package, and it represents the photosynethetic
response of a C<sub>4</sub> leaf according to the model with
<code>RL_at_25</code> = 1 micromol m^(-2) s^(-1),
<code>Vpmax_at_25</code> = 150 micromol m^(-2) s^(-1),
<code>Vcmax_at_25</code> = 30 micromol m^(-2) s^(-1), <code>Vpr</code> =
80 micromol m^(-2) s^(-1), <code>J_at_25</code> = 220 micromol m^(-2)
s^(-1), and a leaf temperature of 30 degrees C. Arrhenius temperature
response parameters were taken from <span class="citation">Susanne von
Caemmerer (<a href="#ref-von_caemmerer_updating_2021">2021</a>)</span>.)</p>
<p>There are several important things to notice about this plot:</p>
<ul>
<li><p>For these conditions,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>n</mi></msub><annotation encoding="application/x-tex">A_n</annotation></semantics></math>
is always equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>c</mi></msub><annotation encoding="application/x-tex">A_c</annotation></semantics></math>.
Thus, assimilation is enzyme-limited across the entire range of
CO<sub>2</sub> values.</p></li>
<li><p>The enzyme-limited rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>c</mi></msub><annotation encoding="application/x-tex">A_c</annotation></semantics></math>
is always smaller than either of the three rates related to individual
enzymes
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mrow><mi>p</mi><mi>c</mi></mrow></msub><annotation encoding="application/x-tex">A_{pc}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mrow><mi>p</mi><mi>r</mi></mrow></msub><annotation encoding="application/x-tex">A_{pr}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>r</mi></msub><annotation encoding="application/x-tex">A_r</annotation></semantics></math>).</p></li>
<li><p>The light-limited rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>j</mi></msub><annotation encoding="application/x-tex">A_j</annotation></semantics></math>
is always smaller than either of the two rates related to electron
transport in individual cell types
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mrow><mi>j</mi><mi>m</mi></mrow></msub><annotation encoding="application/x-tex">A_{jm}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mrow><mi>j</mi><mi>b</mi></mrow></msub><annotation encoding="application/x-tex">A_{jb}</annotation></semantics></math>).</p></li>
<li><p>The dependence of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>r</mi></msub><annotation encoding="application/x-tex">A_r</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>j</mi></msub><annotation encoding="application/x-tex">A_j</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mrow><mi>p</mi><mi>r</mi></mrow></msub><annotation encoding="application/x-tex">A_{pr}</annotation></semantics></math>
on CO<sub>2</sub> concentration is very similar, where all three are
nearly independent of CO<sub>2</sub>.</p></li>
<li><p>The PEP-carboxylase-limited rate
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mrow><mi>p</mi><mi>c</mi></mrow></msub><annotation encoding="application/x-tex">A_{pc}</annotation></semantics></math>)
is the only rate that approaches zero, which happens as the
CO<sub>2</sub> concentration decreases.</p></li>
<li><p>Regardless of which process may be limiting assimilation,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>n</mi></msub><annotation encoding="application/x-tex">A_n</annotation></semantics></math><em>never</em> decreases as CO<sub>2</sub> increases.</p></li>
</ul>
<p>An important conclusion here is that PEP carboxylase always limits
assimilation at low CO<sub>2</sub> concentrations, and that one or more
of Rubisco activity, electron transport, and PEP regeneration limits
assimilation at high CO<sub>2</sub> concentrations. These three
processes each produce a plateau with a nearly flat response to
CO<sub>2</sub>.</p>
<p>One of the most common reasons to measure an <em>A-C<sub>i</sub></em>
curve is to interpret it in the context of this model. In other words,
by fitting the model’s equations to a measured curve, it is possible to
estimate values for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>L</mi></msub><annotation encoding="application/x-tex">R_L</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>p</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">V_{pmax}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>c</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">V_{cmax}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>,
and others. See the documentation for
<code>calculate_c4_assimilation</code> for more information about these
important quantities.</p>
<p>From the discussion above, it is evident that determining the
rate-limiting process at high
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>
in a C<sub>4</sub><em>A-C<sub>i</sub></em> curve is difficult or
impossible because the three potentially limiting processes each exhibit
nearly identical responses to CO<sub>2</sub>. There are two main ways to
deal with this issue:</p>
<ul>
<li><p>One way is to assume a particular limiting process based on
outside information. For example, curves measured under high light
conditions (where electron transport rates will be high), and at warm
temperatures (where PEP regeneration rates will be high) are likely to
be Rubisco-limited at high
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>.</p></li>
<li><p>Another option is to use an empirical non-rectangular hyperbola
to fit the curve. This enables estimates of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">V_{max}</annotation></semantics></math>,
the maximum rate of gross assimilation, which is related to the highest
value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>n</mi></msub><annotation encoding="application/x-tex">A_n</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mrow><mi>n</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">A_{nmax}</annotation></semantics></math>)
by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mrow><mi>n</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>=</mo><msub><mi>V</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>−</mo><msub><mi>R</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">A_{nmax} = V_{max} - R_L</annotation></semantics></math>.
This quantity has no meaningful mechanistic interpretation but can be
used to compare assimilation rates between groups of plants. When taking
this approach, values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>p</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">V_{pmax}</annotation></semantics></math>
can still be estimated from the low
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>
part of the curve using the mechanistic model.</p></li>
</ul>
<p>These approaches will be demonstrated below in this vignette.</p>
</div>
<div class="section level3">
<h3 id="practicalities">Practicalities<a class="anchor" aria-label="anchor" href="#practicalities"></a>
</h3>
<p>There are a few other important practicalities to keep in mind when
thinking about CO<sub>2</sub> response curves.</p>
<p>One point is that C<sub>4</sub> photosynthesis models generally
predict the response of assimilation to the partial pressure of
CO<sub>2</sub> in the mesophyll
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mrow><mi>c</mi><mi>m</mi></mrow></msub><annotation encoding="application/x-tex">P_{cm}</annotation></semantics></math>),
but gas exchange measurements can only determine the CO<sub>2</sub>
concentration in the leaf’s intercellular spaces
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>).
Thus, an extra step is required when interpreting
<em>A-C<sub>i</sub></em> curves. If the mesophyll conductance to
CO<sub>2</sub>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mrow><mi>m</mi><mi>c</mi></mrow></msub><annotation encoding="application/x-tex">g_{mc}</annotation></semantics></math>)
and the total pressure
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>)
are known, then it is possible to calculate values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mrow><mi>c</mi><mi>m</mi></mrow></msub><annotation encoding="application/x-tex">P_{cm}</annotation></semantics></math>
from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>n</mi></msub><annotation encoding="application/x-tex">A_n</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>P</mi><annotation encoding="application/x-tex">P</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mrow><mi>m</mi><mi>c</mi></mrow></msub><annotation encoding="application/x-tex">g_{mc}</annotation></semantics></math>.
Otherwise, it is also possible to assume an infinite mesophyll
conductance; in this case,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>m</mi></msub><mo>=</mo><msub><mi>C</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">C_m = C_i</annotation></semantics></math>,
and the estimated values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>c</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">V_{cmax}</annotation></semantics></math>
and other parameters can be considered to be “effective values”
describing the plant’s response to intercellular CO<sub>2</sub>.</p>
<p>Another important point is that plants generally do not appreciate
being starved of CO<sub>2</sub>, so it is not usually possible to start
a response curve at low CO<sub>2</sub> and proceed upwards. A more
typical approach is to:</p>
<ol style="list-style-type: decimal">
<li><p>Begin at ambient atmospheric CO<sub>2</sub> levels.</p></li>
<li><p>Decrease towards a low value.</p></li>
<li><p>Return to ambient levels and wait for the plant to reacclimate;
this waiting period is usually accomplished by logging several points at
ambient CO<sub>2</sub> levels.</p></li>
<li><p>Increase to higher values.</p></li>
</ol>
<p>When taking this approach, it therefore becomes necessary to remove
the extra points measured at ambient CO<sub>2</sub> levels and to
reorder the points according to their CO<sub>2</sub> values before
plotting or analyzing them.</p>
</div>
<div class="section level3">
<h3 id="the-data">The Data<a class="anchor" aria-label="anchor" href="#the-data"></a>
</h3>
<p><em>A-C<sub>i</sub></em> curves are commonly measured using a
portable photosynthesis system such as the Licor Li-6800. These machines
record values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>n</mi></msub><annotation encoding="application/x-tex">A_n</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mrow><mi>s</mi><mi>w</mi></mrow></msub><annotation encoding="application/x-tex">g_{sw}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>,
and many other important quantities. They produce two types of output
files: plain-text and Microsoft Excel. It is often more convenient to
work with the Excel files since the entries can be easily modified (for
example, to remove an extraneous row or add a new column). On the other
hand, it can be more difficult to access the file contents using other
pieces of software such as R. However, the <code>PhotoGEA</code> package
reduces this barrier by including tools for reading Licor Excel files in
R, which will be demonstrated in the following section.</p>
</div>
</div>
<div class="section level2">
<h2 id="loading-packages">Loading Packages<a class="anchor" aria-label="anchor" href="#loading-packages"></a>
</h2>
<p>As always, the first step is to load the packages we will be using.
In addition to <code>PhotoGEA</code>, we will also use the
<code>lattice</code> package for generating plots.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/eloch216/PhotoGEA" class="external-link">PhotoGEA</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lattice.r-forge.r-project.org/" class="external-link">lattice</a></span><span class="op">)</span></span></code></pre></div>
<p>If the <code>lattice</code> package is not installed on your R setup,
you can install it by typing
<code>install.packages('lattice')</code>.</p>
</div>
<div class="section level2">
<h2 id="loading-licor-data">Loading Licor Data<a class="anchor" aria-label="anchor" href="#loading-licor-data"></a>
</h2>
<p>The <code>PhotoGEA</code> package includes two files representing
<em>A-C<sub>i</sub></em> curves measured using two Li-6800 instruments.
The data is stored in Microsoft Excel files, and includes curves
measured from two different crop species (sorghum and maize) and several
different plots of each. Each curve is a sixteen-point CO<sub>2</sub>
response curve; in other words, the CO<sub>2</sub> concentration in the
air surrounding the leaf was varied, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>n</mi></msub><annotation encoding="application/x-tex">A_n</annotation></semantics></math>
(among other variables) was measured at each CO<sub>2</sub> setpoint.
Although these two files are based on real data, noise was added to it
since it is unpublished, so these files should only be used as
examples.</p>
<p>The files will be stored on your computer somewhere in your R package
installation directory, and full paths to these files can be obtained
with <code>PhotoGEA_example_file_path</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define a vector of paths to the files we wish to load; in this case, we are</span></span>
<span><span class="co"># loading example files included with the PhotoGEA package</span></span>
<span><span class="va">file_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/PhotoGEA_example_file_path.html">PhotoGEA_example_file_path</a></span><span class="op">(</span><span class="st">'c4_aci_1.xlsx'</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/PhotoGEA_example_file_path.html">PhotoGEA_example_file_path</a></span><span class="op">(</span><span class="st">'c4_aci_2.xlsx'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>(<strong>Note:</strong> When loading your own files for analysis, it
is not advisable to use <code>PhotoGEA_example_file_path</code> as we
have done here. Instead, file paths can be directly written, or files
can be chosen using an interactive window. See <a href="#input-files">Input Files</a> below for more information.)</p>
<p>To actually read the data in the files and store them in R objects,
we will use the <code>read_gasex_file</code> function from
<code>PhotoGEA</code>. Since there are multiple files to read, we will
call this function once for each file using <code>lapply</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load each file, storing the result in a list</span></span>
<span><span class="va">licor_exdf_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">file_paths</span>, <span class="kw">function</span><span class="op">(</span><span class="va">fpath</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/read_gasex_file.html">read_gasex_file</a></span><span class="op">(</span><span class="va">fpath</span>, <span class="st">'time'</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>The result from this command is an R list of “extended data frames”
(abbreviated as <code>exdf</code> objects). The <code>exdf</code> class
is a special data structure defined by the <code>PhotoGEA</code>
package. In many ways, an <code>exdf</code> object is equivalent to a
data frame, with the major difference being that an <code>exdf</code>
object includes the units of each column. For more information, type
<code><a href="../reference/exdf.html">?exdf</a></code> in the R terminal to access the built-in help menu
entry, or check out the <a href="working_with_extended_data_frames.html">Working With Extended Data
Frames</a> vignette.</p>
<p>Generally, it is more convenient to work with a single
<code>exdf</code> object rather than a list of them, so our next step
will be to combine the objects in the list. This action can be
accomplished using the <code>rbind</code> function, which combines
table-like objects by their rows; in other words, it stacks two or more
tables vertically. This action only makes sense if the tables have the
same columns, so before we combine the <code>exdf</code> objects, we
should make sure this is the case.</p>
<p>The <code>PhotoGEA</code> package includes a function called
<code>identify_common_columns</code> that can be used to get the names
of all columns that are present in all of the Licor files. Then, we can
extract just those columns, and then combine the <code>exdf</code>
objects into a single one.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the names of all columns that are present in all of the Licor files</span></span>
<span><span class="va">columns_to_keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">identify_common_columns</span>, <span class="va">licor_exdf_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract just these columns</span></span>
<span><span class="va">licor_exdf_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">licor_exdf_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span> , <span class="va">columns_to_keep</span>, <span class="cn">TRUE</span><span class="op">]</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use `rbind` to combine all the data</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">licor_exdf_list</span><span class="op">)</span></span></code></pre></div>
<p>Now we have a single R object called <code>licor_data</code> that
includes all the data from several Licor Excel files. For more
information about consolidating information from multiple files, see the
<em>Common Patterns</em> section of the <a href="working_with_extended_data_frames.html#combining-data-from-several-files">Working
With Extended Data Frames</a> vignette.</p>
</div>
<div class="section level2">
<h2 id="validating-the-data">Validating the Data<a class="anchor" aria-label="anchor" href="#validating-the-data"></a>
</h2>
<p>Before attempting to fit the curves, it is a good idea to do some
basic checks of the data to ensure it is organized properly and that it
was measured properly.</p>
<div class="section level3">
<h3 id="basic-checks">Basic Checks<a class="anchor" aria-label="anchor" href="#basic-checks"></a>
</h3>
<p>First, we should make sure there is a column in the data whose value
uniquely identifies each curve. In this particular data set, several
“user constants” were defined while making the measurements that help to
identify each curve: <code>instrument</code>, <code>species</code>, and
<code>plot</code>. However, neither of these columns alone are
sufficient to uniquely identify each curve. We can solve this issue by
creating a new column that combines the values from each of these:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a new identifier column formatted like `instrument - species - plot`</span></span>
<span><span class="va">licor_data</span><span class="op">[</span> , <span class="st">'curve_identifier'</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">licor_data</span><span class="op">[</span> , <span class="st">'instrument'</span><span class="op">]</span>, <span class="st">'-'</span>, <span class="va">licor_data</span><span class="op">[</span> , <span class="st">'species'</span><span class="op">]</span>, <span class="st">'-'</span>, <span class="va">licor_data</span><span class="op">[</span> , <span class="st">'plot'</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>The next step is to make sure that this column correctly identifies
each response curve. To do this, we can use the
<code>check_response_curve_data</code> function from
<code>PhotoGEA</code>. Here we will supply the name of a column that
should uniquely identify each response curve
(<code>curve_identifier</code>), the expected number of points in each
curve (<code>16</code>), the name of a “driving” column that should
follow the same sequence in each curve (<code>CO2_r_sp</code>). If the
data passes the checks, this function will have no output and will not
produce any messages. (For more information, see the built-in help menu
entry by typing <code><a href="../reference/check_response_curve_data.html">?check_response_curve_data</a></code>.)</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make sure the data meets basic requirements</span></span>
<span><span class="fu"><a href="../reference/check_response_curve_data.html">check_response_curve_data</a></span><span class="op">(</span><span class="va">licor_data</span>, <span class="st">'curve_identifier'</span>, <span class="fl">16</span>, <span class="st">'CO2_r_sp'</span><span class="op">)</span></span></code></pre></div>
<p>However, if <code>check_response_curve_data</code> detects an issue,
it will print a helpful message to the R terminal. For example, if we
had specified the wrong number of points or the wrong identifier column,
we would get error messages:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_response_curve_data.html">check_response_curve_data</a></span><span class="op">(</span><span class="va">licor_data</span>, <span class="st">'curve_identifier'</span>, <span class="fl">15</span><span class="op">)</span></span>
<span><span class="co">#&gt;      curve_identifier npts</span></span>
<span><span class="co">#&gt; 1   ripe1 - maize - 5   16</span></span>
<span><span class="co">#&gt; 2 ripe1 - sorghum - 2   16</span></span>
<span><span class="co">#&gt; 3 ripe1 - sorghum - 3   16</span></span>
<span><span class="co">#&gt; 4   ripe2 - maize - 2   16</span></span>
<span><span class="co">#&gt; 5 ripe2 - sorghum - 3   16</span></span>
<span><span class="co">#&gt; Error in check_response_curve_data(licor_data, "curve_identifier", 15): One or more curves does not have the expected number of points.</span></span>
<span></span>
<span><span class="fu"><a href="../reference/check_response_curve_data.html">check_response_curve_data</a></span><span class="op">(</span><span class="va">licor_data</span>, <span class="st">'species'</span>, <span class="fl">16</span><span class="op">)</span></span>
<span><span class="co">#&gt;   species npts</span></span>
<span><span class="co">#&gt; 1   maize   32</span></span>
<span><span class="co">#&gt; 2 sorghum   48</span></span>
<span><span class="co">#&gt; Error in check_response_curve_data(licor_data, "species", 16): One or more curves does not have the expected number of points.</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plotting-the-a-ci-curves">Plotting the <em>A-C<sub>i</sub></em> Curves<a class="anchor" aria-label="anchor" href="#plotting-the-a-ci-curves"></a>
</h3>
<p>One qualitative way to check the data is to simply create a plot of
the <em>A-C<sub>i</sub></em> curves. In this situation, the
<code>lattice</code> library makes it simple to include each curve as
its own separate subplot of a figure. For example:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot all A-Ci curves in the data set</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">A</span> <span class="op">~</span> <span class="va">Ci</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  data <span class="op">=</span> <span class="va">licor_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'b'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">']'</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Net CO2 assimilation rate ['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">A</span>, <span class="st">']'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_c4_aci_curves_files/figure-html/plot_aci-1.png" width="720" style="display: block; margin: auto;"></p>
<p>Whoops! Why do these curves look so strange? Well, some of the issues
are related to the sequence of CO<sub>2</sub> values that was used when
measuring the curves. As discussed in <a href="#practicalities">Practicalities</a>, there are several repeated
points logged at the same CO<sub>2</sub> concentration, and the points
are not logged in order of ascending or descending concentration. In
fact, the sequence of CO<sub>2</sub> setpoints is as follows:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">licor_data</span><span class="op">[</span><span class="va">licor_data</span><span class="op">[</span>, <span class="st">'curve_identifier'</span><span class="op">]</span> <span class="op">==</span> <span class="st">'ripe2 - maize - 2'</span>, <span class="st">'CO2_r_sp'</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1]  400  300  200  150  100   75   50   20  400  400  600  800 1000 1200 1500</span></span>
<span><span class="co">#&gt; [16] 1800</span></span></code></pre></div>
<p>Ideally, we would like to remove the ninth and tenth points (where
the setpoint has been reset to 400 to allow the leaf to reacclimate to
ambient CO<sub>2</sub> levels), and reorder the data so it is arranged
from low to high values of <code>Ci</code>. This can be done using the
<code>organize_response_curve</code> function from
<code>PhotoGEA</code>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove points with duplicated `CO2_r_sp` values and order by `Ci`</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/organize_response_curve_data.html">organize_response_curve_data</a></span><span class="op">(</span></span>
<span>    <span class="va">licor_data</span>,</span>
<span>    <span class="st">'curve_identifier'</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    <span class="st">'Ci'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now we can plot them again:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot all A-Ci curves in the data set</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">A</span> <span class="op">~</span> <span class="va">Ci</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  data <span class="op">=</span> <span class="va">licor_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'b'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">']'</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Net CO2 assimilation rate ['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">A</span>, <span class="st">']'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_c4_aci_curves_files/figure-html/unnamed-chunk-4-1.png" width="720" style="display: block; margin: auto;"></p>
<p>They still look a bit strange. Some of this is related to the noise
that was intentionally added to the data. Nevertheless, there are a few
points that we should probably exclude before attempting to fit the
curves. One issue is that the model <em>never</em> predicts a decrease
in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>i</mi></mrow><annotation encoding="application/x-tex">Ci</annotation></semantics></math>
increases. So, it is usually a good idea to exclude any points at high
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>i</mi></mrow><annotation encoding="application/x-tex">Ci</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
is observed to decrease by a large amount. This dropoff in assimilation
is due to one or more processes that are not captured by the model, and
the fits will be unreliable. We will remove these points later, after we
have made several other data quality checks.</p>
</div>
<div class="section level3">
<h3 id="additional-plots-for-qualitative-validation">Additional Plots for Qualitative Validation<a class="anchor" aria-label="anchor" href="#additional-plots-for-qualitative-validation"></a>
</h3>
<p>Sometimes a Licor will override the temperature or humidity controls
while making measurements; in this case, conditions inside the
measurement chamber may not be stable, and we may wish to exclude some
of these points. We can check for these types of issues by making more
plots. In the following sections, we will generate several different
plots to check each curve for quality.</p>
<div class="section level4">
<h4 id="humidity-control">Humidity Control<a class="anchor" aria-label="anchor" href="#humidity-control"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make a plot to check humidity control</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">RHcham</span> <span class="op">+</span> <span class="va">`Humidifier_%`</span> <span class="op">+</span> <span class="va">`Desiccant_%`</span> <span class="op">~</span> <span class="va">Ci</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  data <span class="op">=</span> <span class="va">licor_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'b'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">']'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_c4_aci_curves_files/figure-html/plot_humidity-1.png" width="720" style="display: block; margin: auto;"></p>
<p>Here, <code>Humidifier_%</code> and <code>Desiccant_%</code>
represent the flow from the humidifier and desiccant columns, where a
value of 0 indicates that the valve to the column is fully closed and a
value of 100 indicates that the valve to the column is fully opened.
<code>RHcham</code> represents the relative humidity inside the chamber
as a percentage (in other words, as a value between 0 and 100).</p>
<p>When these curves were measured, a chamber humidity setpoint was
specified. So, when looking at this plot, we should check that the
relative humidity is fairly constant during each curve. Typically, this
should be accompanied by relatively smooth changes in the valve
percentages as they accomodate changes in ambient humidity and leaf
photosynthesis. In this plot, all the data looks good.</p>
</div>
<div class="section level4">
<h4 id="temperature-control">Temperature Control<a class="anchor" aria-label="anchor" href="#temperature-control"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make a plot to check temperature control</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">TleafCnd</span> <span class="op">+</span> <span class="va">Txchg</span> <span class="op">~</span> <span class="va">Ci</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  data <span class="op">=</span> <span class="va">licor_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'b'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">40</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">']'</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Temperature ('</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">TleafCnd</span>, <span class="st">')'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_c4_aci_curves_files/figure-html/plot_temperature-1.png" width="720" style="display: block; margin: auto;"></p>
<p>Here, <code>TleafCnd</code> is the leaf temperature measured using a
thermocouple, and <code>Txchg</code> is the temperature of the heat
exhanger that is used to control the air temperature in the measurement
instrument. When these curves were measured, an exchanger setpoint was
specified. So, when looking at this plot, we should check that
<code>Txchg</code> is constant during each curve and that the leaf
temperature does not vary in an erratic way. In this plot, all the data
looks good.</p>
</div>
<div class="section level4">
<h4 id="co2-control">CO<sub>2</sub> Control<a class="anchor" aria-label="anchor" href="#co2-control"></a>
</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make a plot to check CO2 control</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">CO2_s</span> <span class="op">+</span> <span class="va">CO2_r</span> <span class="op">+</span> <span class="va">CO2_r_sp</span> <span class="op">~</span> <span class="va">Ci</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  data <span class="op">=</span> <span class="va">licor_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'b'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">']'</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'CO2 concentration ('</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">CO2_r</span>, <span class="st">')'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_c4_aci_curves_files/figure-html/plot_co2-1.png" width="720" style="display: block; margin: auto;"></p>
<p>Here, <code>CO2_s</code> is the CO<sub>2</sub> concentration in the
sample cell, <code>CO2_r</code> is the CO<sub>2</sub> concentration in
the reference cell, and <code>CO2_r_sp</code> is the setpoint for
<code>CO2_r</code>. When these curves were measured, a sequence of
<code>CO2_r</code> values was specified, so, when looking at this plot,
we should check that <code>CO2_r</code> is close to
<code>CO2_r_sp</code>. We also expect that <code>CO2_s</code> should be
a bit lower than <code>CO2_r</code> because the leaf in the sample
chamber is assimilating CO<sub>2</sub>, which should reduce its
concentration in the surrounding air. (An exception to this rule occurs
at very low values of <code>CO2_r_sp</code>, since in this case there is
not enough carbon available to assimilate, and the leaf actually
releases CO<sub>2</sub> due to respiration.) In this plot, all the data
looks good.</p>
</div>
<div class="section level4">
<h4 id="stability">Stability<a class="anchor" aria-label="anchor" href="#stability"></a>
</h4>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make a plot to check stability criteria</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">`A:OK`</span> <span class="op">+</span> <span class="va">`gsw:OK`</span> <span class="op">+</span> <span class="va">Stable</span> <span class="op">~</span> <span class="va">Ci</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  data <span class="op">=</span> <span class="va">licor_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'b'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">']'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_c4_aci_curves_files/figure-html/plot_stability-1.png" width="720" style="display: block; margin: auto;"></p>
<p>When measuring response curves with a Licor, it is possible to
specify stability criteria for each point in addition to minimum and
maximum wait times. In other words, once the set point for the driving
variable is changed, the machine waits until the stability criteria are
met; there is a minimum waiting period, and also a maximum to prevent
the machine from waiting for too long.</p>
<p>When these curves were measured, stability criteria were supplied for
the net assimilation rate <code>A</code> and the stomatal conductance
<code>gsw</code>. The stability status for each was stored in the log
file because the appropriate logging option for stability was set. Now,
for each point, it is possible to check whether stability was achieved
or whether the point was logged because the maximum waiting period had
been met. If the maximum waiting period is reached and the plant has
still not stabilized, the data point may be unreliable, so it can be
helpful to check this information.</p>
<p>In the plot, <code>A:OK</code> indicates whether <code>A</code> was
stable (0 for no, 1 for yes), <code>gsw:OK</code> indicates whether
<code>gsw</code> was stable (0 for no, 1 for yes), and
<code>Stable</code> indicates the total number of stability conditions
that were met. So, we are looking for points where <code>Stable</code>
is 2. Otherwise, we can check the other traces to see whether
<code>A</code> or <code>gsw</code> was unstable.</p>
<p>Comparing these plots with the ones in <a href="#plotting-the-a-ci-curves">Plotting the <em>A-C<sub>i</sub></em>
Curves</a>, it seems that none of the unstable points look particularly
strange, so we will not remove them.</p>
</div>
</div>
<div class="section level3">
<h3 id="cleaning-the-licor-data">Cleaning the Licor Data<a class="anchor" aria-label="anchor" href="#cleaning-the-licor-data"></a>
</h3>
<p>While checking over the plots in the previous sections, we noticed
that some of the curves exhibit a sharp decrease in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
at high values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>.</p>
<p>We can use the <code>remove_points</code> function from
<code>PhotoGEA</code> to exclude these points. It just so happens that
all of these points where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>n</mi></msub><annotation encoding="application/x-tex">A_n</annotation></semantics></math>
suddenly decreases at high
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>
were measured by the <code>ripe1</code> instrument and occur at the
highest CO<sub>2</sub> setpoint value, so it is easy to specify them all
at once.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove points where `instrument` is `ripe1` and `CO2_r_sp` is 1800</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/remove_points.html">remove_points</a></span><span class="op">(</span></span>
<span>  <span class="va">licor_data</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>instrument <span class="op">=</span> <span class="st">'ripe1'</span>, CO2_r_sp <span class="op">=</span> <span class="fl">1800</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="st">'exclude'</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="fitting-licor-data">Fitting Licor Data<a class="anchor" aria-label="anchor" href="#fitting-licor-data"></a>
</h2>
<p>Now that we have checked the data quality, we are ready to perform
the fitting. In order to fit the curves, there are several required
pieces of information that are not included in the Licor data files as
produced by the instrument: temperature-dependent values of important
photosynthetic parameters such as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>γ</mi><mo>*</mo></msup><annotation encoding="application/x-tex">\gamma^*</annotation></semantics></math>,
and values of the total pressure. However, the <code>PhotoGEA</code>
package includes two functions to help with these calculations:
<code>calculate_temperature_response</code> and
<code>calculate_total_pressure</code>. Each of these requires an
<code>exdf</code> object containing Licor data. The units for each
required column will be checked in an attempt to avoid unit-related
errors. More information about these functions can be obtained from the
built-in help system by typing
<code><a href="../reference/calculate_temperature_response.html">?calculate_temperature_response</a></code> or
<code><a href="../reference/calculate_total_pressure.html">?calculate_total_pressure</a></code>.</p>
<p>First, we can use <code>calculate_temperature_response</code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate temperature-dependent values of C4 photosynthetic parameters</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_temperature_response.html">calculate_temperature_response</a></span><span class="op">(</span><span class="va">licor_data</span>, <span class="va">c4_temperature_param_vc</span><span class="op">)</span></span></code></pre></div>
<p>With these simple commands, we have used the leaf temperature from
the Licor file to calculate values of several key C<sub>4</sub>
photosynthetic parameters (Vcmax_norm, Vpmax_norm, RL_norm, Kc, Ko, Kp,
gamma_star, ao, gmc_norm, J_norm according to the temperature response
parameters specified in <span class="citation">Susanne von Caemmerer (<a href="#ref-von_caemmerer_updating_2021">2021</a>)</span>. Notice that
this command calculated values of the mesophyll conductance to CO2
(<code>gmc</code>) in units of mol
m<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mrow><mo>−</mo><mn>2</mn></mrow></msup><annotation encoding="application/x-tex">^{-2}</annotation></semantics></math>
s<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><annotation encoding="application/x-tex">^{-1}</annotation></semantics></math>
bar<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><annotation encoding="application/x-tex">^{-1}</annotation></semantics></math>.
These values were estmated for <em>Setaria viridis</em> and may not be
appropriate for all C<sub>4</sub> plants. Nevertheless, we will use them
here.</p>
<p>Now we can use <code>calculate_total_pressure</code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate the total pressure in the Licor chamber</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_total_pressure.html">calculate_total_pressure</a></span><span class="op">(</span><span class="va">licor_data</span><span class="op">)</span></span></code></pre></div>
<p>Together, these functions have added several new columns to
<code>licor_data</code>, including <code>gmc</code>, <code>PCm</code>,
<code>gamma_star</code>, and others. With this information, we are now
ready to fit the curves.</p>
<p>Here we will demonstrate three different approaches to curve fitting.
For these fits, we will be using the <code>fit_c4_aci</code> and
<code>fit_c4_aci_hyperbola</code> functions from the
<code>PhotoGEA</code> package, which each fit single response curves to
estimate the values of key photosynthetic parameters.</p>
<p>To apply these functions to each curve in a larger data set and then
consolidate the results, we can use them in conjunction with
<code>by</code> and <code>consolidate</code>, which are also part of
<code>PhotoGEA</code>. (For more information about these functions, see
the built-in help menu entries by typing <code><a href="../reference/fit_c4_aci.html">?fit_c4_aci</a></code>,
<code><a href="../reference/fit_c4_aci_hyperbola.html">?fit_c4_aci_hyperbola</a></code>, <code><a href="../reference/by.exdf.html">?by.exdf</a></code>, or
<code><a href="../reference/consolidate.html">?consolidate</a></code>, or check out the <em>Common Patterns</em>
section of the <a href="working_with_extended_data_frames.html#processing-multiple-pieces-of-an-extended-data-frame">Working
With Extended Data Frames</a> vignette.) Together, these functions will
split apart the main data using the curve identifier column we defined
before (<a href="#basic-checks">Basic Checks</a>), fit each
<em>A-C<sub>i</sub></em> curve using the models discussed in <a href="#understanding-c4-a-ci-curves">Understanding C<sub>4</sub><em>A-C<sub>i</sub></em> Curves</a>, and return the resulting parameters
and fits.</p>
<p>For viewing the resulting fits, we will be using the
<code>plot_c4_aci_fit</code> and <code>plot_c4_aci_hyperbola_fit</code>
functions from <code>PhotoGEA</code>.</p>
<div class="section level3">
<h3 id="mechanistic-fit-assuming-rubisco-limitations">Mechanistic Fit, Assuming Rubisco Limitations<a class="anchor" aria-label="anchor" href="#mechanistic-fit-assuming-rubisco-limitations"></a>
</h3>
<p>To ensure that the fitted assimilation rates are limited by Rubisco
activity at high
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>,
we can set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>p</mi><mi>r</mi></mrow></msub><annotation encoding="application/x-tex">V_{pr}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>
to extremely high values, which will ensure that PEP regeneration and
light availability are never limiting. At the same time, we will allow
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>c</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">V_{cmax}</annotation></semantics></math>
to vary during the fit. This is the default behavior of
<code>fit_c4_aci</code>, but here we will use the
<code>fit_options</code> input argument to make it clear that we are
requiring Rubisco limitations.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The default optimizer uses randomness, so we will set a seed to ensure the</span></span>
<span><span class="co"># results from this fit are always identical</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit the C4 A-Ci curves with the mechanistic model, assuming Rubisco limitations</span></span>
<span><span class="va">c4_aci_results_rubisco</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/consolidate.html">consolidate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span><span class="op">(</span></span>
<span>  <span class="va">licor_data</span>,                       <span class="co"># The `exdf` object containing the curves</span></span>
<span>  <span class="va">licor_data</span><span class="op">[</span>, <span class="st">'curve_identifier'</span><span class="op">]</span>, <span class="co"># A factor used to split `licor_data` into chunks</span></span>
<span>  <span class="va">fit_c4_aci</span>,                       <span class="co"># The function to apply to each chunk of `licor_data`</span></span>
<span>  Ca_atmospheric <span class="op">=</span> <span class="fl">420</span>,             <span class="co"># Used to estimate the operating point</span></span>
<span>  fit_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Vcmax_at_25 <span class="op">=</span> <span class="st">'fit'</span>, Vpr <span class="op">=</span> <span class="fl">1000</span>, J_at_25 <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Having made the fits, we can view the results:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the C4 A-Ci fits that were made assuming Rubisco limitations</span></span>
<span><span class="fu"><a href="../reference/plot_c4_aci_fit.html">plot_c4_aci_fit</a></span><span class="op">(</span></span>
<span>  <span class="va">c4_aci_results_rubisco</span>,</span>
<span>  <span class="st">'curve_identifier'</span>,</span>
<span>  <span class="st">'Ci'</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>  main <span class="op">=</span> <span class="st">'Mechanistic fits assuming Rubisco limitations'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_c4_aci_curves_files/figure-html/plot_aci_fit_rubisco-1.png" width="720" style="display: block; margin: auto;"></p>
<p>Overall, these fits look good. Note that because Rubisco activity and
PEP carboxylase activity co-limit the net assimilation rate,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>n</mi></msub><annotation encoding="application/x-tex">A_n</annotation></semantics></math>
is always smaller than either
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>r</mi></msub><annotation encoding="application/x-tex">A_r</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mrow><mi>p</mi><mi>c</mi></mrow></msub><annotation encoding="application/x-tex">A_{pc}</annotation></semantics></math>
in these results.</p>
</div>
<div class="section level3">
<h3 id="mechanistic-fit-assuming-light-limitations">Mechanistic Fit, Assuming Light Limitations<a class="anchor" aria-label="anchor" href="#mechanistic-fit-assuming-light-limitations"></a>
</h3>
<p>To ensure that the fitted assimilation rates are limited by light at
high
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>,
we can set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>p</mi><mi>r</mi></mrow></msub><annotation encoding="application/x-tex">V_{pr}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>c</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">V_{cmax}</annotation></semantics></math>
to extremely high values, which will ensure that PEP regeneration and
Rubisco activity are never limiting. At the same time, we will allow
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>
to vary during the fit. This can be done using the
<code>fit_options</code> input argument to <code>fit_c4_aci</code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The default optimizer uses randomness, so we will set a seed to ensure the</span></span>
<span><span class="co"># results from this fit are always identical</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit the C4 A-Ci curves with the mechanistic model, assuming light limitations</span></span>
<span><span class="va">c4_aci_results_light</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/consolidate.html">consolidate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span><span class="op">(</span></span>
<span>  <span class="va">licor_data</span>,                       <span class="co"># The `exdf` object containing the curves</span></span>
<span>  <span class="va">licor_data</span><span class="op">[</span>, <span class="st">'curve_identifier'</span><span class="op">]</span>, <span class="co"># A factor used to split `licor_data` into chunks</span></span>
<span>  <span class="va">fit_c4_aci</span>,                       <span class="co"># The function to apply to each chunk of `licor_data`</span></span>
<span>  Ca_atmospheric <span class="op">=</span> <span class="fl">420</span>,             <span class="co"># Used to estimate the operating point</span></span>
<span>  fit_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Vcmax_at_25 <span class="op">=</span> <span class="fl">1000</span>, Vpr <span class="op">=</span> <span class="fl">1000</span>, J_at_25 <span class="op">=</span> <span class="st">'fit'</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Having made the fits, we can view the results:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the C4 A-Ci fits that were made assuming Rubisco limitations</span></span>
<span><span class="fu"><a href="../reference/plot_c4_aci_fit.html">plot_c4_aci_fit</a></span><span class="op">(</span></span>
<span>  <span class="va">c4_aci_results_light</span>,</span>
<span>  <span class="st">'curve_identifier'</span>,</span>
<span>  <span class="st">'Ci'</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>  main <span class="op">=</span> <span class="st">'Mechanistic fits assuming light limitations'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_c4_aci_curves_files/figure-html/plot_aci_fit_light-1.png" width="720" style="display: block; margin: auto;"></p>
<p>Overall, these fits look good. Note that because electron transport
and PEP carboxylase are independent in the model, there is a sharp
transition from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>n</mi></msub><mo>=</mo><msub><mi>A</mi><mrow><mi>p</mi><mi>c</mi></mrow></msub></mrow><annotation encoding="application/x-tex">A_n = A_{pc}</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>n</mi></msub><mo>=</mo><msub><mi>A</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">A_n = A_j</annotation></semantics></math>
in these fits, in contrast to the Rubisco fits above, where there is a
smooth transition between limiting states.</p>
</div>
<div class="section level3">
<h3 id="semi-empirical-fit">Semi-Empirical Fit<a class="anchor" aria-label="anchor" href="#semi-empirical-fit"></a>
</h3>
<p>We can also take an empirical approach to curve fitting, where we use
a non-rectangular hyperbola instead of the mechanistic model.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The default optimizer uses randomness, so we will set a seed to ensure the</span></span>
<span><span class="co"># results from this fit are always identical</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit the C4 A-Ci curves with the empirical model</span></span>
<span><span class="va">c4_aci_results_hyperbola</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/consolidate.html">consolidate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span><span class="op">(</span></span>
<span>  <span class="va">licor_data</span>,                       <span class="co"># The `exdf` object containing the curves</span></span>
<span>  <span class="va">licor_data</span><span class="op">[</span>, <span class="st">'curve_identifier'</span><span class="op">]</span>, <span class="co"># A factor used to split `licor_data` into chunks</span></span>
<span>  <span class="va">fit_c4_aci_hyperbola</span>              <span class="co"># The function to apply to each chunk of `licor_data`</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Having made the fits, we can view the results:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the C4 A-Ci fits that were made using the empirical model</span></span>
<span><span class="fu"><a href="../reference/plot_c4_aci_hyperbola_fit.html">plot_c4_aci_hyperbola_fit</a></span><span class="op">(</span></span>
<span>  <span class="va">c4_aci_results_hyperbola</span>,</span>
<span>  <span class="st">'curve_identifier'</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>  main <span class="op">=</span> <span class="st">'Empirical fits using a hyperbola'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_c4_aci_curves_files/figure-html/plot_aci_fit_hyperbola-1.png" width="720" style="display: block; margin: auto;"></p>
<p>The hyperbola is used to estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">V_{max}</annotation></semantics></math>,
which characterizes the maximum gross assimilation rate that occurs at
high
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>,
such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>=</mo><msub><mi>V</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>−</mo><msub><mi>R</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">A_{max} =
V_{max} - R_L</annotation></semantics></math> is the highest net
assimilation rate. It is common to pair this with an estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>p</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">V_{pmax}</annotation></semantics></math>
made by fitting a mechanistic equation to the
low-<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>
part of the curve:</p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>n</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>V</mi><mrow><mi>p</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>⋅</mo><msub><mi>C</mi><mi>i</mi></msub></mrow><mrow><msub><mi>C</mi><mi>i</mi></msub><mo>+</mo><msub><mi>K</mi><mi>p</mi></msub></mrow></mfrac><mo>−</mo><msub><mi>R</mi><mi>L</mi></msub></mrow><annotation encoding="application/x-tex">A_n = \frac{V_{pmax} \cdot C_i}{C_i + K_p} - R_L</annotation></semantics></math></p>
<p>The full mechanistic model reduces to this particular equation when
the following conditions are met:</p>
<ul>
<li><p>The bundle sheath conductance
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mrow><mi>b</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">g_{bs}</annotation></semantics></math>)
is zero.</p></li>
<li><p>No photosystem II activity occurs in the bundle sheath
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mrow><mi>P</mi><mi>S</mi><mi>I</mi><mi>I</mi></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\alpha_{PSII} = 0</annotation></semantics></math>).</p></li>
<li><p>The CO<sub>2</sub> concentration in the mesophyll is identical to
the intercellular CO<sub>2</sub> concentration. This is the case when
mesophyll conductance is infinitely large.</p></li>
</ul>
<p>Here we will fit this equation to just the measured points where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>
is below 60 ppm. To do this, we will also need to specify an infinite
value of mesophyll conductance, overriding the default value.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get a subset of the data where Ci is below the threshold value</span></span>
<span><span class="va">licor_data_low_ci</span> <span class="op">&lt;-</span> <span class="va">licor_data</span><span class="op">[</span><span class="va">licor_data</span><span class="op">[</span>, <span class="st">'Ci'</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="fl">60</span>, , <span class="cn">TRUE</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># The default optimizer uses randomness, so we will set a seed to ensure the</span></span>
<span><span class="co"># results from this fit are always identical</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit the C4 A-Ci curves with the mechanistic Vpmax equation</span></span>
<span><span class="va">c4_aci_results_vpmax</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/consolidate.html">consolidate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span><span class="op">(</span></span>
<span>  <span class="va">licor_data_low_ci</span>,                       <span class="co"># The `exdf` object containing the curves</span></span>
<span>  <span class="va">licor_data_low_ci</span><span class="op">[</span>, <span class="st">'curve_identifier'</span><span class="op">]</span>, <span class="co"># A factor used to split `licor_data` into chunks</span></span>
<span>  <span class="va">fit_c4_aci</span>,                              <span class="co"># The function to apply to each chunk of `licor_data`</span></span>
<span>  fit_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    Vcmax_at_25 <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    Vpr <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    J_at_25 <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    alpha_psii <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    gbs <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    gmc_at_25 <span class="op">=</span> <span class="cn">Inf</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Having made the fits, we can view the results:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the C4 A-Ci fits that were made to the low Ci part of the curves</span></span>
<span><span class="fu"><a href="../reference/plot_c4_aci_fit.html">plot_c4_aci_fit</a></span><span class="op">(</span></span>
<span>  <span class="va">c4_aci_results_vpmax</span>,</span>
<span>  <span class="st">'curve_identifier'</span>,</span>
<span>  <span class="st">'Ci'</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">60</span><span class="op">)</span>,</span>
<span>  main <span class="op">=</span> <span class="st">'Mechanistic fits to the low Ci part of each curve'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_c4_aci_curves_files/figure-html/plot_aci_fit_vpmax-1.png" width="720" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="examining-the-results">Examining the Results<a class="anchor" aria-label="anchor" href="#examining-the-results"></a>
</h2>
<div class="section level3">
<h3 id="accessing-best-fit-estimates-and-confidence-intervals">Accessing Best-Fit Estimates and Confidence Intervals<a class="anchor" aria-label="anchor" href="#accessing-best-fit-estimates-and-confidence-intervals"></a>
</h3>
<p>Each fit returns best-fit values and confidence limits for each
parameter, which are stored in <code>parameters</code> element of the
output list, another <code>exdf</code> object. These values can be
viewed directly from R. For example, we can look at the estimated
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>p</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">V_{pmax}</annotation></semantics></math>
values from each mechanistic fit as follows:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Specify columns to view</span></span>
<span><span class="va">vpmax_columns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">'curve_identifier'</span>,</span>
<span>  <span class="st">'Vpmax_at_25_lower'</span>,</span>
<span>  <span class="st">'Vpmax_at_25'</span>,</span>
<span>  <span class="st">'Vpmax_at_25_upper'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View Vpmax values from the mechanistic fit that assumed Rubisco limitations</span></span>
<span><span class="va">c4_aci_results_rubisco</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span>, <span class="va">vpmax_columns</span><span class="op">]</span></span>
<span><span class="co">#&gt;      curve_identifier Vpmax_at_25_lower Vpmax_at_25 Vpmax_at_25_upper</span></span>
<span><span class="co">#&gt; 1   ripe1 - maize - 5          133.8529    158.2040          187.1139</span></span>
<span><span class="co">#&gt; 2 ripe1 - sorghum - 2          123.4999    149.4453          179.5492</span></span>
<span><span class="co">#&gt; 3 ripe1 - sorghum - 3          115.9223    124.2466          133.2167</span></span>
<span><span class="co">#&gt; 4   ripe2 - maize - 2          135.7686    154.8675          176.9160</span></span>
<span><span class="co">#&gt; 5 ripe2 - sorghum - 3          110.0679    131.1353          156.6364</span></span>
<span></span>
<span><span class="co"># View Vpmax values from the mechanistic fit that assumed light limitations</span></span>
<span><span class="va">c4_aci_results_light</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span>, <span class="va">vpmax_columns</span><span class="op">]</span></span>
<span><span class="co">#&gt;      curve_identifier Vpmax_at_25_lower Vpmax_at_25 Vpmax_at_25_upper</span></span>
<span><span class="co">#&gt; 1   ripe1 - maize - 5          76.89114    90.46091          110.6617</span></span>
<span><span class="co">#&gt; 2 ripe1 - sorghum - 2          85.62048   104.52367          123.4277</span></span>
<span><span class="co">#&gt; 3 ripe1 - sorghum - 3          75.98196    83.72335           91.4649</span></span>
<span><span class="co">#&gt; 4   ripe2 - maize - 2          92.12211    99.30727          108.7100</span></span>
<span><span class="co">#&gt; 5 ripe2 - sorghum - 3          74.08761    85.42020           96.7532</span></span>
<span></span>
<span><span class="co"># View Vpmax values from the mechanistic fit to the low-Ci part of the curves</span></span>
<span><span class="va">c4_aci_results_vpmax</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span>, <span class="va">vpmax_columns</span><span class="op">]</span></span>
<span><span class="co">#&gt;      curve_identifier Vpmax_at_25_lower Vpmax_at_25 Vpmax_at_25_upper</span></span>
<span><span class="co">#&gt; 1   ripe1 - maize - 5          75.32530    82.31016          89.29503</span></span>
<span><span class="co">#&gt; 2 ripe1 - sorghum - 2          65.23357    70.17602          75.11849</span></span>
<span><span class="co">#&gt; 3 ripe1 - sorghum - 3          70.41548    73.30350          76.19152</span></span>
<span><span class="co">#&gt; 4   ripe2 - maize - 2          62.10453    64.47364          66.84276</span></span>
<span><span class="co">#&gt; 5 ripe2 - sorghum - 3          55.37449    57.38421          59.39391</span></span></code></pre></div>
<p>Here we can see that the estimates made from the mechanistic fit with
Rubisco limitations are generally the largest, while those made from
just the
low-<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>
points are the lowest.</p>
<p>Estimates of other parameters, such as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>c</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">V_{cmax}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>J</mi><annotation encoding="application/x-tex">J</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">V_{max}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>L</mi></msub><annotation encoding="application/x-tex">R_L</annotation></semantics></math>
can be accessed with similar commands.</p>
</div>
<div class="section level3">
<h3 id="visualizing-average-best-fit-parameters">Visualizing Average Best-Fit Parameters<a class="anchor" aria-label="anchor" href="#visualizing-average-best-fit-parameters"></a>
</h3>
<p>We can also visualize the best-fit parameters using plots. One way to
do this is by using the <code>barchart_with_errorbars</code> function
from <code>PhotoGEA</code> to create barcharts of the average values for
each species. This function will ignore any <code>NA</code> values from
curves where a parameter could not be reliably estimated, and the error
bars will show the standard error of the mean for each species. Here we
will take a look at the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>V</mi><mrow><mi>c</mi><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><annotation encoding="application/x-tex">V_{cmax}</annotation></semantics></math>
estimates.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make a barchart showing average Vcmax values</span></span>
<span><span class="fu"><a href="../reference/barchart_with_errorbars.html">barchart_with_errorbars</a></span><span class="op">(</span></span>
<span>  <span class="va">c4_aci_results_rubisco</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span>, <span class="st">'Vcmax_at_25'</span><span class="op">]</span>,</span>
<span>  <span class="va">c4_aci_results_rubisco</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span>, <span class="st">'species'</span><span class="op">]</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">'Species'</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Vcmax at 25 degrees C ('</span>, <span class="va">c4_aci_results_rubisco</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Vcmax_at_25</span>, <span class="st">')'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_c4_aci_curves_files/figure-html/vcmax_barchart-1.png" width="720" style="display: block; margin: auto;"></p>
<p>Another option is to create box-whisper plots using the
<code>bwplot</code> function from the <code>lattice</code> package:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make a boxplot showing the distribution of Vcmax values</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">bwplot</a></span><span class="op">(</span></span>
<span>  <span class="va">Vcmax_at_25</span> <span class="op">~</span> <span class="va">species</span>,</span>
<span>  data <span class="op">=</span> <span class="va">c4_aci_results_rubisco</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">'Species'</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Vcmax at 25 degrees C ('</span>, <span class="va">c4_aci_results_rubisco</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Vcmax_at_25</span>, <span class="st">')'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_c4_aci_curves_files/figure-html/vcmax_bwplot-1.png" width="720" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="calculating-average-best-fit-parameters">Calculating Average Best-Fit Parameters<a class="anchor" aria-label="anchor" href="#calculating-average-best-fit-parameters"></a>
</h3>
<p>We can also calculate average values and standard errors of the
best-fit parameters for each species using the <code>basic_stats</code>
function from <code>PhotoGEA</code>:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compute the average and standard error of each parameter for each species</span></span>
<span><span class="co"># from one of the mechanistic fits</span></span>
<span><span class="va">c4_aci_averages_rubisco</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/basic_stats.html">basic_stats</a></span><span class="op">(</span><span class="va">c4_aci_results_rubisco</span><span class="op">$</span><span class="va">parameters</span>, <span class="st">'species'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View the averages and errors</span></span>
<span><span class="va">columns_to_view</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">'species'</span>,</span>
<span>  <span class="st">'Vcmax_at_25_avg'</span>, <span class="st">'Vcmax_at_25_stderr'</span>,</span>
<span>  <span class="st">'Vpmax_at_25_avg'</span>, <span class="st">'Vpmax_at_25_stderr'</span>,</span>
<span>  <span class="st">'RL_at_25_avg'</span>, <span class="st">'RL_at_25_stderr'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">c4_aci_averages_rubisco</span><span class="op">[</span> , <span class="va">columns_to_view</span><span class="op">]</span></span>
<span><span class="co">#&gt;   species Vcmax_at_25_avg Vcmax_at_25_stderr Vpmax_at_25_avg Vpmax_at_25_stderr</span></span>
<span><span class="co">#&gt; 1   maize        36.53579           2.628570        156.5358           1.668228</span></span>
<span><span class="co">#&gt; 2 sorghum        38.39997           2.117231        134.9424           7.519182</span></span>
<span><span class="co">#&gt;   RL_at_25_avg RL_at_25_stderr</span></span>
<span><span class="co">#&gt; 1   -0.1333101        2.842192</span></span>
<span><span class="co">#&gt; 2   -0.9351559        1.442296</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="other-ideas-for-synthesizing-results">Other Ideas for Synthesizing Results<a class="anchor" aria-label="anchor" href="#other-ideas-for-synthesizing-results"></a>
</h3>
<p>Statistical tests to check for differences between groups can be
performed within R using other packages such as <code>onewaytests</code>
or <code>DescTools</code>. Alternatively, the parameter values can be
exported to a comma-separated-value (CSV) file and analyzed in another
software environment like <code>jmp</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="customizing-your-script">Customizing Your Script<a class="anchor" aria-label="anchor" href="#customizing-your-script"></a>
</h2>
<p>Note that most of the commands in this vignette have been written in
a general way so they can be used as the basis for your own analysis
script (see <a href="#commands-from-this-document">Commands From This
Document</a>). In order to use them in your own script, some or all of
the following changes may be required. There may also be others not
specifically mentioned here.</p>
<div class="section level3">
<h3 id="input-files">Input Files<a class="anchor" aria-label="anchor" href="#input-files"></a>
</h3>
<p>The file paths specified in <code>file_paths</code> will need to be
modified so they point to your Licor files. One way to do this in your
own script is to simply write out relative or absolute paths to the
files you wish to load. For example, you could replace the previous
definition of <code>file_paths</code> with this one:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define a vector of paths to the files we wish to load</span></span>
<span><span class="va">file_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">'myfile1.xlsx'</span>,        <span class="co"># `myfile1.xlsx` must be in the current working directory</span></span>
<span>  <span class="st">'C:/documents/myfile2'</span> <span class="co"># This is an absolute path to `myfile2`</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>You may also want to consider using the
<code>choose_input_licor_files</code> function from
<code>PhotoGEA</code>; this function will create a pop-up browser window
where you can interactively select a set of files. Sometimes this is
more convenient than writing out file paths or names. For example, you
could replace the previous definition of <code>file_paths</code> with
this one:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Interactively define a vector of paths to the files we wish to load</span></span>
<span><span class="va">file_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/choose_input_files.html">choose_input_licor_files</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Unfortunately, <code>choose_input_licor_files</code> is only
available in interactive R sessions running on Microsoft Windows, but
there is also a platform-independent option:
<code>choose_input_files</code>. See the <em>Translation</em> section of
the <a href="developing_a_data_analysis_pipeline.html#translation">Developing a
Data Analysis Pipeline</a> vignette for more details.</p>
</div>
<div class="section level3">
<h3 id="curve-identifier">Curve Identifier<a class="anchor" aria-label="anchor" href="#curve-identifier"></a>
</h3>
<p>Depending on which user constants are defined in your Licor Excel
files, you may need to modify the definition of the
<code>curve_identifier</code> column.</p>
</div>
<div class="section level3">
<h3 id="data-cleaning">Data Cleaning<a class="anchor" aria-label="anchor" href="#data-cleaning"></a>
</h3>
<p>Depending on the qualitative data checks, you may need to change the
input arguments to <code>remove_points</code>. It might also not be
necessary to remove the unstable points before performing the fits.
Often, it is helpful to not perform any data cleaning at first, and then
remove problematic points if they seem to cause problems with the
fits.</p>
</div>
<div class="section level3">
<h3 id="averages-and-standard-errors">Averages and Standard Errors<a class="anchor" aria-label="anchor" href="#averages-and-standard-errors"></a>
</h3>
<p>Depending on how your data is organized, you may want to change the
column used to divide the data when calculating averages and standard
errors.</p>
</div>
<div class="section level3">
<h3 id="plots">Plots<a class="anchor" aria-label="anchor" href="#plots"></a>
</h3>
<p>You may need to change the axis limits in some or all of the plots.
Alternatively, you can remove them, allowing <code>xyplot</code> to
automatically choose them for you.</p>
<p>You may also want to consider using the <code>pdf_print</code>
function from <code>PhotoGEA</code> to save some or all of your plots as
PDFs. See the help page for more info: <code><a href="../reference/pdf_print.html">?pdf_print</a></code>.</p>
</div>
<div class="section level3">
<h3 id="saving-results">Saving Results<a class="anchor" aria-label="anchor" href="#saving-results"></a>
</h3>
<p>You may want to use <code>write.csv.exdf</code> to save some or all
of the fitting results as CSV files. When writing the contents of an
<code>exdf</code> object to a CSV file, using
<code>write.csv.exdf</code> rather than <code>write.csv</code> will
ensure that units are included with each column.</p>
<p>For example, the following commands will save the results from one of
the mechanistic fits, allowing you to interactively choose output
filenames for the resulting CSV files:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/csv.exdf.html">write.csv.exdf</a></span><span class="op">(</span><span class="va">c4_aci_results_rubisco</span><span class="op">$</span><span class="va">fits</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.choose.html" class="external-link">file.choose</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/csv.exdf.html">write.csv.exdf</a></span><span class="op">(</span><span class="va">c4_aci_results_rubisco</span><span class="op">$</span><span class="va">parameters</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.choose.html" class="external-link">file.choose</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/csv.exdf.html">write.csv.exdf</a></span><span class="op">(</span><span class="va">c4_aci_averages_rubisco</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.choose.html" class="external-link">file.choose</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="commands-from-this-document">Commands From This Document<a class="anchor" aria-label="anchor" href="#commands-from-this-document"></a>
</h2>
<p>The following code chunk includes all the central commands used
throughout this document. They are compiled here to make them easy to
copy/paste into a text file to initialize your own script. Annotation
has also been added to clearly indicate the four steps involved in data
analysis, as described in the <a href="developing_a_data_analysis_pipeline.html">Developing a Data
Analysis Pipeline</a> vignette.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="do">### PRELIMINARIES:</span></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a><span class="do">### Loading packages, defining constants, creating helping functions, etc.</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a><span class="fu">library</span>(PhotoGEA)</span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a><span class="do">### TRANSLATION:</span></span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a><span class="do">### Creating convenient R objects from raw data files</span></span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a><span class="do">## IMPORTANT: When loading your own files, it is not advised to use</span></span>
<span id="cb34-16"><a href="#cb34-16" tabindex="-1"></a><span class="do">## `PhotoGEA_example_file_path` as in the code below. Instead, write out the</span></span>
<span id="cb34-17"><a href="#cb34-17" tabindex="-1"></a><span class="do">## names or use the `choose_input_licor_files` function.</span></span>
<span id="cb34-18"><a href="#cb34-18" tabindex="-1"></a></span>
<span id="cb34-19"><a href="#cb34-19" tabindex="-1"></a><span class="co"># Define a vector of paths to the files we wish to load; in this case, we are</span></span>
<span id="cb34-20"><a href="#cb34-20" tabindex="-1"></a><span class="co"># loading example files included with the PhotoGEA package</span></span>
<span id="cb34-21"><a href="#cb34-21" tabindex="-1"></a>file_paths <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb34-22"><a href="#cb34-22" tabindex="-1"></a>  <span class="fu">PhotoGEA_example_file_path</span>(<span class="st">'c4_aci_1.xlsx'</span>),</span>
<span id="cb34-23"><a href="#cb34-23" tabindex="-1"></a>  <span class="fu">PhotoGEA_example_file_path</span>(<span class="st">'c4_aci_2.xlsx'</span>)</span>
<span id="cb34-24"><a href="#cb34-24" tabindex="-1"></a>)</span>
<span id="cb34-25"><a href="#cb34-25" tabindex="-1"></a></span>
<span id="cb34-26"><a href="#cb34-26" tabindex="-1"></a><span class="co"># Load each file, storing the result in a list</span></span>
<span id="cb34-27"><a href="#cb34-27" tabindex="-1"></a>licor_exdf_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(file_paths, <span class="cf">function</span>(fpath) {</span>
<span id="cb34-28"><a href="#cb34-28" tabindex="-1"></a>  <span class="fu">read_gasex_file</span>(fpath, <span class="st">'time'</span>)</span>
<span id="cb34-29"><a href="#cb34-29" tabindex="-1"></a>})</span>
<span id="cb34-30"><a href="#cb34-30" tabindex="-1"></a></span>
<span id="cb34-31"><a href="#cb34-31" tabindex="-1"></a><span class="co"># Get the names of all columns that are present in all of the Licor files</span></span>
<span id="cb34-32"><a href="#cb34-32" tabindex="-1"></a>columns_to_keep <span class="ot">&lt;-</span> <span class="fu">do.call</span>(identify_common_columns, licor_exdf_list)</span>
<span id="cb34-33"><a href="#cb34-33" tabindex="-1"></a></span>
<span id="cb34-34"><a href="#cb34-34" tabindex="-1"></a><span class="co"># Extract just these columns</span></span>
<span id="cb34-35"><a href="#cb34-35" tabindex="-1"></a>licor_exdf_list <span class="ot">&lt;-</span> <span class="fu">lapply</span>(licor_exdf_list, <span class="cf">function</span>(x) {</span>
<span id="cb34-36"><a href="#cb34-36" tabindex="-1"></a>  x[ , columns_to_keep, <span class="cn">TRUE</span>]</span>
<span id="cb34-37"><a href="#cb34-37" tabindex="-1"></a>})</span>
<span id="cb34-38"><a href="#cb34-38" tabindex="-1"></a></span>
<span id="cb34-39"><a href="#cb34-39" tabindex="-1"></a><span class="co"># Use `rbind` to combine all the data</span></span>
<span id="cb34-40"><a href="#cb34-40" tabindex="-1"></a>licor_data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, licor_exdf_list)</span>
<span id="cb34-41"><a href="#cb34-41" tabindex="-1"></a></span>
<span id="cb34-42"><a href="#cb34-42" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb34-43"><a href="#cb34-43" tabindex="-1"></a><span class="do">### VALIDATION:</span></span>
<span id="cb34-44"><a href="#cb34-44" tabindex="-1"></a><span class="do">### Organizing the data, checking its consistency and quality, cleaning it</span></span>
<span id="cb34-45"><a href="#cb34-45" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb34-46"><a href="#cb34-46" tabindex="-1"></a></span>
<span id="cb34-47"><a href="#cb34-47" tabindex="-1"></a><span class="co"># Create a new identifier column formatted like `instrument - species - plot`</span></span>
<span id="cb34-48"><a href="#cb34-48" tabindex="-1"></a>licor_data[ , <span class="st">'curve_identifier'</span>] <span class="ot">&lt;-</span></span>
<span id="cb34-49"><a href="#cb34-49" tabindex="-1"></a>  <span class="fu">paste</span>(licor_data[ , <span class="st">'instrument'</span>], <span class="st">'-'</span>, licor_data[ , <span class="st">'species'</span>], <span class="st">'-'</span>, licor_data[ , <span class="st">'plot'</span>])</span>
<span id="cb34-50"><a href="#cb34-50" tabindex="-1"></a></span>
<span id="cb34-51"><a href="#cb34-51" tabindex="-1"></a><span class="co"># Make sure the data meets basic requirements</span></span>
<span id="cb34-52"><a href="#cb34-52" tabindex="-1"></a><span class="fu">check_response_curve_data</span>(licor_data, <span class="st">'curve_identifier'</span>, <span class="dv">16</span>, <span class="st">'CO2_r_sp'</span>)</span>
<span id="cb34-53"><a href="#cb34-53" tabindex="-1"></a></span>
<span id="cb34-54"><a href="#cb34-54" tabindex="-1"></a><span class="co"># Remove points with duplicated `CO2_r_sp` values and order by `Ci`</span></span>
<span id="cb34-55"><a href="#cb34-55" tabindex="-1"></a>licor_data <span class="ot">&lt;-</span> <span class="fu">organize_response_curve_data</span>(</span>
<span id="cb34-56"><a href="#cb34-56" tabindex="-1"></a>    licor_data,</span>
<span id="cb34-57"><a href="#cb34-57" tabindex="-1"></a>    <span class="st">'curve_identifier'</span>,</span>
<span id="cb34-58"><a href="#cb34-58" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">10</span>),</span>
<span id="cb34-59"><a href="#cb34-59" tabindex="-1"></a>    <span class="st">'Ci'</span></span>
<span id="cb34-60"><a href="#cb34-60" tabindex="-1"></a>)</span>
<span id="cb34-61"><a href="#cb34-61" tabindex="-1"></a></span>
<span id="cb34-62"><a href="#cb34-62" tabindex="-1"></a><span class="co"># Plot all A-Ci curves in the data set</span></span>
<span id="cb34-63"><a href="#cb34-63" tabindex="-1"></a><span class="fu">xyplot</span>(</span>
<span id="cb34-64"><a href="#cb34-64" tabindex="-1"></a>  A <span class="sc">~</span> Ci <span class="sc">|</span> curve_identifier,</span>
<span id="cb34-65"><a href="#cb34-65" tabindex="-1"></a>  <span class="at">data =</span> licor_data<span class="sc">$</span>main_data,</span>
<span id="cb34-66"><a href="#cb34-66" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb34-67"><a href="#cb34-67" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb34-68"><a href="#cb34-68" tabindex="-1"></a>  <span class="at">auto =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-69"><a href="#cb34-69" tabindex="-1"></a>  <span class="at">grid =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-70"><a href="#cb34-70" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="fu">paste</span>(<span class="st">'Intercellular CO2 concentration ['</span>, licor_data<span class="sc">$</span>units<span class="sc">$</span>Ci, <span class="st">']'</span>),</span>
<span id="cb34-71"><a href="#cb34-71" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="fu">paste</span>(<span class="st">'Net CO2 assimilation rate ['</span>, licor_data<span class="sc">$</span>units<span class="sc">$</span>A, <span class="st">']'</span>)</span>
<span id="cb34-72"><a href="#cb34-72" tabindex="-1"></a>)</span>
<span id="cb34-73"><a href="#cb34-73" tabindex="-1"></a></span>
<span id="cb34-74"><a href="#cb34-74" tabindex="-1"></a><span class="co"># Make a plot to check humidity control</span></span>
<span id="cb34-75"><a href="#cb34-75" tabindex="-1"></a><span class="fu">xyplot</span>(</span>
<span id="cb34-76"><a href="#cb34-76" tabindex="-1"></a>  RHcham <span class="sc">+</span> <span class="st">`</span><span class="at">Humidifier_%</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">Desiccant_%</span><span class="st">`</span> <span class="sc">~</span> Ci <span class="sc">|</span> curve_identifier,</span>
<span id="cb34-77"><a href="#cb34-77" tabindex="-1"></a>  <span class="at">data =</span> licor_data<span class="sc">$</span>main_data,</span>
<span id="cb34-78"><a href="#cb34-78" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb34-79"><a href="#cb34-79" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb34-80"><a href="#cb34-80" tabindex="-1"></a>  <span class="at">auto =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-81"><a href="#cb34-81" tabindex="-1"></a>  <span class="at">grid =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-82"><a href="#cb34-82" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>),</span>
<span id="cb34-83"><a href="#cb34-83" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="fu">paste</span>(<span class="st">'Intercellular CO2 concentration ['</span>, licor_data<span class="sc">$</span>units<span class="sc">$</span>Ci, <span class="st">']'</span>)</span>
<span id="cb34-84"><a href="#cb34-84" tabindex="-1"></a>)</span>
<span id="cb34-85"><a href="#cb34-85" tabindex="-1"></a></span>
<span id="cb34-86"><a href="#cb34-86" tabindex="-1"></a><span class="co"># Make a plot to check temperature control</span></span>
<span id="cb34-87"><a href="#cb34-87" tabindex="-1"></a><span class="fu">xyplot</span>(</span>
<span id="cb34-88"><a href="#cb34-88" tabindex="-1"></a>  TleafCnd <span class="sc">+</span> Txchg <span class="sc">~</span> Ci <span class="sc">|</span> curve_identifier,</span>
<span id="cb34-89"><a href="#cb34-89" tabindex="-1"></a>  <span class="at">data =</span> licor_data<span class="sc">$</span>main_data,</span>
<span id="cb34-90"><a href="#cb34-90" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb34-91"><a href="#cb34-91" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb34-92"><a href="#cb34-92" tabindex="-1"></a>  <span class="at">auto =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-93"><a href="#cb34-93" tabindex="-1"></a>  <span class="at">grid =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-94"><a href="#cb34-94" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">40</span>),</span>
<span id="cb34-95"><a href="#cb34-95" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="fu">paste</span>(<span class="st">'Intercellular CO2 concentration ['</span>, licor_data<span class="sc">$</span>units<span class="sc">$</span>Ci, <span class="st">']'</span>),</span>
<span id="cb34-96"><a href="#cb34-96" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="fu">paste0</span>(<span class="st">'Temperature ('</span>, licor_data<span class="sc">$</span>units<span class="sc">$</span>TleafCnd, <span class="st">')'</span>)</span>
<span id="cb34-97"><a href="#cb34-97" tabindex="-1"></a>)</span>
<span id="cb34-98"><a href="#cb34-98" tabindex="-1"></a></span>
<span id="cb34-99"><a href="#cb34-99" tabindex="-1"></a><span class="co"># Make a plot to check CO2 control</span></span>
<span id="cb34-100"><a href="#cb34-100" tabindex="-1"></a><span class="fu">xyplot</span>(</span>
<span id="cb34-101"><a href="#cb34-101" tabindex="-1"></a>  CO2_s <span class="sc">+</span> CO2_r <span class="sc">+</span> CO2_r_sp <span class="sc">~</span> Ci <span class="sc">|</span> curve_identifier,</span>
<span id="cb34-102"><a href="#cb34-102" tabindex="-1"></a>  <span class="at">data =</span> licor_data<span class="sc">$</span>main_data,</span>
<span id="cb34-103"><a href="#cb34-103" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb34-104"><a href="#cb34-104" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb34-105"><a href="#cb34-105" tabindex="-1"></a>  <span class="at">auto =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-106"><a href="#cb34-106" tabindex="-1"></a>  <span class="at">grid =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-107"><a href="#cb34-107" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="fu">paste</span>(<span class="st">'Intercellular CO2 concentration ['</span>, licor_data<span class="sc">$</span>units<span class="sc">$</span>Ci, <span class="st">']'</span>),</span>
<span id="cb34-108"><a href="#cb34-108" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="fu">paste0</span>(<span class="st">'CO2 concentration ('</span>, licor_data<span class="sc">$</span>units<span class="sc">$</span>CO2_r, <span class="st">')'</span>)</span>
<span id="cb34-109"><a href="#cb34-109" tabindex="-1"></a>)</span>
<span id="cb34-110"><a href="#cb34-110" tabindex="-1"></a></span>
<span id="cb34-111"><a href="#cb34-111" tabindex="-1"></a><span class="co"># Make a plot to check stability criteria</span></span>
<span id="cb34-112"><a href="#cb34-112" tabindex="-1"></a><span class="fu">xyplot</span>(</span>
<span id="cb34-113"><a href="#cb34-113" tabindex="-1"></a>  <span class="st">`</span><span class="at">A:OK</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">gsw:OK</span><span class="st">`</span> <span class="sc">+</span> Stable <span class="sc">~</span> Ci <span class="sc">|</span> curve_identifier,</span>
<span id="cb34-114"><a href="#cb34-114" tabindex="-1"></a>  <span class="at">data =</span> licor_data<span class="sc">$</span>main_data,</span>
<span id="cb34-115"><a href="#cb34-115" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb34-116"><a href="#cb34-116" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb34-117"><a href="#cb34-117" tabindex="-1"></a>  <span class="at">auto =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-118"><a href="#cb34-118" tabindex="-1"></a>  <span class="at">grid =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-119"><a href="#cb34-119" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="fu">paste</span>(<span class="st">'Intercellular CO2 concentration ['</span>, licor_data<span class="sc">$</span>units<span class="sc">$</span>Ci, <span class="st">']'</span>)</span>
<span id="cb34-120"><a href="#cb34-120" tabindex="-1"></a>)</span>
<span id="cb34-121"><a href="#cb34-121" tabindex="-1"></a></span>
<span id="cb34-122"><a href="#cb34-122" tabindex="-1"></a><span class="do">## IMPORTANT: When analyzing your own files, it is not advised to remove any</span></span>
<span id="cb34-123"><a href="#cb34-123" tabindex="-1"></a><span class="do">## points for the initial fits. Only remove unstable or unusual points if it is</span></span>
<span id="cb34-124"><a href="#cb34-124" tabindex="-1"></a><span class="do">## necessary in order to get good fits.</span></span>
<span id="cb34-125"><a href="#cb34-125" tabindex="-1"></a></span>
<span id="cb34-126"><a href="#cb34-126" tabindex="-1"></a><span class="sc">&lt;</span><span class="er">&lt;</span>remove_unstable_points<span class="sc">&gt;</span><span class="er">&gt;</span></span>
<span id="cb34-127"><a href="#cb34-127" tabindex="-1"></a></span>
<span id="cb34-128"><a href="#cb34-128" tabindex="-1"></a><span class="co"># Remove points where `instrument` is `ripe1` and `CO2_r_sp` is 1800</span></span>
<span id="cb34-129"><a href="#cb34-129" tabindex="-1"></a>licor_data <span class="ot">&lt;-</span> <span class="fu">remove_points</span>(</span>
<span id="cb34-130"><a href="#cb34-130" tabindex="-1"></a>  licor_data,</span>
<span id="cb34-131"><a href="#cb34-131" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">instrument =</span> <span class="st">'ripe1'</span>, <span class="at">CO2_r_sp =</span> <span class="dv">1800</span>),</span>
<span id="cb34-132"><a href="#cb34-132" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">'exclude'</span></span>
<span id="cb34-133"><a href="#cb34-133" tabindex="-1"></a>)</span>
<span id="cb34-134"><a href="#cb34-134" tabindex="-1"></a></span>
<span id="cb34-135"><a href="#cb34-135" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb34-136"><a href="#cb34-136" tabindex="-1"></a><span class="do">### PROCESSING:</span></span>
<span id="cb34-137"><a href="#cb34-137" tabindex="-1"></a><span class="do">### Extracting new pieces of information from the data</span></span>
<span id="cb34-138"><a href="#cb34-138" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb34-139"><a href="#cb34-139" tabindex="-1"></a></span>
<span id="cb34-140"><a href="#cb34-140" tabindex="-1"></a><span class="co"># Calculate temperature-dependent values of C4 photosynthetic parameters</span></span>
<span id="cb34-141"><a href="#cb34-141" tabindex="-1"></a>licor_data <span class="ot">&lt;-</span> <span class="fu">calculate_temperature_response</span>(licor_data, c4_temperature_param_vc)</span>
<span id="cb34-142"><a href="#cb34-142" tabindex="-1"></a></span>
<span id="cb34-143"><a href="#cb34-143" tabindex="-1"></a><span class="co"># Calculate the total pressure in the Licor chamber</span></span>
<span id="cb34-144"><a href="#cb34-144" tabindex="-1"></a>licor_data <span class="ot">&lt;-</span> <span class="fu">calculate_total_pressure</span>(licor_data)</span>
<span id="cb34-145"><a href="#cb34-145" tabindex="-1"></a></span>
<span id="cb34-146"><a href="#cb34-146" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb34-147"><a href="#cb34-147" tabindex="-1"></a><span class="do">## Mechanistic fits, assuming Rubisco limitations</span></span>
<span id="cb34-148"><a href="#cb34-148" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb34-149"><a href="#cb34-149" tabindex="-1"></a></span>
<span id="cb34-150"><a href="#cb34-150" tabindex="-1"></a><span class="co"># The default optimizer uses randomness, so we will set a seed to ensure the</span></span>
<span id="cb34-151"><a href="#cb34-151" tabindex="-1"></a><span class="co"># results from this fit are always identical</span></span>
<span id="cb34-152"><a href="#cb34-152" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb34-153"><a href="#cb34-153" tabindex="-1"></a></span>
<span id="cb34-154"><a href="#cb34-154" tabindex="-1"></a><span class="co"># Fit the C4 A-Ci curves with the mechanistic model, assuming Rubisco limitations</span></span>
<span id="cb34-155"><a href="#cb34-155" tabindex="-1"></a>c4_aci_results_rubisco <span class="ot">&lt;-</span> <span class="fu">consolidate</span>(<span class="fu">by</span>(</span>
<span id="cb34-156"><a href="#cb34-156" tabindex="-1"></a>  licor_data,                       <span class="co"># The `exdf` object containing the curves</span></span>
<span id="cb34-157"><a href="#cb34-157" tabindex="-1"></a>  licor_data[, <span class="st">'curve_identifier'</span>], <span class="co"># A factor used to split `licor_data` into chunks</span></span>
<span id="cb34-158"><a href="#cb34-158" tabindex="-1"></a>  fit_c4_aci,                       <span class="co"># The function to apply to each chunk of `licor_data`</span></span>
<span id="cb34-159"><a href="#cb34-159" tabindex="-1"></a>  <span class="at">Ca_atmospheric =</span> <span class="dv">420</span>,             <span class="co"># Used to estimate the operating point</span></span>
<span id="cb34-160"><a href="#cb34-160" tabindex="-1"></a>  <span class="at">fit_options =</span> <span class="fu">list</span>(<span class="at">Vcmax_at_25 =</span> <span class="st">'fit'</span>, <span class="at">Vpr =</span> <span class="dv">1000</span>, <span class="at">J_at_25 =</span> <span class="dv">1000</span>)</span>
<span id="cb34-161"><a href="#cb34-161" tabindex="-1"></a>))</span>
<span id="cb34-162"><a href="#cb34-162" tabindex="-1"></a></span>
<span id="cb34-163"><a href="#cb34-163" tabindex="-1"></a><span class="co"># Plot the C4 A-Ci fits that were made assuming Rubisco limitations</span></span>
<span id="cb34-164"><a href="#cb34-164" tabindex="-1"></a><span class="fu">plot_c4_aci_fit</span>(</span>
<span id="cb34-165"><a href="#cb34-165" tabindex="-1"></a>  c4_aci_results_rubisco,</span>
<span id="cb34-166"><a href="#cb34-166" tabindex="-1"></a>  <span class="st">'curve_identifier'</span>,</span>
<span id="cb34-167"><a href="#cb34-167" tabindex="-1"></a>  <span class="st">'Ci'</span>,</span>
<span id="cb34-168"><a href="#cb34-168" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">100</span>),</span>
<span id="cb34-169"><a href="#cb34-169" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">'Mechanistic fits assuming Rubisco limitations'</span></span>
<span id="cb34-170"><a href="#cb34-170" tabindex="-1"></a>)</span>
<span id="cb34-171"><a href="#cb34-171" tabindex="-1"></a></span>
<span id="cb34-172"><a href="#cb34-172" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb34-173"><a href="#cb34-173" tabindex="-1"></a><span class="do">## Mechanistic fits, assuming light limitations</span></span>
<span id="cb34-174"><a href="#cb34-174" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb34-175"><a href="#cb34-175" tabindex="-1"></a></span>
<span id="cb34-176"><a href="#cb34-176" tabindex="-1"></a><span class="co"># The default optimizer uses randomness, so we will set a seed to ensure the</span></span>
<span id="cb34-177"><a href="#cb34-177" tabindex="-1"></a><span class="co"># results from this fit are always identical</span></span>
<span id="cb34-178"><a href="#cb34-178" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb34-179"><a href="#cb34-179" tabindex="-1"></a></span>
<span id="cb34-180"><a href="#cb34-180" tabindex="-1"></a><span class="co"># Fit the C4 A-Ci curves with the mechanistic model, assuming light limitations</span></span>
<span id="cb34-181"><a href="#cb34-181" tabindex="-1"></a>c4_aci_results_light <span class="ot">&lt;-</span> <span class="fu">consolidate</span>(<span class="fu">by</span>(</span>
<span id="cb34-182"><a href="#cb34-182" tabindex="-1"></a>  licor_data,                       <span class="co"># The `exdf` object containing the curves</span></span>
<span id="cb34-183"><a href="#cb34-183" tabindex="-1"></a>  licor_data[, <span class="st">'curve_identifier'</span>], <span class="co"># A factor used to split `licor_data` into chunks</span></span>
<span id="cb34-184"><a href="#cb34-184" tabindex="-1"></a>  fit_c4_aci,                       <span class="co"># The function to apply to each chunk of `licor_data`</span></span>
<span id="cb34-185"><a href="#cb34-185" tabindex="-1"></a>  <span class="at">Ca_atmospheric =</span> <span class="dv">420</span>,             <span class="co"># Used to estimate the operating point</span></span>
<span id="cb34-186"><a href="#cb34-186" tabindex="-1"></a>  <span class="at">fit_options =</span> <span class="fu">list</span>(<span class="at">Vcmax_at_25 =</span> <span class="dv">1000</span>, <span class="at">Vpr =</span> <span class="dv">1000</span>, <span class="at">J_at_25 =</span> <span class="st">'fit'</span>)</span>
<span id="cb34-187"><a href="#cb34-187" tabindex="-1"></a>))</span>
<span id="cb34-188"><a href="#cb34-188" tabindex="-1"></a></span>
<span id="cb34-189"><a href="#cb34-189" tabindex="-1"></a><span class="co"># Plot the C4 A-Ci fits that were made assuming Rubisco limitations</span></span>
<span id="cb34-190"><a href="#cb34-190" tabindex="-1"></a><span class="fu">plot_c4_aci_fit</span>(</span>
<span id="cb34-191"><a href="#cb34-191" tabindex="-1"></a>  c4_aci_results_light,</span>
<span id="cb34-192"><a href="#cb34-192" tabindex="-1"></a>  <span class="st">'curve_identifier'</span>,</span>
<span id="cb34-193"><a href="#cb34-193" tabindex="-1"></a>  <span class="st">'Ci'</span>,</span>
<span id="cb34-194"><a href="#cb34-194" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">100</span>),</span>
<span id="cb34-195"><a href="#cb34-195" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">'Mechanistic fits assuming light limitations'</span></span>
<span id="cb34-196"><a href="#cb34-196" tabindex="-1"></a>)</span>
<span id="cb34-197"><a href="#cb34-197" tabindex="-1"></a></span>
<span id="cb34-198"><a href="#cb34-198" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb34-199"><a href="#cb34-199" tabindex="-1"></a><span class="do">## Semi-empirical fits</span></span>
<span id="cb34-200"><a href="#cb34-200" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb34-201"><a href="#cb34-201" tabindex="-1"></a></span>
<span id="cb34-202"><a href="#cb34-202" tabindex="-1"></a><span class="co"># The default optimizer uses randomness, so we will set a seed to ensure the</span></span>
<span id="cb34-203"><a href="#cb34-203" tabindex="-1"></a><span class="co"># results from this fit are always identical</span></span>
<span id="cb34-204"><a href="#cb34-204" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb34-205"><a href="#cb34-205" tabindex="-1"></a></span>
<span id="cb34-206"><a href="#cb34-206" tabindex="-1"></a><span class="co"># Fit the C4 A-Ci curves with the empirical model</span></span>
<span id="cb34-207"><a href="#cb34-207" tabindex="-1"></a>c4_aci_results_hyperbola <span class="ot">&lt;-</span> <span class="fu">consolidate</span>(<span class="fu">by</span>(</span>
<span id="cb34-208"><a href="#cb34-208" tabindex="-1"></a>  licor_data,                       <span class="co"># The `exdf` object containing the curves</span></span>
<span id="cb34-209"><a href="#cb34-209" tabindex="-1"></a>  licor_data[, <span class="st">'curve_identifier'</span>], <span class="co"># A factor used to split `licor_data` into chunks</span></span>
<span id="cb34-210"><a href="#cb34-210" tabindex="-1"></a>  fit_c4_aci_hyperbola              <span class="co"># The function to apply to each chunk of `licor_data`</span></span>
<span id="cb34-211"><a href="#cb34-211" tabindex="-1"></a>))</span>
<span id="cb34-212"><a href="#cb34-212" tabindex="-1"></a></span>
<span id="cb34-213"><a href="#cb34-213" tabindex="-1"></a><span class="co"># Plot the C4 A-Ci fits that were made using the empirical model</span></span>
<span id="cb34-214"><a href="#cb34-214" tabindex="-1"></a><span class="fu">plot_c4_aci_hyperbola_fit</span>(</span>
<span id="cb34-215"><a href="#cb34-215" tabindex="-1"></a>  c4_aci_results_hyperbola,</span>
<span id="cb34-216"><a href="#cb34-216" tabindex="-1"></a>  <span class="st">'curve_identifier'</span>,</span>
<span id="cb34-217"><a href="#cb34-217" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">100</span>),</span>
<span id="cb34-218"><a href="#cb34-218" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">'Empirical fits using a hyperbola'</span></span>
<span id="cb34-219"><a href="#cb34-219" tabindex="-1"></a>)</span>
<span id="cb34-220"><a href="#cb34-220" tabindex="-1"></a></span>
<span id="cb34-221"><a href="#cb34-221" tabindex="-1"></a><span class="co"># Get a subset of the data where Ci is below the threshold value</span></span>
<span id="cb34-222"><a href="#cb34-222" tabindex="-1"></a>licor_data_low_ci <span class="ot">&lt;-</span> licor_data[licor_data[, <span class="st">'Ci'</span>] <span class="sc">&lt;=</span> <span class="dv">60</span>, , <span class="cn">TRUE</span>]</span>
<span id="cb34-223"><a href="#cb34-223" tabindex="-1"></a></span>
<span id="cb34-224"><a href="#cb34-224" tabindex="-1"></a><span class="co"># The default optimizer uses randomness, so we will set a seed to ensure the</span></span>
<span id="cb34-225"><a href="#cb34-225" tabindex="-1"></a><span class="co"># results from this fit are always identical</span></span>
<span id="cb34-226"><a href="#cb34-226" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb34-227"><a href="#cb34-227" tabindex="-1"></a></span>
<span id="cb34-228"><a href="#cb34-228" tabindex="-1"></a><span class="co"># Fit the C4 A-Ci curves with the mechanistic Vpmax equation</span></span>
<span id="cb34-229"><a href="#cb34-229" tabindex="-1"></a>c4_aci_results_vpmax <span class="ot">&lt;-</span> <span class="fu">consolidate</span>(<span class="fu">by</span>(</span>
<span id="cb34-230"><a href="#cb34-230" tabindex="-1"></a>  licor_data_low_ci,                       <span class="co"># The `exdf` object containing the curves</span></span>
<span id="cb34-231"><a href="#cb34-231" tabindex="-1"></a>  licor_data_low_ci[, <span class="st">'curve_identifier'</span>], <span class="co"># A factor used to split `licor_data` into chunks</span></span>
<span id="cb34-232"><a href="#cb34-232" tabindex="-1"></a>  fit_c4_aci,                              <span class="co"># The function to apply to each chunk of `licor_data`</span></span>
<span id="cb34-233"><a href="#cb34-233" tabindex="-1"></a>  <span class="at">fit_options =</span> <span class="fu">list</span>(</span>
<span id="cb34-234"><a href="#cb34-234" tabindex="-1"></a>    <span class="at">Vcmax_at_25 =</span> <span class="dv">1000</span>,</span>
<span id="cb34-235"><a href="#cb34-235" tabindex="-1"></a>    <span class="at">Vpr =</span> <span class="dv">1000</span>,</span>
<span id="cb34-236"><a href="#cb34-236" tabindex="-1"></a>    <span class="at">J_at_25 =</span> <span class="dv">1000</span>,</span>
<span id="cb34-237"><a href="#cb34-237" tabindex="-1"></a>    <span class="at">alpha_psii =</span> <span class="dv">0</span>,</span>
<span id="cb34-238"><a href="#cb34-238" tabindex="-1"></a>    <span class="at">gbs =</span> <span class="dv">0</span>,</span>
<span id="cb34-239"><a href="#cb34-239" tabindex="-1"></a>    <span class="at">gmc_at_25 =</span> <span class="cn">Inf</span></span>
<span id="cb34-240"><a href="#cb34-240" tabindex="-1"></a>  )</span>
<span id="cb34-241"><a href="#cb34-241" tabindex="-1"></a>))</span>
<span id="cb34-242"><a href="#cb34-242" tabindex="-1"></a></span>
<span id="cb34-243"><a href="#cb34-243" tabindex="-1"></a><span class="co"># Plot the C4 A-Ci fits that were made to the low Ci part of the curves</span></span>
<span id="cb34-244"><a href="#cb34-244" tabindex="-1"></a><span class="fu">plot_c4_aci_fit</span>(</span>
<span id="cb34-245"><a href="#cb34-245" tabindex="-1"></a>  c4_aci_results_vpmax,</span>
<span id="cb34-246"><a href="#cb34-246" tabindex="-1"></a>  <span class="st">'curve_identifier'</span>,</span>
<span id="cb34-247"><a href="#cb34-247" tabindex="-1"></a>  <span class="st">'Ci'</span>,</span>
<span id="cb34-248"><a href="#cb34-248" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">60</span>),</span>
<span id="cb34-249"><a href="#cb34-249" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">'Mechanistic fits to the low Ci part of each curve'</span></span>
<span id="cb34-250"><a href="#cb34-250" tabindex="-1"></a>)</span>
<span id="cb34-251"><a href="#cb34-251" tabindex="-1"></a></span>
<span id="cb34-252"><a href="#cb34-252" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb34-253"><a href="#cb34-253" tabindex="-1"></a><span class="do">### SYNTHESIS:</span></span>
<span id="cb34-254"><a href="#cb34-254" tabindex="-1"></a><span class="do">### Using plots and statistics to help draw conclusions from the data</span></span>
<span id="cb34-255"><a href="#cb34-255" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb34-256"><a href="#cb34-256" tabindex="-1"></a></span>
<span id="cb34-257"><a href="#cb34-257" tabindex="-1"></a><span class="co"># Make a barchart showing average Vcmax values</span></span>
<span id="cb34-258"><a href="#cb34-258" tabindex="-1"></a><span class="fu">barchart_with_errorbars</span>(</span>
<span id="cb34-259"><a href="#cb34-259" tabindex="-1"></a>  c4_aci_results_rubisco<span class="sc">$</span>parameters[, <span class="st">'Vcmax_at_25'</span>],</span>
<span id="cb34-260"><a href="#cb34-260" tabindex="-1"></a>  c4_aci_results_rubisco<span class="sc">$</span>parameters[, <span class="st">'species'</span>],</span>
<span id="cb34-261"><a href="#cb34-261" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>),</span>
<span id="cb34-262"><a href="#cb34-262" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">'Species'</span>,</span>
<span id="cb34-263"><a href="#cb34-263" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="fu">paste0</span>(<span class="st">'Vcmax at 25 degrees C ('</span>, c4_aci_results_rubisco<span class="sc">$</span>parameters<span class="sc">$</span>units<span class="sc">$</span>Vcmax_at_25, <span class="st">')'</span>)</span>
<span id="cb34-264"><a href="#cb34-264" tabindex="-1"></a>)</span>
<span id="cb34-265"><a href="#cb34-265" tabindex="-1"></a></span>
<span id="cb34-266"><a href="#cb34-266" tabindex="-1"></a><span class="co"># Make a boxplot showing the distribution of Vcmax values</span></span>
<span id="cb34-267"><a href="#cb34-267" tabindex="-1"></a><span class="fu">bwplot</span>(</span>
<span id="cb34-268"><a href="#cb34-268" tabindex="-1"></a>  Vcmax_at_25 <span class="sc">~</span> species,</span>
<span id="cb34-269"><a href="#cb34-269" tabindex="-1"></a>  <span class="at">data =</span> c4_aci_results_rubisco<span class="sc">$</span>parameters<span class="sc">$</span>main_data,</span>
<span id="cb34-270"><a href="#cb34-270" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">50</span>),</span>
<span id="cb34-271"><a href="#cb34-271" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">'Species'</span>,</span>
<span id="cb34-272"><a href="#cb34-272" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="fu">paste0</span>(<span class="st">'Vcmax at 25 degrees C ('</span>, c4_aci_results_rubisco<span class="sc">$</span>parameters<span class="sc">$</span>units<span class="sc">$</span>Vcmax_at_25, <span class="st">')'</span>)</span>
<span id="cb34-273"><a href="#cb34-273" tabindex="-1"></a>)</span>
<span id="cb34-274"><a href="#cb34-274" tabindex="-1"></a></span>
<span id="cb34-275"><a href="#cb34-275" tabindex="-1"></a><span class="co"># Compute the average and standard error of each parameter for each species</span></span>
<span id="cb34-276"><a href="#cb34-276" tabindex="-1"></a><span class="co"># from one of the mechanistic fits</span></span>
<span id="cb34-277"><a href="#cb34-277" tabindex="-1"></a>c4_aci_averages_rubisco <span class="ot">&lt;-</span> <span class="fu">basic_stats</span>(c4_aci_results_rubisco<span class="sc">$</span>parameters, <span class="st">'species'</span>)</span>
<span id="cb34-278"><a href="#cb34-278" tabindex="-1"></a></span>
<span id="cb34-279"><a href="#cb34-279" tabindex="-1"></a><span class="co"># View the averages and errors</span></span>
<span id="cb34-280"><a href="#cb34-280" tabindex="-1"></a>columns_to_view <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb34-281"><a href="#cb34-281" tabindex="-1"></a>  <span class="st">'species'</span>,</span>
<span id="cb34-282"><a href="#cb34-282" tabindex="-1"></a>  <span class="st">'Vcmax_at_25_avg'</span>, <span class="st">'Vcmax_at_25_stderr'</span>,</span>
<span id="cb34-283"><a href="#cb34-283" tabindex="-1"></a>  <span class="st">'Vpmax_at_25_avg'</span>, <span class="st">'Vpmax_at_25_stderr'</span>,</span>
<span id="cb34-284"><a href="#cb34-284" tabindex="-1"></a>  <span class="st">'RL_at_25_avg'</span>, <span class="st">'RL_at_25_stderr'</span></span>
<span id="cb34-285"><a href="#cb34-285" tabindex="-1"></a>)</span>
<span id="cb34-286"><a href="#cb34-286" tabindex="-1"></a></span>
<span id="cb34-287"><a href="#cb34-287" tabindex="-1"></a>c4_aci_averages_rubisco[ , columns_to_view]</span></code></pre></div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-caemmerer_biochemical_2000" class="csl-entry">
Caemmerer, S. von. 2000. <em>Biochemical <span>Models</span> of
<span>Leaf</span> <span>Photosynthesis</span></em>. CSIRO Publishing. <a href="https://doi.org/10.1071/9780643103405" class="external-link">https://doi.org/10.1071/9780643103405</a>.
</div>
<div id="ref-von_caemmerer_updating_2021" class="csl-entry">
Caemmerer, Susanne von. 2021. <span>“Updating the Steady-State Model of
<span>C4</span> Photosynthesis.”</span> <em>Journal of Experimental
Botany</em> 72 (17): 6003–17. <a href="https://doi.org/10.1093/jxb/erab266" class="external-link">https://doi.org/10.1093/jxb/erab266</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward B. Lochocki.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
