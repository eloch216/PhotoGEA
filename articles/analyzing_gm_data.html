<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analyzing Mesophyll Conductance Data • PhotoGEA</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing Mesophyll Conductance Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    padding-top: 70px;

    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PhotoGEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/PhotoGEA.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/analyzing_ball_berry_data.html">Analyzing Ball-Berry Data</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_c3_aci_curves.html">Analyzing C3 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_c4_aci_curves.html">Analyzing C4 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_gm_data.html">Analyzing Mesophyll Conductance Data</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_tdl_data.html">Analyzing TDL Data</a></li>
    <li><a class="dropdown-item" href="../articles/combining_with_other_packages.html">Combining PhotoGEA With Other Packages</a></li>
    <li><a class="dropdown-item" href="../articles/creating_your_own_processing_tools.html">Creating Your Own Processing Tools</a></li>
    <li><a class="dropdown-item" href="../articles/developing_a_data_analysis_pipeline.html">Developing a Data Analysis Pipeline</a></li>
    <li><a class="dropdown-item" href="../articles/LI6800_user_constants.html">Guide to Licor LI-6800 User Constants</a></li>
    <li><a class="dropdown-item" href="../articles/working_with_extended_data_frames.html">Working With Extended Data Frames</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/eloch216/PhotoGEA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Analyzing Mesophyll Conductance Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/eloch216/PhotoGEA/blob/v1.2.0/vignettes/analyzing_gm_data.Rmd" class="external-link"><code>vignettes/analyzing_gm_data.Rmd</code></a></small>
      <div class="d-none name"><code>analyzing_gm_data.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>In this vignette, we will give an example showing how to use combined
gas exchange and isotope discrimination data to estimate values of
mesophyll conductance with the <code>PhotoGEA</code> package. The
commands in this vignette can be used to initialize your own script, as
described in <a href="#customizing-your-script">Customizing Your
Script</a>.</p>
</div>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>Because the process of photosynthesis tends to preferentially
assimilate <sup>12</sup>C more often than the rarer and heavier stable
isotope <sup>13</sup>C, carbon isotope discrimination measurements have
proven to be incredibly useful in the fields of plant biology and
climate science <span class="citation">(<a href="#ref-evans_temperature_2013">Evans and Caemmerer 2013</a>)</span>.
In the context of plant biology, a common approach is to hold a leaf or
plant under controlled environmental conditions and measure isotope
discrimination; models that predict discrimination can then be used to
estimate key parameter values such as the mesophyll conductance to
CO<sub>2</sub>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mrow><mi>m</mi><mi>c</mi></mrow></msub><annotation encoding="application/x-tex">g_{mc}</annotation></semantics></math>)
in C<sub>3</sub> plants or the bundle-sheath leakiness to CO<sub>2</sub>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>)
in C<sub>4</sub> plants.</p>
<p>In general, this technique requires simultaneous measurements of the
net CO<sub>2</sub> assimilation rate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>n</mi></msub><annotation encoding="application/x-tex">A_n</annotation></semantics></math>,
the intercellular CO<sub>2</sub> concentration
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>,
the <sup>12</sup>C and <sup>13</sup>C concentrations in air before and
after flowing over the leaf, and others. To make these measurements, a
gas exchange measurement system (such as a Licor Li-6800) is combined
with an isotope concentration measurement system, making this a
challenging experimental technique. Although several methods are
available for measuring the relative concentrations of <sup>12</sup>C
and <sup>13</sup>C gas mixtures, tunable diode laser (TDL) absorption
spectroscopy has emerged as one of the most popular due to its high
sensitivity and relatively short measurement times <span class="citation">(<a href="#ref-salesse-smith_modifying_2022">Salesse-Smith, Driever, and
Clarke 2022</a>)</span>.</p>
<div class="section level3">
<h3 id="isotope-discrimination-measurements">Isotope Discrimination Measurements<a class="anchor" aria-label="anchor" href="#isotope-discrimination-measurements"></a>
</h3>
<p>To understand isotope discrimination, it is helpful to first discuss
<em>fractionation</em>. Fractionation is a process where the relative
abundance of one isotope differs between the product and the reactant of
a chemical reaction. The term <em>fractionation</em> also refers to a
measurable quantity
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
defined by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mfrac><msub><mi>R</mi><mi>r</mi></msub><msub><mi>R</mi><mi>p</mi></msub></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">\alpha = \frac{R_r}{R_p},</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>r</mi></msub><annotation encoding="application/x-tex">R_r</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>p</mi></msub><annotation encoding="application/x-tex">R_p</annotation></semantics></math>
are the ratios of isotope concentrations in the reactant and product,
respectively. In the case of photosynthetic carbon isotope
discrimination,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>α</mi><mn>13</mn></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">\alpha^{13}C</annotation></semantics></math>
is the fractionation of <sup>13</sup>C relative to <sup>12</sup>C, air
is the reactant, plant carbon is the product, and the ratios are given
by <sup>13</sup>C / <sup>12</sup>C. Because photosynthesis assimilates
more <sup>12</sup>C than <sup>13</sup>C,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>p</mi></msub><annotation encoding="application/x-tex">R_p</annotation></semantics></math>
is always smaller than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>r</mi></msub><annotation encoding="application/x-tex">R_r</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>α</mi><mn>13</mn></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">\alpha^{13}C</annotation></semantics></math>
is always greater than 1.</p>
<p>The isotope discrimination
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>
is related to the isotope fractionation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
according to
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi><mo>=</mo><mi>α</mi><mo>−</mo><mn>1</mn><mo>=</mo><mfrac><mrow><msub><mi>R</mi><mi>r</mi></msub><mo>−</mo><msub><mi>R</mi><mi>p</mi></msub></mrow><msub><mi>R</mi><mi>p</mi></msub></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">\Delta = \alpha - 1 = \frac{R_r - R_p}{R_p}.</annotation></semantics></math>
So, in the case of photosynthetic carbon isotope discrimination,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Δ</mi><mn>13</mn></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">\Delta^{13}C</annotation></semantics></math>
is always positive (because
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
is always greater than 1). The discrimination can also be expressed in
terms of the isotopic composition
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>δ</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math>,
which is related to the isotope ratio
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>
by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mo>=</mo><mi>R</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\delta = R - 1</annotation></semantics></math>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Δ</mi><mn>13</mn></msup><mi>C</mi><mo>=</mo><mfrac><mrow><msup><mi>δ</mi><mn>13</mn></msup><msub><mi>C</mi><mi>r</mi></msub><mo>−</mo><msup><mi>δ</mi><mn>13</mn></msup><msub><mi>C</mi><mi>p</mi></msub></mrow><mrow><mn>1</mn><mo>+</mo><msup><mi>δ</mi><mn>13</mn></msup><msub><mi>C</mi><mi>p</mi></msub></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">\Delta^{13}C = \frac{\delta^{13}C_r - \delta^{13}C_p}{1 + \delta^{13}C_p}.</annotation></semantics></math>
The isotopic compositions can be expressed relative to an international
standard, making them the preferred way to express the relative
abundance of different isotopes.</p>
<p>During photosynthetic carbon isotope discrimination measurements, it
is not typically possible to actually measure
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>δ</mi><mn>13</mn></msup><msub><mi>C</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\delta^{13}C_p</annotation></semantics></math>
for a variety of reasons. Instead,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>δ</mi><mn>13</mn></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">\delta^{13}C</annotation></semantics></math>
can be measured in the outgoing air from the leaf. Then, it is possible
to relate the isotopic compositions of the incoming and outgoing air to
and from the leaf
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>δ</mi><mn>13</mn></msup><msub><mi>C</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\delta^{13}C_{in}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>δ</mi><mn>13</mn></msup><msub><mi>C</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\delta^{13}C_{out}</annotation></semantics></math>,
respectively) to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>δ</mi><mn>13</mn></msup><msub><mi>C</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\delta^{13}C_p</annotation></semantics></math>.
In this case, the full equation for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Δ</mi><mn>13</mn></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">\Delta^{13}C</annotation></semantics></math>
becomes
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Δ</mi><mn>13</mn></msup><mi>C</mi><mo>=</mo><mfrac><mrow><mi>ξ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>δ</mi><mn>13</mn></msup><msub><mi>C</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><mo>−</mo><msup><mi>δ</mi><mn>13</mn></msup><msub><mi>C</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>+</mo><msup><mi>δ</mi><mn>13</mn></msup><msub><mi>C</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><mo>−</mo><mi>ξ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>δ</mi><mn>13</mn></msup><msub><mi>C</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><mo>−</mo><msup><mi>δ</mi><mn>13</mn></msup><msub><mi>C</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">\Delta^{13}C =
\frac{\xi (\delta^{13}C_{out} - \delta^{13}C_{in})}
{1 + \delta^{13}C_{out} - \xi (\delta^{13}C_{out} - \delta^{13}C_{in})}.</annotation></semantics></math>
Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ξ</mi><annotation encoding="application/x-tex">\xi</annotation></semantics></math>
is defined by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ξ</mi><mo>=</mo><mfrac><msub><mi>C</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mrow><msub><mi>C</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><mo>−</mo><msub><mi>C</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">\xi = \frac{C_{in}}{C_{in} - C_{out}},</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><annotation encoding="application/x-tex">C_{in}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><annotation encoding="application/x-tex">C_{out}</annotation></semantics></math>
are the <sup>12</sup>C concentrations in the incoming and outgoing
air.</p>
<p>In summary, the photosynthetic carbon isotope discrimination
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Δ</mi><mn>13</mn></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">\Delta^{13}C</annotation></semantics></math>
is an experimentally accessible quantity that reflects the degree of
preference for <sup>12</sup>C during the process of photosynthesis. For
more information about this discrimination and its measurement via TDL,
see <span class="citation">Ubierna, Holloway-Phillips, and Farquhar (<a href="#ref-ubierna_using_2018">2018</a>)</span>.</p>
</div>
<div class="section level3">
<h3 id="isotope-discrimination-calculations">Isotope Discrimination Calculations<a class="anchor" aria-label="anchor" href="#isotope-discrimination-calculations"></a>
</h3>
<p>Values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Δ</mi><mn>13</mn></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">\Delta^{13}C</annotation></semantics></math>
can be predicted from knowledge of the photosynthetic chemical pathway,
as first done by <span class="citation">Farquhar, O’Leary, and Berry (<a href="#ref-farquhar_relationship_1982">1982</a>)</span>. This approach
breaks down photosynthetic carbon assimilation into several steps
including diffusion through air and liquid, and the binding of
CO<sub>2</sub> to RuBP as catalyzed by Rubisco. Each step along the
pathway has its own distinct fractionation. It is also necessary to
include the release of carbon by photorespiration and day respiration,
which also have their own associated fractionations. The entire equation
relating
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Δ</mi><mn>13</mn></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">\Delta^{13}C</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>A</mi><mi>n</mi></msub><annotation encoding="application/x-tex">A_n</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>,
and other variables is different for C<sub>3</sub> and C<sub>4</sub>
plants. These equations can also each be written in several different
ways depending on assumptions made while deriving them. Due to these
complexities, we do not reproduce the equations here. However, they can
be found in many places, such as Box A in <span class="citation">Ubierna, Holloway-Phillips, and Farquhar (<a href="#ref-ubierna_using_2018">2018</a>)</span>.</p>
<p>The most important aspect of these equations is that they can be
solved for key parameters such as the mesophyll conductance to
CO<sub>2</sub> (in C<sub>3</sub> plants) or the bundle-sheath leakiness
to CO<sub>2</sub> (in C<sub>4</sub> plants). Then,
experimentally-measured values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Δ</mi><mn>13</mn></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">\Delta^{13}C</annotation></semantics></math>
can be used to calculate values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>g</mi><mrow><mi>m</mi><mi>c</mi></mrow></msub><annotation encoding="application/x-tex">g_{mc}</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϕ</mi><annotation encoding="application/x-tex">\phi</annotation></semantics></math>.
There are many subtelties to these calculations, such as uncertainties
in the fractionation values due to photorespiration and day respiration.
We will not attempt to discuss them all here, but more information can
be found in <span class="citation">Busch et al. (<a href="#ref-busch_revisiting_2020">2020</a>)</span>.</p>
</div>
<div class="section level3">
<h3 id="a-note-about-this-example">A Note About This Example<a class="anchor" aria-label="anchor" href="#a-note-about-this-example"></a>
</h3>
<p>Estimating mesophyll conductance from combined gas exchange and TDL
measurements is a complicated process, making this example longer than
most of the other <code>PhotoGEA</code> vignettes. In general, the
analysis follows these steps:</p>
<ul>
<li>Separately load the gas exchange and TDL data.</li>
<li>Pair the data together, making sure that each log point in the gas
exchange data can be identified with carbon isotope concentrations in
the sample and reference lines as measured by the TDL.</li>
<li>Calculate photosynthetic carbon isotope discrimination and mesophyll
conductance.</li>
</ul>
<p>For brevity, we will not discuss the types of log files used in this
example, but more information can be found in the <a href="analyzing_tdl_data.html">Analyzing TDL Data</a> and <a href="analyzing_c3_aci_curves.html">Analyzing C3 A-Ci Curves</a>
vignettes.</p>
</div>
</div>
<div class="section level2">
<h2 id="loading-packages">Loading Packages<a class="anchor" aria-label="anchor" href="#loading-packages"></a>
</h2>
<p>As always, the first step is to load the packages we will be using.
In addition to <code>PhotoGEA</code>, we will also use the
<code>lattice</code> package for generating plots.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/eloch216/PhotoGEA" class="external-link">PhotoGEA</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lattice.r-forge.r-project.org/" class="external-link">lattice</a></span><span class="op">)</span></span></code></pre></div>
<p>If the <code>lattice</code> package is not installed on your R setup,
you can install it by typing
<code>install.packages('lattice')</code>.</p>
</div>
<div class="section level2">
<h2 id="loading-gas-exchange-data">Loading Gas Exchange Data<a class="anchor" aria-label="anchor" href="#loading-gas-exchange-data"></a>
</h2>
<p>The <code>PhotoGEA</code> package includes two files representing gas
exchange data that was measured along with the TDL data discussed in the
next section. The data was recorded by Licor Li-6800 instruments and is
stored in Microsoft Excel files. Each file includes two different
<code>CO2_r</code> setpoints (715 ppm and 450 ppm); six logs were
recorded at each setpoint. Although these two files are based on real
data, noise was added since they are unpublished, so these files should
only be used as examples.</p>
<p>The files will be stored on your computer somewhere in your R package
installation directory, and full paths to these files can be obtained
with <code>PhotoGEA_example_file_path</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define a vector of paths to the files we wish to load; in this case, we are</span></span>
<span><span class="co"># loading example files included with the PhotoGEA package</span></span>
<span><span class="va">licor_file_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/PhotoGEA_example_file_path.html">PhotoGEA_example_file_path</a></span><span class="op">(</span><span class="st">'licor_for_gm_site11.xlsx'</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/PhotoGEA_example_file_path.html">PhotoGEA_example_file_path</a></span><span class="op">(</span><span class="st">'licor_for_gm_site13.xlsx'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>(<strong>Note:</strong> When loading your own files for analysis, it
is not advisable to use <code>PhotoGEA_example_file_path</code> as we
have done here. Instead, file paths can be directly written, or files
can be chosen using an interactive window. See <a href="#input-files">Input Files</a> below for more information.)</p>
<p>To actually read the data in the files and store them in R objects,
we will use the <code>read_gasex_file</code> function from
<code>PhotoGEA</code>. Later, we will need to match the timestamps in
the gas exchange and isotope discrimination data; to make sure the
timestamps are interpreted correctly, we will also specify the time zone
where the measurements were made (<code>US/Central</code>). Since there
are multiple files to read, we will call this function once for each
file using <code>lapply</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load each Licor file, storing the result in a list</span></span>
<span><span class="va">licor_exdf_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">licor_file_paths</span>, <span class="kw">function</span><span class="op">(</span><span class="va">fpath</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/read_gasex_file.html">read_gasex_file</a></span><span class="op">(</span><span class="va">fpath</span>, <span class="st">'time'</span>, posix_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>tz <span class="op">=</span> <span class="st">'US/Central'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>The result from this command is an R list of “extended data frames”
(abbreviated as <code>exdf</code> objects). The <code>exdf</code> class
is a special data structure defined by the <code>PhotoGEA</code>
package. In many ways, an <code>exdf</code> object is equivalent to a
data frame, with the major difference being that an <code>exdf</code>
object includes the units of each column. For more information, type
<code><a href="../reference/exdf.html">?exdf</a></code> in the R terminal to access the built-in help menu
entry, or check out the <a href="working_with_extended_data_frames.html">Working With Extended Data
Frames</a> vignette.</p>
<p>Later, it will also be necessary to know the “site number” for each
gas exchange system. This refers to the TDL valve numbers corresponding
to the sample and reference lines of each gas exchange instrument. At
UIUC, there is a convention where the sample line valve number is stored
in the Licor log file name. It can be extracted using the
<code>get_sample_valve_from_filename</code> function from the
<code>PhotoGEA</code> package, which also provides a method for
specifying the reference line valve number.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get TDL sample and reference valve numbers from the Licor filenames</span></span>
<span><span class="va">licor_exdf_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">licor_exdf_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">exdf_obj</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/get_sample_valve_from_filename.html">get_sample_valve_from_filename</a></span><span class="op">(</span><span class="va">exdf_obj</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">'13'</span> <span class="op">=</span> <span class="fl">12</span>, <span class="co"># The reference valve is 12 when the sample valve is 13</span></span>
<span>    <span class="st">'11'</span> <span class="op">=</span> <span class="fl">10</span>  <span class="co"># The reference valve is 10 when the sample valve is 11</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Generally, it is more convenient to work with a single
<code>exdf</code> object rather than a list of them, so our next step
will be to combine the objects in the list. This action can be
accomplished using the <code>rbind</code> function, which combines
table-like objects by their rows; in other words, it stacks two or more
tables vertically. This action only makes sense if the tables have the
same columns, so before we combine the <code>exdf</code> objects, we
should make sure this is the case.</p>
<p>The <code>PhotoGEA</code> package includes a function called
<code>identify_common_columns</code> that can be used to get the names
of all columns that are present in all of the Licor files. Then, we can
extract just those columns, and then combine the <code>exdf</code>
objects into a single one.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the names of all columns that are present in all of the Licor files</span></span>
<span><span class="va">licor_columns_to_keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">identify_common_columns</span>, <span class="va">licor_exdf_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract just these columns</span></span>
<span><span class="va">licor_exdf_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">licor_exdf_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span> , <span class="va">licor_columns_to_keep</span>, <span class="cn">TRUE</span><span class="op">]</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use `rbind` to combine all the data</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">licor_exdf_list</span><span class="op">)</span></span></code></pre></div>
<p>Now we have a single R object called <code>licor_data</code> that
includes all the data from several Licor Excel files. For more
information about consolidating information from multiple files, see the
<em>Common Patterns</em> section of the <a href="working_with_extended_data_frames.html#combining-data-from-several-files">Working
With Extended Data Frames</a> vignette.</p>
</div>
<div class="section level2">
<h2 id="loading-tunable-diode-laser-data">Loading Tunable Diode Laser Data<a class="anchor" aria-label="anchor" href="#loading-tunable-diode-laser-data"></a>
</h2>
<p>The <code>PhotoGEA</code> package includes one file representing TDL
data that was recorded with a Campbell Scientific CR3000 data logger
simultaneously with the gas exchange data discussed in the previous
section. Although this two file is based on real data, noise was added
to it since it is unpublished, so it should only be used as an
example.</p>
<p>The file will be stored on your computer somewhere in your R package
installation directory, and a full path to the file can be obtained with
<code>PhotoGEA_example_file_path</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define a vector of paths to the files we wish to load; in this case, we are</span></span>
<span><span class="co"># loading example files included with the PhotoGEA package</span></span>
<span><span class="va">tdl_file_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/PhotoGEA_example_file_path.html">PhotoGEA_example_file_path</a></span><span class="op">(</span><span class="st">'tdl_for_gm.dat'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>(<strong>Note:</strong> When loading your own files for analysis, it
is not advisable to use <code>PhotoGEA_example_file_path</code> as we
have done here. Instead, file paths can be directly written, or files
can be chosen using an interactive window. See <a href="#input-files">Input Files</a> below for more information.)</p>
<p>To actually read the data in the files and store them in R objects,
we will use the <code>read_gasex_file</code> function from
<code>PhotoGEA</code>. Later, we will need to match the timestamps in
the gas exchange and isotope discrimination data; to make sure the
timestamps are interpreted correctly, we will also specify the time zone
where the measurements were made (<code>US/Central</code>). Since there
are (potentially) multiple files to read, we will call this function
once for each file using <code>lapply</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load each TDL file, storing the result in a list</span></span>
<span><span class="va">tdl_exdf_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tdl_file_paths</span>, <span class="kw">function</span><span class="op">(</span><span class="va">fpath</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/read_gasex_file.html">read_gasex_file</a></span><span class="op">(</span><span class="va">fpath</span>, <span class="st">'TIMESTAMP'</span>, posix_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>tz <span class="op">=</span> <span class="st">'US/Central'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>As before, the result from this command is a list of
<code>exdf</code> objects. (In this case, it is a list with one element.
However, we have written this example in a general way so it will be
able to accomodate multple TDL log files if it is necessary to use more
than one.) Generally, it is more convenient to work with a single
<code>exdf</code> object rather than a list of them, so our next step
will be to combine the objects in the list. This process is the same as
was used in the previous section for the Licor log files.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get the names of all columns that are present in all of the TDL files</span></span>
<span><span class="va">tdl_columns_to_keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">identify_common_columns</span>, <span class="va">tdl_exdf_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract just these columns</span></span>
<span><span class="va">tdl_exdf_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tdl_exdf_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span> , <span class="va">tdl_columns_to_keep</span>, <span class="cn">TRUE</span><span class="op">]</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use `rbind` to combine all the data</span></span>
<span><span class="va">tdl_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">tdl_exdf_list</span><span class="op">)</span></span></code></pre></div>
<p>Now we have a single R object called <code>tdl_data</code> that
includes all the data from several TDL data files. For more information
about consolidating information from multiple files, see the <em>Common
Patterns</em> section of the <a href="working_with_extended_data_frames.html#combining-data-from-several-files">Working
With Extended Data Frames</a> vignette.</p>
</div>
<div class="section level2">
<h2 id="basic-checks-of-the-gas-exchange-data">Basic Checks of the Gas Exchange Data<a class="anchor" aria-label="anchor" href="#basic-checks-of-the-gas-exchange-data"></a>
</h2>
<p>Next, we should make sure there is a column in the data whose value
uniquely identifies each related set of measurements. In this particular
data set, several “user constants” were defined while making the
measurements that help to identify each set: <code>machine</code> and
<code>replicate</code>. However, neither of these columns alone are
sufficient to uniquely identify each set. We can solve this issue by
creating a new column that combines the values from each of these:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a new identifier column formatted like `machine - replicate`</span></span>
<span><span class="va">licor_data</span><span class="op">[</span> , <span class="st">'curve_identifier'</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">licor_data</span><span class="op">[</span> , <span class="st">'machine'</span><span class="op">]</span>, <span class="va">licor_data</span><span class="op">[</span> , <span class="st">'replicate'</span><span class="op">]</span>, sep <span class="op">=</span> <span class="st">' - '</span><span class="op">)</span></span></code></pre></div>
<p>When measuring response curves (or any other type of gas exchange
data), it is strongly recommended to record key pieces of metadata in
the log files using “user constants,” as was done in this example. For
more information, please see the <a href="LI6800_user_constants.html">Guide to Licor LI-6800 User
Constants</a>, which also includes advice for dealing with data sets
that do not contain such metadata.</p>
<p>The next step is to make sure that this column correctly identifies
each response curve. To do this, we can use the
<code>check_response_curve_data</code> function from
<code>PhotoGEA</code>. Here we will supply the name of a column that
should uniquely identify each response curve
(<code>curve_identifier</code>), the expected number of points in each
curve (<code>12</code>), the name of a “driving” column that should
follow the same sequence in each curve (<code>CO2_r_sp</code>). If the
data passes the checks, this function will have no output and will not
produce any messages. (For more information, see the built-in help menu
entry by typing <code><a href="../reference/check_response_curve_data.html">?check_response_curve_data</a></code>.)</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Make sure the data meets basic requirements</span></span>
<span><span class="fu"><a href="../reference/check_response_curve_data.html">check_response_curve_data</a></span><span class="op">(</span><span class="va">licor_data</span>, <span class="st">'curve_identifier'</span>, <span class="fl">12</span>, <span class="st">'CO2_r_sp'</span><span class="op">)</span></span></code></pre></div>
<p>However, if <code>check_response_curve_data</code> detects an issue,
it will print a helpful message to the R terminal. For example, if we
had specified the wrong number of points or the wrong identifier column,
we would get error messages:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/check_response_curve_data.html">check_response_curve_data</a></span><span class="op">(</span><span class="va">licor_data</span>, <span class="st">'curve_identifier'</span>, <span class="fl">13</span><span class="op">)</span></span>
<span><span class="co">#&gt;   curve_identifier npts</span></span>
<span><span class="co">#&gt; 1       mickey - 1   12</span></span>
<span><span class="co">#&gt; 2        pluto - 1   12</span></span>
<span><span class="co">#&gt; Error in check_response_curve_data(licor_data, "curve_identifier", 13): One or more curves does not have the expected number of points.</span></span>
<span></span>
<span><span class="fu"><a href="../reference/check_response_curve_data.html">check_response_curve_data</a></span><span class="op">(</span><span class="va">licor_data</span>, <span class="st">'replicate'</span>, <span class="fl">12</span><span class="op">)</span></span>
<span><span class="co">#&gt;   replicate npts</span></span>
<span><span class="co">#&gt; 1         1   24</span></span>
<span><span class="co">#&gt; Error in check_response_curve_data(licor_data, "replicate", 12): One or more curves does not have the expected number of points.</span></span></code></pre></div>
<p>Now that we have confirmed that our curve identifier properly
identifies sets of data, we can also perform additional organization
using the <code>organize_response_curve_data</code> function from
<code>PhotoGEA</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Order by `Ci`.</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/organize_response_curve_data.html">organize_response_curve_data</a></span><span class="op">(</span></span>
<span>  <span class="va">licor_data</span>,</span>
<span>  <span class="st">'curve_identifier'</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>, <span class="co"># keep all the measured points</span></span>
<span>  <span class="st">'Ci'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now there is a new column called <code>seq_num</code>, where each
point in each set is given a number 1-12 corresponding to the
measurement order. The points have also been re-ordered according to
<code>Ci</code>.</p>
</div>
<div class="section level2">
<h2 id="combining-the-gas-exchange-and-isotope-discrimination-data">Combining the Gas Exchange and Isotope Discrimination Data<a class="anchor" aria-label="anchor" href="#combining-the-gas-exchange-and-isotope-discrimination-data"></a>
</h2>
<div class="section level3">
<h3 id="identifying-tdl-cycles">Identifying TDL Cycles<a class="anchor" aria-label="anchor" href="#identifying-tdl-cycles"></a>
</h3>
<p>Typically a TDL system periodically cycles between multiple gas lines
during measurements. Some of the gas lines represent gas mixtures with
known composition that can be used for calibration, while others are the
“unknown” mixtures whose composition is being measured. A collection of
valves are used to control which gas line is being measured at any given
time, and the “active” valve for each recorded data point is included in
a measurement file.</p>
<p>The first step towards applying calibrations and combining the data
with the associated gas exchange measurements is to identify complete
measurement cycles within the data set. This can be accomplished using
the <code>identify_tdl_cycles</code> function from the
<code>PhotoGEA</code> package. To use this function, we need to know the
following information:</p>
<ul>
<li>The name of the column in the TDL data that indicates which valve is
being measured.</li>
<li>The valve number that marks the beginning of a new cycle.</li>
<li>How many valves are measured in each cycle.</li>
<li>The name of the column in the TDL data that indicates the time at
which each measurement was made.</li>
<li>The amount of time it should take to cycle through the valves.</li>
</ul>
<p>This information is usually known beforehand from the settings that
were specified when operating the TDL; alternatively, if it isn’t known
already, it can often be determined by taking a look at the data via
<code>View(tdl_files)</code>. Once this information is obtained,
<code>identify_tdl_cycles</code> can be used to automatically assign a
number to each measurement cycle:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assign numbers to all full cycles in the TDL data set</span></span>
<span><span class="va">tdl_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/identify_tdl_cycles.html">identify_tdl_cycles</a></span><span class="op">(</span></span>
<span>  <span class="va">tdl_data</span>,</span>
<span>  valve_column_name <span class="op">=</span> <span class="st">'valve_number'</span>,</span>
<span>  cycle_start_valve <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  expected_cycle_length_minutes <span class="op">=</span> <span class="fl">2.7</span>,</span>
<span>  expected_cycle_num_valves <span class="op">=</span> <span class="fl">9</span>,</span>
<span>  timestamp_colname <span class="op">=</span> <span class="st">'TIMESTAMP'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now the <code>tdl_data</code> object has two new columns: one is
called <code>cycle_num</code> and specifies each TDL cycle, and the
other is called <code>elapsed_time</code> and indicates the elapsed time
of each TDL log relative to the first one.</p>
</div>
<div class="section level3">
<h3 id="calibrating-tdl-cycles">Calibrating TDL Cycles<a class="anchor" aria-label="anchor" href="#calibrating-tdl-cycles"></a>
</h3>
<p>Now that the individual cycles have been identified, the next step is
to use the reference valves to calibrate the TDL readings. In general,
this procedure will depend strongly on the individual TDL system, since
each one may have different types of reference tanks. The data used in
this vignette was measured using the TDL in Carl Bernacchi’s lab in the
Edward R. Madigan Laboratory at the University of Illinois,
Urbana-Champaign. It includes five reference tanks that can be broken
into three types:</p>
<ul>
<li>One is a certified tank whose total CO<sub>2</sub> concentration and
carbon isotope ratio are supplied from NOAA.</li>
<li>One is a nitrogen tank that should have no carbon in it.</li>
<li>The final type of reference is another CO<sub>2</sub> tank whose
isotype ratio was measured at UIUC using a different method; this tank
is mixed with nitrogen in three different ratios to provide a range of
carbon concentrations.</li>
</ul>
<p>The full procedure for using these references to calibrate the TDL
signal is somewhat complicated. Fortunately, it is easy to determine and
apply the calibrations for a single TDL cycle using the
<code>process_tdl_cycle_erml</code> function from <code>PhotoGEA</code>.
To apply this function to each TDL cycle in a larger data set and then
consolidate the results, we can use it in conjunction with
<code>by</code> and <code>consolidate</code>, which are also part of
<code>PhotoGEA</code>. (For more information about these functions, see
the built-in help menu entries by typing
<code><a href="../reference/process_tdl_cycle_erml.html">?process_tdl_cycle_erml</a></code>, <code><a href="../reference/by.exdf.html">?by.exdf</a></code>, or
<code><a href="../reference/consolidate.html">?consolidate</a></code>, or check out the <em>Common Patterns</em>
section of the <a href="working_with_extended_data_frames.html#processing-multiple-pieces-of-an-extended-data-frame">Working
With Extended Data Frames</a> vignette.) As with the previous function,
many of the inputs here (such as
<code>noaa_cylinder_isotope_ratio</code>) must be obtained from whoever
is managing the TDL system being used:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use the data from the calibration valves to determine calibrated carbon</span></span>
<span><span class="co"># concentrations from all valves in each TDL cycle</span></span>
<span><span class="va">processed_tdl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/consolidate.html">consolidate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span><span class="op">(</span></span>
<span>  <span class="va">tdl_data</span>,</span>
<span>  <span class="va">tdl_data</span><span class="op">[</span>, <span class="st">'cycle_num'</span><span class="op">]</span>,</span>
<span>  <span class="va">process_tdl_cycle_erml</span>,</span>
<span>  valve_column_name <span class="op">=</span> <span class="st">'valve_number'</span>,</span>
<span>  noaa_valve <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  calibration_0_valve <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  calibration_1_valve <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  calibration_2_valve <span class="op">=</span> <span class="fl">23</span>,</span>
<span>  calibration_3_valve <span class="op">=</span> <span class="fl">26</span>,</span>
<span>  raw_12c_colname <span class="op">=</span> <span class="st">'Conc12C_Avg'</span>,</span>
<span>  raw_13c_colname <span class="op">=</span> <span class="st">'Conc13C_Avg'</span>,</span>
<span>  noaa_cylinder_co2_concentration <span class="op">=</span> <span class="fl">294.996</span>,</span>
<span>  noaa_cylinder_isotope_ratio <span class="op">=</span> <span class="op">-</span><span class="fl">8.40</span>,</span>
<span>  calibration_isotope_ratio <span class="op">=</span> <span class="op">-</span><span class="fl">11.505</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The output from this function – <code>processed_tdl</code> – is a
list of several <code>exdf</code> objects that include calibrated TDL
readings from each valve and information about the calibration
parameters that were determined while processing the data.</p>
</div>
<div class="section level3">
<h3 id="pairing-gas-exchange-and-tdl-data">Pairing Gas Exchange and TDL Data<a class="anchor" aria-label="anchor" href="#pairing-gas-exchange-and-tdl-data"></a>
</h3>
<p>When analyzing combined gas exchange and isotope discrimination data,
a key step is to combine TDL and gas exchange data that were measured at
the same times. The function performs this operation by locating the TDL
cycle whose timestamp is closest to each Licor file entry. Then, the
<sup>12</sup>C, <sup>13</sup>C, total CO<sub>2</sub>, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>δ</mi><mn>13</mn></msup><annotation encoding="application/x-tex">\delta^{13}</annotation></semantics></math>C
values measured by the TDL from the Licor’s sample and reference lines
during that cycle are added to the gas exchange data as new columns.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pair the Licor and TDL data by locating the TDL cycle corresponding to each</span></span>
<span><span class="co"># Licor measurement</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pair_gasex_and_tdl.html">pair_gasex_and_tdl</a></span><span class="op">(</span><span class="va">licor_data</span>, <span class="va">processed_tdl</span><span class="op">$</span><span class="va">tdl_data</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="qualitative-validation">Qualitative Validation<a class="anchor" aria-label="anchor" href="#qualitative-validation"></a>
</h2>
<p>The data has now undergone several basic validation checks. Now we
can make qualitative validation checks by plotting various quantities
and looking for any outliers or otherwise strange measurement points. In
this section, we will just look at a few of the many possible variables
that could be plotted. Other possibilities can be found in some of the
other PhotoGEA vignettes, such as <a href="analyzing_tdl_data.html#checking-the-calibrated-data">Analyzing
TDL Data</a> and <a href="analyzing_c3_aci_curves.html#additional-plots-for-qualitative-validation">Analyzing
C3 A-Ci Curves</a>.</p>
<div class="section level3">
<h3 id="environment-control">Environment Control<a class="anchor" aria-label="anchor" href="#environment-control"></a>
</h3>
<p>One type of validation is to make sure that the leaf environment was
properly controlled. This could include temperature, humidity, and/or
CO<sub>2</sub> concentration. As an example, we will first look at the
temperature. For these measurements, the leaf temperature was set to 28
degrees C, so it is a good idea to confirm that the leaf temperature was
constant during the measurements.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the leaf temperature, grouped by CO2_r setpoint</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">TleafCnd</span> <span class="op">~</span> <span class="va">seq_num</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  group <span class="op">=</span> <span class="va">CO2_r_sp</span>,</span>
<span>  data <span class="op">=</span> <span class="va">licor_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'p'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  auto.key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>space <span class="op">=</span> <span class="st">'right'</span><span class="op">)</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">26</span>, <span class="fl">30</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">'Measurement number'</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Leaf temperature'</span>, <span class="st">'['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">TleafCnd</span>, <span class="st">']'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_gm_data_files/figure-html/plot_temperature-1.png" width="720" style="display: block; margin: auto;"></p>
<p>The temperature control is not perfect for the last point in each
curve, but only deviates from the setpoint by 0.5 degrees C. This is an
acceptable amount of variation and is not a reason for concern.</p>
<p>We can also look at <code>CO2_r</code>, which should be 715 ppm for
the first six points and 450 ppm for the following points.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot CO2_r, grouped by CO2_r setpoint</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">CO2_r</span> <span class="op">~</span> <span class="va">seq_num</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  group <span class="op">=</span> <span class="va">CO2_r_sp</span>,</span>
<span>  data <span class="op">=</span> <span class="va">licor_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'p'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  auto.key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>space <span class="op">=</span> <span class="st">'right'</span><span class="op">)</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">400</span>, <span class="fl">800</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">'Measurement number'</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'CO2 concentration'</span>, <span class="st">'['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">CO2_r</span>, <span class="st">']'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_gm_data_files/figure-html/plot_co2_r-1.png" width="720" style="display: block; margin: auto;"></p>
<p>Here we can see that the CO<sub>2</sub> control was good for all the
measurement points.</p>
</div>
<div class="section level3">
<h3 id="tdl-readings">TDL Readings<a class="anchor" aria-label="anchor" href="#tdl-readings"></a>
</h3>
<p>A key requisite for reliable mesophyll conductance values is that the
TDL readings should be stable with time at each CO<sub>2</sub> setpoint.
We can check this by looking at the calibrated TDL readings.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">Conc13C_Avg</span> <span class="op">~</span> <span class="va">elapsed_time</span>,</span>
<span>  group <span class="op">=</span> <span class="va">valve_number</span>,</span>
<span>  data <span class="op">=</span> <span class="va">processed_tdl</span><span class="op">$</span><span class="va">tdl_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  auto.key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>space<span class="op">=</span><span class="st">'right'</span><span class="op">)</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'b'</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Elapsed time ('</span>, <span class="va">processed_tdl</span><span class="op">$</span><span class="va">tdl_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">elapsed_time</span>, <span class="st">')'</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>    <span class="st">'Calibrated TDL 13C concentration ('</span>,</span>
<span>    <span class="va">processed_tdl</span><span class="op">$</span><span class="va">tdl_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Conc13C_Avg</span>, <span class="st">')'</span></span>
<span>  <span class="op">)</span>,</span>
<span>  par.settings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    superpose.line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="../reference/multi_curve_colors.html">multi_curve_colors</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    superpose.symbol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="../reference/multi_curve_colors.html">multi_curve_colors</a></span><span class="op">(</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_gm_data_files/figure-html/plot_tdl-1.png" width="720" style="display: block; margin: auto;"></p>
<p>Here we can see that some of the valves are variable at the start of
the TDL log file (such as valves 26 and 23). However, they are quite
stable by the time the gas exchange logs begin (at around 25 minutes of
elapsed time).</p>
</div>
<div class="section level3">
<h3 id="cleaning-the-data">Cleaning the Data<a class="anchor" aria-label="anchor" href="#cleaning-the-data"></a>
</h3>
<p>At this point, if any issues had been identified, we could clean the
data by removing any problematic points. In this example, this procedure
is not required. For examples of how to clean a data set by removing
points, please see the <a href="analyzing_c3_aci_curves.html#cleaning-the-licor-data">Analyzing C3
A-Ci Curves</a> vignette, or one of the other vignettes.</p>
</div>
</div>
<div class="section level2">
<h2 id="calculating-isotope-discrimination">Calculating Isotope Discrimination<a class="anchor" aria-label="anchor" href="#calculating-isotope-discrimination"></a>
</h2>
<p>Now, the <code>licor_data</code> <code>exdf</code> object includes
the TDL measurements from the Licor sample and reference gas lines that
correspond to each log point. This information can now be used to
calculate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Δ</mi><mn>13</mn></msup><mi>C</mi></mrow><annotation encoding="application/x-tex">\Delta^{13}C</annotation></semantics></math>,
the photosynthetic isotope discrimination:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate isotope discrimination</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_isotope_discrimination.html">calculate_isotope_discrimination</a></span><span class="op">(</span><span class="va">licor_data</span><span class="op">)</span></span></code></pre></div>
<p>We can also make a quick validity check here. Photosynthetic carbon
isotope discrimination should be not vary too much at each
CO<sub>2</sub> setpoint. We can check this with a plot.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the photosynthetic isotope discrimination, grouped by CO2_r setpoint</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">Delta_obs_tdl</span> <span class="op">~</span> <span class="va">seq_num</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  group <span class="op">=</span> <span class="va">CO2_r_sp</span>,</span>
<span>  data <span class="op">=</span> <span class="va">licor_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'p'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  auto.key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>space <span class="op">=</span> <span class="st">'right'</span><span class="op">)</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">22</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">'Measurement number'</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Photosynthetic isotope discrimination'</span>, <span class="st">'['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Delta_obs_tdl</span>, <span class="st">']'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_gm_data_files/figure-html/plot_isotope_discrimination-1.png" width="720" style="display: block; margin: auto;"></p>
<p>Here there is a large amount of noise, but this is to be expected for
these measurements.</p>
</div>
<div class="section level2">
<h2 id="calculating-mesophyll-conductance">Calculating Mesophyll Conductance<a class="anchor" aria-label="anchor" href="#calculating-mesophyll-conductance"></a>
</h2>
<p>Now we have loaded the raw data, combined the two main data sources
(gas exchange and TDL measurements), performed some validity checks, and
calculated the isotope discrimination values. There are just a few more
steps required to calculate mesophyll conductance values. In particular,
the mesophyll conductance equations require the following inputs:</p>
<ul>
<li>The rate of day respiration
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>d</mi></msub><annotation encoding="application/x-tex">R_d</annotation></semantics></math>).</li>
<li>The CO<sub>2</sub> compensation point in the absence of day
respiration
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Γ</mi><mo>*</mo></msup><annotation encoding="application/x-tex">\Gamma^*</annotation></semantics></math>).</li>
<li>The ternary correction factor
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>).</li>
<li>The observed photosynthetic carbon isotope discrimination under
growth conditions
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Δ</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi></mrow><mrow><mi>g</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>t</mi><mi>h</mi></mrow></msubsup><annotation encoding="application/x-tex">\Delta_{obs}^{growth}</annotation></semantics></math>).</li>
</ul>
<p>The value of day respiration
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>d</mi></msub><annotation encoding="application/x-tex">R_d</annotation></semantics></math>
must be known from other measurements; typically it is determined by
placing a leaf into a gas exchange measurement chamber with the light
off, and measuring the steady-state net assimilation rate. Here we will
use 1.2
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>mol
m<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mrow><mo>−</mo><mn>2</mn></mrow></msup><annotation encoding="application/x-tex">^{-2}</annotation></semantics></math>
s<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><annotation encoding="application/x-tex">^{-1}</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set day respiration rate</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_variable.html">set_variable</a></span><span class="op">(</span></span>
<span>  <span class="va">licor_data</span>,</span>
<span>  <span class="st">'RL'</span>,</span>
<span>  <span class="st">'micromol m^(-2) s^(-1)'</span>,</span>
<span>  value <span class="op">=</span> <span class="fl">1.2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>There are several possible approaches to choosing a value for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Γ</mi><mo>*</mo></msup><annotation encoding="application/x-tex">\Gamma^*</annotation></semantics></math>.
Here we will calculate its value from the leaf temperature and the
Rubisco specificity using the <code>calculate_gamma_star</code> function
from <code>PhotoGEA</code>, using 92 M
M<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi></mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><annotation encoding="application/x-tex">^{-1}</annotation></semantics></math>
for the specificity.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set Rubisco specificity</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_variable.html">set_variable</a></span><span class="op">(</span></span>
<span>    <span class="va">licor_data</span>,</span>
<span>    <span class="st">'specificity_at_tleaf'</span>,</span>
<span>    <span class="st">'M / M'</span>,</span>
<span>    value <span class="op">=</span> <span class="fl">92</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate Gamma_star</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_gamma_star.html">calculate_gamma_star</a></span><span class="op">(</span><span class="va">licor_data</span><span class="op">)</span></span></code></pre></div>
<p>The ternary correction factor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
can be calculated using the <code>calculate_ternary_correction</code>
function from <code>PhotoGEA</code>. This function has a few of its own
requirements, which can be met by first calling
<code>calculate_total_pressure</code> and
<code>calculate_gas_properties</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate total pressure</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_total_pressure.html">calculate_total_pressure</a></span><span class="op">(</span><span class="va">licor_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate gbc, gsc, Csurface</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_gas_properties.html">calculate_gas_properties</a></span><span class="op">(</span><span class="va">licor_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate t</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_ternary_correction.html">calculate_ternary_correction</a></span><span class="op">(</span><span class="va">licor_data</span><span class="op">)</span></span></code></pre></div>
<p>Like
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mi>d</mi></msub><annotation encoding="application/x-tex">R_d</annotation></semantics></math>,
the observed photosynthetic isotope discrimination under growth
conditions
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Δ</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi></mrow><mrow><mi>g</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>t</mi><mi>h</mi></mrow></msubsup><annotation encoding="application/x-tex">\Delta_{obs}^{growth}</annotation></semantics></math>)
must be measured from each leaf or plant species. Ideally, this would be
determined by setting the ambient CO<sub>2</sub> concentration around
the leaf to the ambient value and using the TDL to measure the
photosynthetic isotope discrimination
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Δ</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">\Delta_{obs}</annotation></semantics></math>.
In this data set, the first six points in each file have
<code>CO2_r</code> set to 715 ppm, which produces a value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>a</mi></msub><annotation encoding="application/x-tex">C_a</annotation></semantics></math>
close to 420 ppm (the global atmospheric value at the time these
measurements were made). Thus, we can use the average value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Δ</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi></mrow></msub><annotation encoding="application/x-tex">\Delta_{obs}</annotation></semantics></math>
across the first six points as the value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Δ</mi><mrow><mi>o</mi><mi>b</mi><mi>s</mi></mrow><mrow><mi>g</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>t</mi><mi>h</mi></mrow></msubsup><annotation encoding="application/x-tex">\Delta_{obs}^{growth}</annotation></semantics></math>
for each replicate.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set Delta_obs_growth</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_variable.html">set_variable</a></span><span class="op">(</span></span>
<span>  <span class="va">licor_data</span>,</span>
<span>  <span class="st">'Delta_obs_growth'</span>,</span>
<span>  <span class="st">'ppt'</span>,</span>
<span>  id_column <span class="op">=</span> <span class="st">'curve_identifier'</span>,</span>
<span>  value_table <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span></span>
<span>    <span class="va">licor_data</span><span class="op">[</span><span class="va">licor_data</span><span class="op">[</span>, <span class="st">'CO2_r_sp'</span><span class="op">]</span> <span class="op">==</span> <span class="fl">715</span>, <span class="st">'Delta_obs_tdl'</span><span class="op">]</span>,</span>
<span>    <span class="va">licor_data</span><span class="op">[</span><span class="va">licor_data</span><span class="op">[</span>, <span class="st">'CO2_r_sp'</span><span class="op">]</span> <span class="op">==</span> <span class="fl">715</span>, <span class="st">'curve_identifier'</span><span class="op">]</span>,</span>
<span>    <span class="va">mean</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now we are finally able to calculate values of mesophyll
conductance!</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate mesophyll conductance</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_gm_busch.html">calculate_gm_busch</a></span><span class="op">(</span><span class="va">licor_data</span>, f <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p>In this example, we have found that the mesophyll conductance values
are more reasonable with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math>
(the assumed fractionation due to day respiration) set to 0. In general,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math>
is typically not zero, and can be varied during analysis.</p>
</div>
<div class="section level2">
<h2 id="examining-the-results">Examining the Results<a class="anchor" aria-label="anchor" href="#examining-the-results"></a>
</h2>
<p>One way to view the results is to simply plot each calculated value
of the mesophyll conductance.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the mesophyll conductance values, grouped by CO2_r setpoint</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">gmc</span> <span class="op">~</span> <span class="va">seq_num</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  group <span class="op">=</span> <span class="va">CO2_r_sp</span>,</span>
<span>  data <span class="op">=</span> <span class="va">licor_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'p'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  auto.key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>space <span class="op">=</span> <span class="st">'right'</span><span class="op">)</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">'Measurement number'</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Mesophyll conductance to CO2'</span>, <span class="st">'['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">gmc</span>, <span class="st">']'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_gm_data_files/figure-html/plot_gm_1-1.png" width="720" style="display: block; margin: auto;"></p>
<p>Another approach is to plot the average mesophyll conductance against
the average
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>C</mi><mi>i</mi></msub><annotation encoding="application/x-tex">C_i</annotation></semantics></math>
for each CO<sub>2</sub> setpoint.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the average mesophyll conductance values against average Ci values,</span></span>
<span><span class="co"># grouped by CO2_r setpoint</span></span>
<span><span class="fu"><a href="../reference/xyplot_avg_rc.html">xyplot_avg_rc</a></span><span class="op">(</span></span>
<span>  <span class="va">licor_data</span><span class="op">[</span>, <span class="st">'gmc'</span><span class="op">]</span>,</span>
<span>  <span class="va">licor_data</span><span class="op">[</span>, <span class="st">'Ci'</span><span class="op">]</span>,</span>
<span>  <span class="va">licor_data</span><span class="op">[</span>, <span class="st">'CO2_r_sp'</span><span class="op">]</span>,</span>
<span>  <span class="va">licor_data</span><span class="op">[</span>, <span class="st">'curve_identifier'</span><span class="op">]</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'b'</span>,</span>
<span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Mesophyll conductance to CO2'</span>, <span class="st">'['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">gmc</span>, <span class="st">']'</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">']'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="analyzing_gm_data_files/figure-html/plot_gm_2-1.png" width="720" style="display: block; margin: auto;"></p>
<p>As usual, the appropriate synthesis operations will depend on the
details of the project and how the data will be used.</p>
</div>
<div class="section level2">
<h2 id="customizing-your-script">Customizing Your Script<a class="anchor" aria-label="anchor" href="#customizing-your-script"></a>
</h2>
<p>Note that most of the commands in this vignette have been written in
a general way so they can be used as the basis for your own analysis
script (see <a href="#commands-from-this-document">Commands From This
Document</a>). In order to use them in your own script, some or all of
the following changes may be required. There may also be others not
specifically mentioned here.</p>
<div class="section level3">
<h3 id="input-files">Input Files<a class="anchor" aria-label="anchor" href="#input-files"></a>
</h3>
<p>The file paths specified in <code>licor_file_paths</code> and
<code>tdl_file_paths</code> will need to be modified so they point to
your own files. One way to do this in your own script is to simply write
out relative or absolute paths to the files you wish to load. For
example, you could replace the previous definitions with these ones:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define a vector of paths to the files we wish to load</span></span>
<span><span class="va">licor_file_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">'myfile1.xlsx'</span>,        <span class="co"># `myfile1.xlsx` must be in the current working directory</span></span>
<span>  <span class="st">'C:/documents/myfile2'</span> <span class="co"># This is an absolute path to `myfile2`</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">tdl_file_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">'tdl_1.dat'</span>,     <span class="co"># `tdl_1.dat` must be in the current working directory</span></span>
<span>  <span class="st">'data/tdl_2.dat'</span> <span class="co"># The current working directory must contain a subdirectory</span></span>
<span><span class="op">)</span>                  <span class="co"># called `data` that contains `tdl2.dat`</span></span></code></pre></div>
<p>You may also want to consider using the
<code>choose_input_licor_files</code> and
<code>choose_input_tdl_files</code> functions from
<code>PhotoGEA</code>; these functions will create pop-up browser
windows where you can interactively select a set of files. Sometimes
this is more convenient than writing out file paths or names. For
example, you could replace the previous definitions with these ones:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Interactively define a vector of paths to the files we wish to load</span></span>
<span><span class="va">licor_file_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/choose_input_files.html">choose_input_licor_files</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tdl_file_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/choose_input_files.html">choose_input_tdl_files</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Unfortunately, <code>choose_input_licor_files</code> and
<code>choose_input_tdl_files</code> are only available in interactive R
sessions running on Microsoft Windows, but there is also a
platform-independent option: <code>choose_input_files</code>. See the
<em>Translation</em> section of the <a href="developing_a_data_analysis_pipeline.html#translation">Developing a
Data Analysis Pipeline</a> vignette for more details.</p>
</div>
<div class="section level3">
<h3 id="mesophyll-conductance-calculations">Mesophyll Conductance Calculations<a class="anchor" aria-label="anchor" href="#mesophyll-conductance-calculations"></a>
</h3>
<p>Sometimes it may not be possible to estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>Δ</mi><mrow><mi>g</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>t</mi><mi>h</mi></mrow><mrow><mi>o</mi><mi>b</mi><mi>s</mi></mrow></msubsup><annotation encoding="application/x-tex">\Delta^{obs}_{growth}</annotation></semantics></math>.
In this case, set <code>e_star_equation = 19</code> when calling
<code>calculate_gm_busch</code> or use <code>calculate_gm_ubierna</code>
instead of <code>calculate_gm_busch</code>.</p>
</div>
<div class="section level3">
<h3 id="saving-results">Saving Results<a class="anchor" aria-label="anchor" href="#saving-results"></a>
</h3>
<p>You may want to use <code>write.csv</code> to save some or all of the
results as <code>csv</code> files. For example, the following command
will allow you to interactively choose an output filename for a
<code>csv</code> file containing the combined gas exchange and TDL data,
along with the calculated values of isotope discrimination and mesophyll
conductance:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">licor_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.choose.html" class="external-link">file.choose</a></span><span class="op">(</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="commands-from-this-document">Commands From This Document<a class="anchor" aria-label="anchor" href="#commands-from-this-document"></a>
</h2>
<p>The following code chunk includes all the central commands used
throughout this document. They are compiled here to make them easy to
copy/paste into a text file to initialize your own script. Annotation
has also been added to clearly indicate the four steps involved in data
analysis, as described in the <a href="developing_a_data_analysis_pipeline.html">Developing a Data
Analysis Pipeline</a> vignette.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">###</span></span>
<span><span class="co">### PRELIMINARIES:</span></span>
<span><span class="co">### Loading packages, defining constants, creating helping functions, etc.</span></span>
<span><span class="co">###</span></span>
<span></span>
<span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/eloch216/PhotoGEA" class="external-link">PhotoGEA</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lattice.r-forge.r-project.org/" class="external-link">lattice</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">###</span></span>
<span><span class="co">### TRANSLATION:</span></span>
<span><span class="co">### Creating convenient R objects from raw data files</span></span>
<span><span class="co">###</span></span>
<span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Gas exchange log files</span></span>
<span><span class="co">##</span></span>
<span></span>
<span><span class="co">## IMPORTANT: When loading your own files, it is not advised to use</span></span>
<span><span class="co">## `PhotoGEA_example_file_path` as in the code below. Instead, write out the</span></span>
<span><span class="co">## names or use the `choose_input_licor_files` function.</span></span>
<span></span>
<span><span class="co"># Define a vector of paths to the files we wish to load; in this case, we are</span></span>
<span><span class="co"># loading example files included with the PhotoGEA package</span></span>
<span><span class="va">licor_file_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/PhotoGEA_example_file_path.html">PhotoGEA_example_file_path</a></span><span class="op">(</span><span class="st">'licor_for_gm_site11.xlsx'</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/PhotoGEA_example_file_path.html">PhotoGEA_example_file_path</a></span><span class="op">(</span><span class="st">'licor_for_gm_site13.xlsx'</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load each Licor file, storing the result in a list</span></span>
<span><span class="va">licor_exdf_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">licor_file_paths</span>, <span class="kw">function</span><span class="op">(</span><span class="va">fpath</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/read_gasex_file.html">read_gasex_file</a></span><span class="op">(</span><span class="va">fpath</span>, <span class="st">'time'</span>, posix_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>tz <span class="op">=</span> <span class="st">'US/Central'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get TDL sample and reference valve numbers from the Licor filenames</span></span>
<span><span class="va">licor_exdf_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">licor_exdf_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">exdf_obj</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/get_sample_valve_from_filename.html">get_sample_valve_from_filename</a></span><span class="op">(</span><span class="va">exdf_obj</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">'13'</span> <span class="op">=</span> <span class="fl">12</span>, <span class="co"># The reference valve is 12 when the sample valve is 13</span></span>
<span>    <span class="st">'11'</span> <span class="op">=</span> <span class="fl">10</span>  <span class="co"># The reference valve is 10 when the sample valve is 11</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get the names of all columns that are present in all of the Licor files</span></span>
<span><span class="va">licor_columns_to_keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">identify_common_columns</span>, <span class="va">licor_exdf_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract just these columns</span></span>
<span><span class="va">licor_exdf_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">licor_exdf_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span> , <span class="va">licor_columns_to_keep</span>, <span class="cn">TRUE</span><span class="op">]</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use `rbind` to combine all the data</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">licor_exdf_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Isotope discrimination log files</span></span>
<span><span class="co">##</span></span>
<span></span>
<span><span class="co">## IMPORTANT: When loading your own files, it is not advised to use</span></span>
<span><span class="co">## `PhotoGEA_example_file_path` as in the code below. Instead, write out the</span></span>
<span><span class="co">## names or use the `choose_input_tdl_files` function.</span></span>
<span></span>
<span><span class="co"># Define a vector of paths to the files we wish to load; in this case, we are</span></span>
<span><span class="co"># loading example files included with the PhotoGEA package</span></span>
<span><span class="va">tdl_file_paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/PhotoGEA_example_file_path.html">PhotoGEA_example_file_path</a></span><span class="op">(</span><span class="st">'tdl_for_gm.dat'</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load each TDL file, storing the result in a list</span></span>
<span><span class="va">tdl_exdf_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tdl_file_paths</span>, <span class="kw">function</span><span class="op">(</span><span class="va">fpath</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/read_gasex_file.html">read_gasex_file</a></span><span class="op">(</span><span class="va">fpath</span>, <span class="st">'TIMESTAMP'</span>, posix_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>tz <span class="op">=</span> <span class="st">'US/Central'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get the names of all columns that are present in all of the TDL files</span></span>
<span><span class="va">tdl_columns_to_keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">identify_common_columns</span>, <span class="va">tdl_exdf_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract just these columns</span></span>
<span><span class="va">tdl_exdf_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tdl_exdf_list</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[</span> , <span class="va">tdl_columns_to_keep</span>, <span class="cn">TRUE</span><span class="op">]</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use `rbind` to combine all the data</span></span>
<span><span class="va">tdl_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">tdl_exdf_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co">###</span></span>
<span><span class="co">### VALIDATION:</span></span>
<span><span class="co">### Organizing the data, checking its consistency and quality, cleaning it</span></span>
<span><span class="co">###</span></span>
<span></span>
<span><span class="co"># Create a new identifier column formatted like `machine - replicate`</span></span>
<span><span class="va">licor_data</span><span class="op">[</span> , <span class="st">'curve_identifier'</span><span class="op">]</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">licor_data</span><span class="op">[</span> , <span class="st">'machine'</span><span class="op">]</span>, <span class="va">licor_data</span><span class="op">[</span> , <span class="st">'replicate'</span><span class="op">]</span>, sep <span class="op">=</span> <span class="st">' - '</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make sure the data meets basic requirements</span></span>
<span><span class="fu"><a href="../reference/check_response_curve_data.html">check_response_curve_data</a></span><span class="op">(</span><span class="va">licor_data</span>, <span class="st">'curve_identifier'</span>, <span class="fl">12</span>, <span class="st">'CO2_r_sp'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Order by `Ci`.</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/organize_response_curve_data.html">organize_response_curve_data</a></span><span class="op">(</span></span>
<span>  <span class="va">licor_data</span>,</span>
<span>  <span class="st">'curve_identifier'</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>, <span class="co"># keep all the measured points</span></span>
<span>  <span class="st">'Ci'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Combining the gas exchange and isotope discrimination data</span></span>
<span><span class="co">##</span></span>
<span></span>
<span><span class="co"># Assign numbers to all full cycles in the TDL data set</span></span>
<span><span class="va">tdl_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/identify_tdl_cycles.html">identify_tdl_cycles</a></span><span class="op">(</span></span>
<span>  <span class="va">tdl_data</span>,</span>
<span>  valve_column_name <span class="op">=</span> <span class="st">'valve_number'</span>,</span>
<span>  cycle_start_valve <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  expected_cycle_length_minutes <span class="op">=</span> <span class="fl">2.7</span>,</span>
<span>  expected_cycle_num_valves <span class="op">=</span> <span class="fl">9</span>,</span>
<span>  timestamp_colname <span class="op">=</span> <span class="st">'TIMESTAMP'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use the data from the calibration valves to determine calibrated carbon</span></span>
<span><span class="co"># concentrations from all valves in each TDL cycle</span></span>
<span><span class="va">processed_tdl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/consolidate.html">consolidate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span><span class="op">(</span></span>
<span>  <span class="va">tdl_data</span>,</span>
<span>  <span class="va">tdl_data</span><span class="op">[</span>, <span class="st">'cycle_num'</span><span class="op">]</span>,</span>
<span>  <span class="va">process_tdl_cycle_erml</span>,</span>
<span>  valve_column_name <span class="op">=</span> <span class="st">'valve_number'</span>,</span>
<span>  noaa_valve <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  calibration_0_valve <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  calibration_1_valve <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  calibration_2_valve <span class="op">=</span> <span class="fl">23</span>,</span>
<span>  calibration_3_valve <span class="op">=</span> <span class="fl">26</span>,</span>
<span>  raw_12c_colname <span class="op">=</span> <span class="st">'Conc12C_Avg'</span>,</span>
<span>  raw_13c_colname <span class="op">=</span> <span class="st">'Conc13C_Avg'</span>,</span>
<span>  noaa_cylinder_co2_concentration <span class="op">=</span> <span class="fl">294.996</span>,</span>
<span>  noaa_cylinder_isotope_ratio <span class="op">=</span> <span class="op">-</span><span class="fl">8.40</span>,</span>
<span>  calibration_isotope_ratio <span class="op">=</span> <span class="op">-</span><span class="fl">11.505</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Pair the Licor and TDL data by locating the TDL cycle corresponding to each</span></span>
<span><span class="co"># Licor measurement</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pair_gasex_and_tdl.html">pair_gasex_and_tdl</a></span><span class="op">(</span><span class="va">licor_data</span>, <span class="va">processed_tdl</span><span class="op">$</span><span class="va">tdl_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##</span></span>
<span><span class="co">## Qualitative validation</span></span>
<span><span class="co">##</span></span>
<span></span>
<span><span class="co"># Plot the leaf temperature, grouped by CO2_r setpoint</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">TleafCnd</span> <span class="op">~</span> <span class="va">seq_num</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  group <span class="op">=</span> <span class="va">CO2_r_sp</span>,</span>
<span>  data <span class="op">=</span> <span class="va">licor_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'p'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  auto.key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>space <span class="op">=</span> <span class="st">'right'</span><span class="op">)</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">26</span>, <span class="fl">30</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">'Measurement number'</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Leaf temperature'</span>, <span class="st">'['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">TleafCnd</span>, <span class="st">']'</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot CO2_r, grouped by CO2_r setpoint</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">CO2_r</span> <span class="op">~</span> <span class="va">seq_num</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  group <span class="op">=</span> <span class="va">CO2_r_sp</span>,</span>
<span>  data <span class="op">=</span> <span class="va">licor_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'p'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  auto.key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>space <span class="op">=</span> <span class="st">'right'</span><span class="op">)</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">400</span>, <span class="fl">800</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">'Measurement number'</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'CO2 concentration'</span>, <span class="st">'['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">CO2_r</span>, <span class="st">']'</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">Conc13C_Avg</span> <span class="op">~</span> <span class="va">elapsed_time</span>,</span>
<span>  group <span class="op">=</span> <span class="va">valve_number</span>,</span>
<span>  data <span class="op">=</span> <span class="va">processed_tdl</span><span class="op">$</span><span class="va">tdl_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  auto.key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>space<span class="op">=</span><span class="st">'right'</span><span class="op">)</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'b'</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Elapsed time ('</span>, <span class="va">processed_tdl</span><span class="op">$</span><span class="va">tdl_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">elapsed_time</span>, <span class="st">')'</span><span class="op">)</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>    <span class="st">'Calibrated TDL 13C concentration ('</span>,</span>
<span>    <span class="va">processed_tdl</span><span class="op">$</span><span class="va">tdl_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Conc13C_Avg</span>, <span class="st">')'</span></span>
<span>  <span class="op">)</span>,</span>
<span>  par.settings <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    superpose.line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="../reference/multi_curve_colors.html">multi_curve_colors</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    superpose.symbol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="../reference/multi_curve_colors.html">multi_curve_colors</a></span><span class="op">(</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">###</span></span>
<span><span class="co">### PROCESSING:</span></span>
<span><span class="co">### Extracting new pieces of information from the data</span></span>
<span><span class="co">###</span></span>
<span></span>
<span><span class="co"># Calculate isotope discrimination</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_isotope_discrimination.html">calculate_isotope_discrimination</a></span><span class="op">(</span><span class="va">licor_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the photosynthetic isotope discrimination, grouped by CO2_r setpoint</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">Delta_obs_tdl</span> <span class="op">~</span> <span class="va">seq_num</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  group <span class="op">=</span> <span class="va">CO2_r_sp</span>,</span>
<span>  data <span class="op">=</span> <span class="va">licor_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'p'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  auto.key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>space <span class="op">=</span> <span class="st">'right'</span><span class="op">)</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">22</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">'Measurement number'</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Photosynthetic isotope discrimination'</span>, <span class="st">'['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Delta_obs_tdl</span>, <span class="st">']'</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set day respiration rate</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_variable.html">set_variable</a></span><span class="op">(</span></span>
<span>  <span class="va">licor_data</span>,</span>
<span>  <span class="st">'RL'</span>,</span>
<span>  <span class="st">'micromol m^(-2) s^(-1)'</span>,</span>
<span>  value <span class="op">=</span> <span class="fl">1.2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set Rubisco specificity</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_variable.html">set_variable</a></span><span class="op">(</span></span>
<span>    <span class="va">licor_data</span>,</span>
<span>    <span class="st">'specificity_at_tleaf'</span>,</span>
<span>    <span class="st">'M / M'</span>,</span>
<span>    value <span class="op">=</span> <span class="fl">92</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate Gamma_star</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_gamma_star.html">calculate_gamma_star</a></span><span class="op">(</span><span class="va">licor_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate total pressure</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_total_pressure.html">calculate_total_pressure</a></span><span class="op">(</span><span class="va">licor_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate gbc, gsc, Csurface</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_gas_properties.html">calculate_gas_properties</a></span><span class="op">(</span><span class="va">licor_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate t</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_ternary_correction.html">calculate_ternary_correction</a></span><span class="op">(</span><span class="va">licor_data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set Delta_obs_growth</span></span>
<span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_variable.html">set_variable</a></span><span class="op">(</span></span>
<span>  <span class="va">licor_data</span>,</span>
<span>  <span class="st">'Delta_obs_growth'</span>,</span>
<span>  <span class="st">'ppt'</span>,</span>
<span>  id_column <span class="op">=</span> <span class="st">'curve_identifier'</span>,</span>
<span>  value_table <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span></span>
<span>    <span class="va">licor_data</span><span class="op">[</span><span class="va">licor_data</span><span class="op">[</span>, <span class="st">'CO2_r_sp'</span><span class="op">]</span> <span class="op">==</span> <span class="fl">715</span>, <span class="st">'Delta_obs_tdl'</span><span class="op">]</span>,</span>
<span>    <span class="va">licor_data</span><span class="op">[</span><span class="va">licor_data</span><span class="op">[</span>, <span class="st">'CO2_r_sp'</span><span class="op">]</span> <span class="op">==</span> <span class="fl">715</span>, <span class="st">'curve_identifier'</span><span class="op">]</span>,</span>
<span>    <span class="va">mean</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">###</span></span>
<span><span class="co">### SYNTHESIS:</span></span>
<span><span class="co">### Using plots and statistics to help draw conclusions from the data</span></span>
<span><span class="co">###</span></span>
<span></span>
<span><span class="co"># Plot the mesophyll conductance values, grouped by CO2_r setpoint</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>  <span class="va">gmc</span> <span class="op">~</span> <span class="va">seq_num</span> <span class="op">|</span> <span class="va">curve_identifier</span>,</span>
<span>  group <span class="op">=</span> <span class="va">CO2_r_sp</span>,</span>
<span>  data <span class="op">=</span> <span class="va">licor_data</span><span class="op">$</span><span class="va">main_data</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'p'</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  auto.key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>space <span class="op">=</span> <span class="st">'right'</span><span class="op">)</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">'Measurement number'</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Mesophyll conductance to CO2'</span>, <span class="st">'['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">gmc</span>, <span class="st">']'</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the average mesophyll conductance values against average Ci values,</span></span>
<span><span class="co"># grouped by CO2_r setpoint</span></span>
<span><span class="fu"><a href="../reference/xyplot_avg_rc.html">xyplot_avg_rc</a></span><span class="op">(</span></span>
<span>  <span class="va">licor_data</span><span class="op">[</span>, <span class="st">'gmc'</span><span class="op">]</span>,</span>
<span>  <span class="va">licor_data</span><span class="op">[</span>, <span class="st">'Ci'</span><span class="op">]</span>,</span>
<span>  <span class="va">licor_data</span><span class="op">[</span>, <span class="st">'CO2_r_sp'</span><span class="op">]</span>,</span>
<span>  <span class="va">licor_data</span><span class="op">[</span>, <span class="st">'curve_identifier'</span><span class="op">]</span>,</span>
<span>  type <span class="op">=</span> <span class="st">'b'</span>,</span>
<span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Mesophyll conductance to CO2'</span>, <span class="st">'['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">gmc</span>, <span class="st">']'</span><span class="op">)</span>,</span>
<span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ['</span>, <span class="va">licor_data</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">']'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-busch_revisiting_2020" class="csl-entry">
Busch, Florian A., Meisha Holloway-Phillips, Hilary Stuart-Williams, and
Graham D. Farquhar. 2020. <span>“Revisiting Carbon Isotope
Discrimination in <span>C3</span> Plants Shows Respiration Rules When
Photosynthesis Is Low.”</span> <em>Nature Plants</em> 6 (3): 245–58. <a href="https://doi.org/10.1038/s41477-020-0606-6" class="external-link">https://doi.org/10.1038/s41477-020-0606-6</a>.
</div>
<div id="ref-evans_temperature_2013" class="csl-entry">
Evans, John R., and Susanne von Caemmerer. 2013. <span>“Temperature
Response of Carbon Isotope Discrimination and Mesophyll Conductance in
Tobacco.”</span> <em>Plant, Cell &amp; Environment</em> 36 (4): 745–56.
<a href="https://doi.org/10.1111/j.1365-3040.2012.02591.x" class="external-link">https://doi.org/10.1111/j.1365-3040.2012.02591.x</a>.
</div>
<div id="ref-farquhar_relationship_1982" class="csl-entry">
Farquhar, G. D., M. H. O’Leary, and J. A. Berry. 1982. <span>“On the
<span>Relationship</span> <span>Between</span> <span>Carbon</span>
<span>Isotope</span> <span>Discrimination</span> and the
<span>Intercellular</span> <span>Carbon</span> <span>Dioxide</span>
<span>Concentration</span> in <span>Leaves</span>.”</span>
<em>Functional Plant Biology</em> 9 (2): 121–37. <a href="https://doi.org/10.1071/pp9820121" class="external-link">https://doi.org/10.1071/pp9820121</a>.
</div>
<div id="ref-salesse-smith_modifying_2022" class="csl-entry">
Salesse-Smith, Coralie E, Steven M Driever, and Victoria C Clarke. 2022.
<span>“Modifying Mesophyll Conductance to Optimise Photosynthesis in
Crops.”</span> In <em>Understanding and Improving Crop
Photosynthesis</em>. Burleigh Dodds Science Publishing Limited.
</div>
<div id="ref-ubierna_using_2018" class="csl-entry">
Ubierna, Nerea, Meisha-Marika Holloway-Phillips, and Graham D. Farquhar.
2018. <span>“Using <span>Stable</span> <span>Carbon</span>
<span>Isotopes</span> to <span>Study</span> <span>C3</span> and
<span>C4</span> <span>Photosynthesis</span>: <span>Models</span> and
<span>Calculations</span>.”</span> In <em>Photosynthesis:
<span>Methods</span> and <span>Protocols</span></em>, edited by Sarah
Covshoff, 155–96. Methods in <span>Molecular</span>
<span>Biology</span>. New York, NY: Springer. <a href="https://doi.org/10.1007/978-1-4939-7786-4_10" class="external-link">https://doi.org/10.1007/978-1-4939-7786-4_10</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward B. Lochocki, Coralie E. Salesse-Smith, Justin M. McGrath.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
