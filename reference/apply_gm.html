<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate CO2 concentration in the chloroplast or mesophyll — apply_gm • PhotoGEA</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate CO2 concentration in the chloroplast or mesophyll — apply_gm"><meta name="description" content="Calculates CO2 concentration in the chloroplast or mesophyll, the CO2 drawdown
  across the stomata, and the CO2 drawdown across the mesophyll. This function
  can accomodate alternative column names for the variables taken from the Licor
  file in case they change at some point in the future. This function also
  checks the units of each required column and will produce an error if any
  units are incorrect."><meta property="og:description" content="Calculates CO2 concentration in the chloroplast or mesophyll, the CO2 drawdown
  across the stomata, and the CO2 drawdown across the mesophyll. This function
  can accomodate alternative column names for the variables taken from the Licor
  file in case they change at some point in the future. This function also
  checks the units of each required column and will produce an error if any
  units are incorrect."><meta property="og:image" content="https://eloch216.github.io/PhotoGEA/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    padding-top: 70px;

    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PhotoGEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/PhotoGEA.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-user-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">User Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-user-guides"><li><h6 class="dropdown-header" data-toc-skip>ANALYSIS GUIDES</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/web_only/analyzing_ball_berry_data.html">Analyzing Ball-Berry Data</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/analyzing_c3_aci_curves.html">Analyzing C3 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/analyzing_c4_aci_curves.html">Analyzing C4 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/analyzing_gm_data.html">Analyzing Mesophyll Conductance Data</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/analyzing_tdl_data.html">Analyzing TDL Data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>GENERAL PHOTOGEA ADVICE</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/web_only/combining_with_other_packages.html">Combining PhotoGEA With Other Packages</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/creating_your_own_processing_tools.html">Creating Your Own Processing Tools</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/developing_a_data_analysis_pipeline.html">Developing a Data Analysis Pipeline</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/working_with_extended_data_frames.html">Working With Extended Data Frames</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/frequent_questions.html">Frequently Asked Questions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>GENERAL GAS EXCHANGE ADVICE</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/web_only/LI6800_user_constants.html">Guide to Licor LI-6800 User Constants</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/web_only/publications.html">Publications</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/eloch216/PhotoGEA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Calculate CO2 concentration in the chloroplast or mesophyll</h1>

      <div class="d-none name"><code>apply_gm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates CO2 concentration in the chloroplast or mesophyll, the CO2 drawdown
  across the stomata, and the CO2 drawdown across the mesophyll. This function
  can accomodate alternative column names for the variables taken from the Licor
  file in case they change at some point in the future. This function also
  checks the units of each required column and will produce an error if any
  units are incorrect.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">apply_gm</span><span class="op">(</span></span>
<span>    <span class="va">exdf_obj</span>,</span>
<span>    gmc_at_25 <span class="op">=</span> <span class="st">''</span>,</span>
<span>    photosynthesis_type <span class="op">=</span> <span class="st">'C3'</span>,</span>
<span>    calculate_drawdown <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    a_column_name <span class="op">=</span> <span class="st">'A'</span>,</span>
<span>    ca_column_name <span class="op">=</span> <span class="st">'Ca'</span>,</span>
<span>    ci_column_name <span class="op">=</span> <span class="st">'Ci'</span>,</span>
<span>    gmc_norm_column_name <span class="op">=</span> <span class="st">'gmc_norm'</span>,</span>
<span>    total_pressure_column_name <span class="op">=</span> <span class="st">'total_pressure'</span>,</span>
<span>    perform_checks <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    return_exdf <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-exdf-obj">exdf_obj<a class="anchor" aria-label="anchor" href="#arg-exdf-obj"></a></dt>
<dd><p>An <code>exdf</code> object, typically representing data from a Licor gas exchange
    measurement system.</p></dd>


  <dt id="arg-gmc-at-">gmc_at_25<a class="anchor" aria-label="anchor" href="#arg-gmc-at-"></a></dt>
<dd><p>The mesophyll conductance to CO2 diffusion at 25 degrees C, expressed in
    <code>mol m^(-2) s^(-1) bar^(-1)</code>. In the absence of other reliable
    information, <code>gmc_at_25</code> is often assumed to be infinitely large. If
    <code>gmc_at_25</code> is not a number, then there must be a column in
    <code>exdf_obj</code> called <code>gmc_at_25</code> with appropriate units. A numeric
    value supplied here will overwrite the values in the <code>gmc_at_25</code>
    column of <code>exdf_obj</code> if it exists.</p></dd>


  <dt id="arg-photosynthesis-type">photosynthesis_type<a class="anchor" aria-label="anchor" href="#arg-photosynthesis-type"></a></dt>
<dd><p>A string indicating the type of photosynthesis being considered (either
    <code>'C3'</code> or <code>'C4'</code>).</p></dd>


  <dt id="arg-calculate-drawdown">calculate_drawdown<a class="anchor" aria-label="anchor" href="#arg-calculate-drawdown"></a></dt>
<dd><p>A logical value indicating whether to calculate drawdown values.</p></dd>


  <dt id="arg-a-column-name">a_column_name<a class="anchor" aria-label="anchor" href="#arg-a-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the net
    assimilation in <code>micromol m^(-2) s^(-1)</code>.</p></dd>


  <dt id="arg-ca-column-name">ca_column_name<a class="anchor" aria-label="anchor" href="#arg-ca-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the ambient CO2
    concentration in the chamber in <code>micromol mol^(-1)</code>.</p></dd>


  <dt id="arg-ci-column-name">ci_column_name<a class="anchor" aria-label="anchor" href="#arg-ci-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the intercellular
    CO2 concentration in <code>micromol mol^(-1)</code>.</p></dd>


  <dt id="arg-gmc-norm-column-name">gmc_norm_column_name<a class="anchor" aria-label="anchor" href="#arg-gmc-norm-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the normalized
    mesophyll conductance values (with units of
    <code>normalized to gmc at 25 degrees C</code>).</p></dd>


  <dt id="arg-total-pressure-column-name">total_pressure_column_name<a class="anchor" aria-label="anchor" href="#arg-total-pressure-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the total pressure
    in <code>bar</code>.</p></dd>


  <dt id="arg-perform-checks">perform_checks<a class="anchor" aria-label="anchor" href="#arg-perform-checks"></a></dt>
<dd><p>A logical value indicating whether to check units for the required columns.
    This should almost always be <code>TRUE</code>. The option to disable these checks
    is only intended to be used when <code><a href="fit_c3_aci.html">fit_c3_aci</a></code> calls this
    function, since performing these checks many times repeatedly slows down the
    fitting procedure.</p></dd>


  <dt id="arg-return-exdf">return_exdf<a class="anchor" aria-label="anchor" href="#arg-return-exdf"></a></dt>
<dd><p>A logical value indicating whether to return an <code>exdf</code> object. This
    should almost always be <code>TRUE</code>. The option to return a vector is mainly
    intended to be used when  <code><a href="fit_c3_aci.html">fit_c3_aci</a></code> calls this function,
    since creating an <code>exdf</code> object to return will slow down the fitting
    procedure.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For a C3 plant, the mesophyll conductance to CO2 (<code>gmc</code>) is said to be
  the conductance satisfying the following one-dimensional flux-conductance
  equation:</p>
<p>(1) <code>An = gmc * (PCi - PCc)</code></p>
<p>where <code>An</code> is the net CO2 assimilation rate, <code>PCi</code> is the partial
  pressure of CO2 in the intercellular spaces, and <code>PCc</code> is the partial
  pressure of CO2 in the chloroplast.  A key underlying assumption for this
  equation is that the flow of CO2 has reached a steady state; in this case, the
  flow across the stomata is equal to the flow across the mesophyll.</p>
<p>This equation can be rearranged to calculate <code>PCc</code>:</p>
<p>(2) <code>PCc = PCi - An / gmc</code></p>
<p>This version of the equation can be found in many places, for example, as
  Equation 4 in Sharkey et al. "Fitting photosynthetic carbon dioxide response
  curves for C3 leaves" Plant, Cell &amp; Environment 30, 1035–1040 (2007)
  [<a href="https://doi.org/10.1111/j.1365-3040.2007.01710.x" class="external-link">doi:10.1111/j.1365-3040.2007.01710.x</a>
].</p>
<p>It is common to express the partial pressures in <code>microbar</code> and the
  assimilation rate in <code>micromol m^(-2) s^(-1)</code>; in this case, the units of
  mesophyll conductance become <code>mol m^(-2) s^(-1) bar^(-1)</code>.</p>
<p>Licor measurement systems provide CO2 levels as relative concentrations with
  units of parts per million (<code>ppm</code>), or equivalently,
  <code>micromol mol^(-1)</code>. Concentrations and partial pressures are related by
  the total gas pressure according to:</p>
<p>(3) <code>partial_pressure = total_pressure * relative_concentration</code></p>
<p>Thus, it is also possible to calculate the CO2 concentration in the
  choloroplast (<code>Cc</code>) using the following equation:</p>
<p>(4) <code>Cc = Ci - An / (gmc * P)</code></p>
<p>where <code>Ci</code> is the intercellular CO2 concentration and <code>P</code> is the
  total pressure. In this function, Equation (4) is used to calculate <code>Cc</code>,
  where the total pressure is given by the sum of the atmospheric pressure and
  the chamber overpressure.</p>
<p>When a plant is photosynthesizing, it draws CO2 into its chloroplasts, and
  this flow is driven by a concentration gradient. In other words, as CO2 flows
  from the ambient air across the stomata to the intercellular spaces and then
  across the mesophyll into the chloroplast, there is a decrease in CO2
  concentration at each step. Sometimes it is useful to calculate these changes,
  which are usually referred to as "CO2 drawdown" values. So, in addition to
  <code>Ci</code>, this function (optionally) calculates the drawdown of CO2 across
  the stomata (<code>drawndown_cs = Ca - Ci</code>) and the drawdown of CO2 across the
  mesophyll (<code>drawdown_cm = Ci - Cc</code>).</p>
<p>_Note_: mesophyll conductance is not specified in typical Licor files, so it
  usually must be added using <code><a href="set_variable.html">set_variable</a></code> before calling
  <code>apply_gm</code>.</p>
<p>For a C4 plant, mesophyll conductance instead refers to the conductance
  associated with the flow of CO2 from the intercellular spaces into the
  mesophyll (rather than into the chloroplast). In this case, the equations
  above just require a small modification where <code>Pcc</code> and <code>Cc</code> are
  replaced by <code>PCm</code> and <code>Cm</code>, the partial pressure and concentration
  of CO2 in the mesophyll.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The return value depends on the value of <code>return_exdf</code>:</p><ul><li><p>If <code>return_exdf</code> is <code>TRUE</code>, the return value is an
          <code>exdf</code> object based on <code>exdf_obj</code> with the following
          columns, calculated as described above: <code>Pci</code> and <code>Ci</code>
          (for C3 plants) or <code>PCm</code> and <code>Cm</code> (for C4 plants),
          <code>drawndown_s</code>, and <code>drawdown_cm</code>. The category for each of
          these new columns is <code>apply_gm</code> to indicate that they were
          created using this function.</p></li>
<li><p>If <code>return_exdf</code> is <code>FALSE</code>, the return value is a list with
          a single named element (<code>internal_c</code>), which contains values of
          <code>Cc</code> or <code>Cm</code> as a numeric vector.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Read an example Licor file included in the PhotoGEA package</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_gasex_file.html">read_gasex_file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="PhotoGEA_example_file_path.html">PhotoGEA_example_file_path</a></span><span class="op">(</span><span class="st">'ball_berry_1.xlsx'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate the total pressure in the Licor chamber</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_total_pressure.html">calculate_total_pressure</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate temperature-dependent parameter values, including gmc_norm</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_temperature_response.html">calculate_temperature_response</a></span><span class="op">(</span><span class="va">licor_file</span>, <span class="va">c3_temperature_param_sharkey</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate Cc and drawdowns assuming a mesophyll conductance of</span></span></span>
<span class="r-in"><span><span class="co"># 1 mol / m^2 / s / bar at 25 degrees C</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu">apply_gm</span><span class="op">(</span><span class="va">licor_file</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">licor_file</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Cc</span>      <span class="co"># View the units of the new `Cc` column</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "micromol mol^(-1)"</span>
<span class="r-in"><span><span class="va">licor_file</span><span class="op">$</span><span class="va">categories</span><span class="op">$</span><span class="va">Cc</span> <span class="co"># View the category of the new `Cc` column</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "apply_gm"</span>
<span class="r-in"><span><span class="va">licor_file</span><span class="op">[</span>, <span class="st">'Cc'</span><span class="op">]</span>       <span class="co"># View the values of the new `Cc` column</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 227.9750 264.4588 238.0217 214.3254 266.2391 289.8527 348.1129 284.2256</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] 289.2213 285.1018 324.0571 295.4103 313.8207 344.2157 256.2342 295.6076</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] 303.3559 294.7550 328.8761 247.5899 326.4344 218.9675 229.7293 245.0303</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] 276.8719 310.5874 304.1105 250.1419</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward B. Lochocki, Coralie E. Salesse-Smith, Justin M. McGrath.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

