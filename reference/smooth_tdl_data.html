<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Tool for applying a smoothing function to the time series corresponding to
  measurements from a single valve in a tunable diode laser (TDL) data set."><title>Smoothing data from one TDL valve — smooth_tdl_data • PhotoGEA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Smoothing data from one TDL valve — smooth_tdl_data"><meta property="og:description" content="Tool for applying a smoothing function to the time series corresponding to
  measurements from a single valve in a tunable diode laser (TDL) data set."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    padding-top: 70px;

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PhotoGEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/PhotoGEA.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/analyzing_ball_berry_data.html">Analyzing Ball-Berry Data</a>
    <a class="dropdown-item" href="../articles/analyzing_tdl_data.html">Analyzing TDL Data</a>
    <a class="dropdown-item" href="../articles/developing_a_data_analysis_pipeline.html">Developing a Data Analysis Pipeline</a>
    <a class="dropdown-item" href="../articles/working_with_extended_data_frames.html">Working With Extended Data Frames</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/eloch216/PhotoGEA/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Smoothing data from one TDL valve</h1>
      
      <div class="d-none name"><code>smooth_tdl_data.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Tool for applying a smoothing function to the time series corresponding to
  measurements from a single valve in a tunable diode laser (TDL) data set.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">smooth_tdl_data</span><span class="op">(</span></span>
<span>    <span class="va">tdl_exdf</span>,</span>
<span>    <span class="va">column_to_be_smoothed</span>,</span>
<span>    <span class="va">valve_column_name</span>,</span>
<span>    <span class="va">valve_number</span>,</span>
<span>    <span class="va">smoothing_function</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>tdl_exdf</dt>
<dd><p>An <code>exdf</code> object representing data from a TDL data logger.</p></dd>


  <dt>column_to_be_smoothed</dt>
<dd><p>The name of the column in <code>tdl_exdf</code> that contains the data to be
    smoothed; typically, this is <code>'Conc12C_Avg'</code> or <code>'Conc12C_Avg'</code>.</p></dd>


  <dt>valve_column_name</dt>
<dd><p>The name of the column in <code>tdl_exdf</code> that contains the valve number;
    typically, this is <code>'valve_number'</code>.</p></dd>


  <dt>valve_number</dt>
<dd><p>The value of the <code>valve_column_name</code> column that indicates the valve to
    be smoothed.</p></dd>


  <dt>smoothing_function</dt>
<dd><p>A function that accepts two vectors <code>Y</code> and <code>X</code> (in that order)
    and returns a smoothed version of <code>Y(X)</code>; typically,
    <code>smoothing_function</code> is based on <code><a href="https://rdrr.io/r/stats/smooth.spline.html" class="external-link">smooth.spline</a></code> or a
    filter from the <code>signal</code> package.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The output from a TDL is highly sensitive to electronic and atmospheric noise,
  and it is often helpful to smooth the data from one or more valves before
  attempting to apply calibration corrections or determine the content of an
  unknown gas mixture. <code>smooth_tdl_data</code> is a convenience function that
  extracts a time series corresponding to data from one valve, applies a
  smoothing operation, and replaces the original data in <code>tdl_exdf</code> with
  the smoothed version. The smoothing function is user-supplied to allow more
  flexbility.</p>
<p>In addition to the <code>column_to_be_smoothed</code> and <code>valve_column_name</code>
  columns, the <code>tdl_exdf</code> must also contain an <code>'elapsed_time'</code>
  column, which is typically created by a call to
  <code><a href="identify_tdl_cycles.html">identify_tdl_cycles</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An <code>exdf</code> object based on <code>tdl_exdf</code>, where the time series of</p>
<p></p>
<p><code>column_to_be_smoothed</code> vs. <code>'elapsed_time'</code> has been replaced by a
  smoothed version obtained by applying the <code>smoothing_function</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example 1: Smoothing the 12C signal from one TDL valve using a spline fit</span></span></span>
<span class="r-in"><span><span class="va">tdl_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_tdl_file.html">read_tdl_file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"tdl_sampling_1.dat"</span>, package <span class="op">=</span> <span class="st">"PhotoGEA"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="st">'TIMESTAMP'</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tdl_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="identify_tdl_cycles.html">identify_tdl_cycles</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">tdl_file</span>,</span></span>
<span class="r-in"><span>  valve_column_name <span class="op">=</span> <span class="st">'valve_number'</span>,</span></span>
<span class="r-in"><span>  cycle_start_valve <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  expected_cycle_length_minutes <span class="op">=</span> <span class="fl">2.7</span>,</span></span>
<span class="r-in"><span>  expected_cycle_num_pts <span class="op">=</span> <span class="fl">9</span>,</span></span>
<span class="r-in"><span>  timestamp_colname <span class="op">=</span> <span class="st">'TIMESTAMP'</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">spline_smoothing_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/smooth.spline.html" class="external-link">smooth.spline</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">ss</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">spline_smoothed_tdl_file</span> <span class="op">&lt;-</span> <span class="fu">smooth_tdl_data</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">tdl_file</span>, <span class="st">'Conc12C_Avg'</span>, <span class="st">'valve_number'</span>, <span class="fl">20</span>, <span class="va">spline_smoothing_function</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Smoothing the same data with a Butterworth filter (as an</span></span></span>
<span class="r-in"><span><span class="co"># alternative to the spline_smoothing_function above)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">butterworth_smoothing_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># Create a low-pass Butterworth filter</span></span></span>
<span class="r-in"><span>  <span class="va">lpf</span> <span class="op">&lt;-</span> <span class="fu">signal</span><span class="fu">::</span><span class="fu">butter</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.25</span>, type <span class="op">=</span> <span class="st">"low"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Apply it to the Y data</span></span></span>
<span class="r-in"><span>  <span class="fu">signal</span><span class="fu">::</span><span class="fu">filter</span><span class="op">(</span><span class="va">lpf</span>, <span class="va">Y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">butterworth_smoothed_tdl_file</span> <span class="op">&lt;-</span> <span class="fu">smooth_tdl_data</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">tdl_file</span>, <span class="st">'Conc12C_Avg'</span>, <span class="st">'valve_number'</span>, <span class="fl">20</span>, <span class="va">butterworth_smoothing_function</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Edward B. Lochocki.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

