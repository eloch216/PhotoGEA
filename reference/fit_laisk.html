<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate RL and Ci_star using the Laisk method — fit_laisk • PhotoGEA</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate RL and Ci_star using the Laisk method — fit_laisk"><meta name="description" content="Uses the Laisk method to estimate Ci_star and RL. This function
  can accomodate alternative colum names for the variables taken from log files
  in case they change at some point in the future. This function also checks the
  units of each required column and will produce an error if any units are
  incorrect."><meta property="og:description" content="Uses the Laisk method to estimate Ci_star and RL. This function
  can accomodate alternative colum names for the variables taken from log files
  in case they change at some point in the future. This function also checks the
  units of each required column and will produce an error if any units are
  incorrect."><meta property="og:image" content="https://eloch216.github.io/PhotoGEA/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    padding-top: 70px;

    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PhotoGEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/PhotoGEA.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/analyzing_ball_berry_data.html">Analyzing Ball-Berry Data</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_c3_aci_curves.html">Analyzing C3 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_c4_aci_curves.html">Analyzing C4 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_gm_data.html">Analyzing Mesophyll Conductance Data</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_tdl_data.html">Analyzing TDL Data</a></li>
    <li><a class="dropdown-item" href="../articles/combining_with_other_packages.html">Combining PhotoGEA With Other Packages</a></li>
    <li><a class="dropdown-item" href="../articles/creating_your_own_processing_tools.html">Creating Your Own Processing Tools</a></li>
    <li><a class="dropdown-item" href="../articles/developing_a_data_analysis_pipeline.html">Developing a Data Analysis Pipeline</a></li>
    <li><a class="dropdown-item" href="../articles/working_with_extended_data_frames.html">Working With Extended Data Frames</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/eloch216/PhotoGEA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Calculate RL and Ci_star using the Laisk method</h1>

      <div class="d-none name"><code>fit_laisk.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Uses the Laisk method to estimate <code>Ci_star</code> and <code>RL</code>. This function
  can accomodate alternative colum names for the variables taken from log files
  in case they change at some point in the future. This function also checks the
  units of each required column and will produce an error if any units are
  incorrect.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_laisk</span><span class="op">(</span></span>
<span>    <span class="va">replicate_exdf</span>,</span>
<span>    ci_lower <span class="op">=</span> <span class="fl">40</span>,  <span class="co"># ppm</span></span>
<span>    ci_upper <span class="op">=</span> <span class="fl">120</span>, <span class="co"># ppm</span></span>
<span>    a_column_name <span class="op">=</span> <span class="st">'A'</span>,</span>
<span>    ci_column_name <span class="op">=</span> <span class="st">'Ci'</span>,</span>
<span>    ppfd_column_name <span class="op">=</span> <span class="st">'PPFD'</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-replicate-exdf">replicate_exdf<a class="anchor" aria-label="anchor" href="#arg-replicate-exdf"></a></dt>
<dd><p>An <code>exdf</code> object containing multiple A-Ci curves measured at different
    levels of incident photosynthetically active photon flux density (PPFD).</p></dd>


  <dt id="arg-ci-lower">ci_lower<a class="anchor" aria-label="anchor" href="#arg-ci-lower"></a></dt>
<dd><p>Lower end of <code>Ci</code> range used for linear fits of <code>An</code> vs.
    <code>Ci</code>.</p></dd>


  <dt id="arg-ci-upper">ci_upper<a class="anchor" aria-label="anchor" href="#arg-ci-upper"></a></dt>
<dd><p>Upper end of <code>Ci</code> range used for linear fits of <code>An</code> vs.
    <code>Ci</code>.</p></dd>


  <dt id="arg-a-column-name">a_column_name<a class="anchor" aria-label="anchor" href="#arg-a-column-name"></a></dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the net CO2
    assimilation rate <code>An</code> in <code>micromol m^(-2) s^(-1)</code>.</p></dd>


  <dt id="arg-ci-column-name">ci_column_name<a class="anchor" aria-label="anchor" href="#arg-ci-column-name"></a></dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the
    intercellular CO2 concentration <code>Ci</code> in <code>micromol mol^(-1)</code>.</p></dd>


  <dt id="arg-ppfd-column-name">ppfd_column_name<a class="anchor" aria-label="anchor" href="#arg-ppfd-column-name"></a></dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that can be used to split it
    into individual response curves. Typically the individial curves are
    measured at different values of incident light, but the log entries for
    <code>'Qin'</code> are not all exactly the same. It is advised to create a new
    column called <code>'PPFD'</code> with rounded values. For example,
    <code>licor_data[, 'PPFD'] &lt;- round(licor_data[, 'Qin'])</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The Laisk method is a way to estimate <code>RL</code> and <code>Ci_star</code> for a C3
  plant. Definitions of these quantities and a description of the theory
  underpinning this method is given below.</p>
<p>For a C3 plant, the net CO2 assimilation rate <code>An</code> is given by</p>
<p><code>An = Vc - Rp - RL</code>,</p>
<p>where <code>Vc</code> is the rate of RuBP carboxylation, <code>Rp</code> is the rate of
  carbon loss due to photorespiration, and <code>RL</code> is the rate of carbon loss
  due to non-photorespiratory respiration (also known as the rate of day
  respiration, the rate of mitochondrial respiration, or the rate of respiration
  in the light). Because RuBP carboxylation and photorespiration both occur due
  to Rubisco activity, these rates are actually proportional to each other:</p>
<p><code>Rp = Vc * Gamma_star / Cc</code>,</p>
<p>where <code>Cc</code> is the CO2 concentration in the chloroplast (where Rubisco is
  located) and <code>Gamma_star</code> will be discussed below. Using this expression,
  the net CO2 assimilation rate can be written as</p>
<p><code>An = Vc * (1 - Gamma_star / Cc) - RL</code>.</p>
<p>When <code>Cc</code> is equal to <code>Gamma_star</code>, the net assimilation rate is
  equal to <code>-RL</code>. For this reason, <code>Gamma_star</code> is usually referred to
  as the CO2 compensation point in the absence of mitochondrial respiration.</p>
<p>In general, <code>Cc</code> is related to the intercellular CO2 concentration
  <code>Ci</code> according to</p>
<p><code>Ci = Cc + An / gmc</code>,</p>
<p>where <code>gmc</code> is the mesophyll conductance to CO2 diffusion. When <code>Cc</code>
  is equal to <code>Gamma_star</code>, we therefore have
  <code>Ci = Gamma_star - RL / gmc</code>. This special value of <code>Ci</code> is referred
  to as <code>Ci_star</code>, and can be understood as the value of <code>Ci</code> where
  <code>Cc = Gamma_star</code> and <code>An = -RL</code>. Note that the values of
  <code>Gamma_star</code> and <code>Ci_star</code> depend on Rubisco properties, mesophyll
  conductance, and the ambient O2 concentration, but not on the incident light
  intensity.</p>
<p>These observations suggest a method for estimating <code>RL</code> from a leaf:
  Measure <code>An</code> vs. <code>Ci</code> curves at several light intensities, and find
  the value of <code>Ci</code> where the curves intersect with each other. This will
  be <code>Ci_star</code>, and the corresponding value of <code>An</code> will be equal to
  <code>-RL</code>.</p>
<p>In practice, it is unlikely that the measured curves will all exactly
  intersect at a single point. A method for dealing with this issue was
  developed in Walker &amp; Ort (2015) and described in more detail in Busch et al.
  (2024). Briefly, a linear fit is first made to each A-Ci curve, enabling the
  calculation of an intercept-slope curve. Then another linear fit is made to
  the intercept-slope curve. The intercept of this fit is equal to <code>-RL</code>
  and its slope is equal to <code>-Ci_star</code>.</p>
<p>Note: it is possible that <code>RL</code> depends on incident light intensity, an
  issue which complicates the application of the Laisk method. See the
  references for more details.</p>
<p><strong>References</strong>:</p>
<p></p><ul><li><p>Yin, X., Sun, Z., Struik, P. C. &amp; Gu, J. "Evaluating a new method to
          estimate the rate of leaf respiration in the light by analysis of
          combined gas exchange and chlorophyll fluorescence measurements."
          Journal of Experimental Botany 62, 3489–3499 (2011)
          [<a href="https://doi.org/10.1093/jxb/err038" class="external-link">doi:10.1093/jxb/err038</a>
].</p></li>
<li><p>Walker, B. J. &amp; Ort, D. R. "Improved method for measuring the
          apparent CO2 photocompensation point resolves the impact of multiple
          internal conductances to CO2 to net gas exchange." Plant, Cell &amp;
          Environment 38, 2462–2474 (2015)
          [<a href="https://doi.org/10.1111/pce.12562" class="external-link">doi:10.1111/pce.12562</a>
].</p></li>
<li><p>Busch, F. A. et al. "A guide to photosynthetic gas exchang
          measurements: Fundamental principles, best practice and potential
          pitfalls." Plant, Cell &amp; Environment 47, 3344–3364 (2024)
          [<a href="https://doi.org/10.1111/pce.14815" class="external-link">doi:10.1111/pce.14815</a>
].</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>This function returns a list with the following named elements:</p><ul><li><p><code>first_fit_parameters</code>: An <code>exdf</code> object with the slope (and
          its standard error), intercept (and its standard error), R-squared
          value, and p-value for each linear fit of A vs. Ci. These are included
          as the <code>laisk_slope</code>, <code>laisk_slope_err</code>,
          <code>laisk_intercept</code>, <code>laisk_intercept_err</code>, <code>r_squared</code>,
          and <code>p_value</code> columns.</p></li>
<li><p><code>first_fits</code>: An <code>exdf</code> object based on
          <code>replicate_exdf</code> that also includes the fitted values of
          <code>An</code> in a new column whose name is <code>a_column_name</code> followed
          by <code>_fit</code> (for example, <code>A_fit</code>). The fits are extrapolated
          to <code>Ci = 0</code> so they can be visually checked for a common
          intersection point.</p></li>
<li><p><code>second_fit_parameters</code>: An <code>exdf</code> object with <code>RL</code>
          (and its standard error), <code>Ci_Star</code> (and its standard error) as
          estimated from a linear fit of <code>laisk_intercept</code> vs.
          <code>laisk_slope</code>. Also includes the R-squared and p-value of the
          fit.</p></li>
<li><p><code>second_fit_parameters</code>: An <code>exdf</code> object based on
          <code>first_fit_parameters</code> that also includes fitted values of
          <code>laisk_intercept</code> in the <code>laisk_intercept_fit</code> column.</p></li>
</ul><p>As noted above, the estimated values of <code>RL</code> and <code>Ci_star</code> are
  included in the <code>second_fit_parameters</code> element of the returned list.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Read an example Licor file included in the PhotoGEA package</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_gasex_file.html">read_gasex_file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="PhotoGEA_example_file_path.html">PhotoGEA_example_file_path</a></span><span class="op">(</span><span class="st">'c3_aci_1.xlsx'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define a new column that uniquely identifies each curve</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species_plot'</span><span class="op">]</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species'</span><span class="op">]</span>, <span class="st">'-'</span>, <span class="va">licor_file</span><span class="op">[</span>, <span class="st">'plot'</span><span class="op">]</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Organize the data</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="organize_response_curve_data.html">organize_response_curve_data</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">licor_file</span>,</span></span>
<span class="r-in"><span>    <span class="st">'species_plot'</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">'CO2_r_sp'</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Apply the Laisk method. Note: this is a bad example because these curves were</span></span></span>
<span class="r-in"><span><span class="co"># measured at the same light intensity, but from different species. Because of</span></span></span>
<span class="r-in"><span><span class="co"># this, the results are not meaningful.</span></span></span>
<span class="r-in"><span><span class="va">laisk_results</span> <span class="op">&lt;-</span> <span class="fu">fit_laisk</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">licor_file</span>, <span class="fl">20</span>, <span class="fl">150</span>,</span></span>
<span class="r-in"><span>  ppfd_column_name <span class="op">=</span> <span class="st">'species_plot'</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get estimated values</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">laisk_results</span><span class="op">$</span><span class="va">second_fit_parameters</span><span class="op">[</span>, <span class="st">'RL'</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.617453</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">laisk_results</span><span class="op">$</span><span class="va">second_fit_parameters</span><span class="op">[</span>, <span class="st">'Ci_star'</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 69.37657</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot the linear fits of A vs. Ci</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_laisk_fit.html">plot_laisk_fit</a></span><span class="op">(</span><span class="va">laisk_results</span>, <span class="st">'instrument'</span>, <span class="st">'first'</span>, ppfd_column_name <span class="op">=</span> <span class="st">'species_plot'</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in plot_laisk_fit(laisk_results, "instrument", "first", ppfd_column_name = "species_plot"):</span> object 'laisk_results' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot the linear fits of Laisk intercept vs. Laisk slope</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_laisk_fit.html">plot_laisk_fit</a></span><span class="op">(</span><span class="va">laisk_results</span>, <span class="st">'instrument'</span>, <span class="st">'second'</span>, ppfd_column_name <span class="op">=</span> <span class="st">'species_plot'</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in plot_laisk_fit(laisk_results, "instrument", "second", ppfd_column_name = "species_plot"):</span> object 'laisk_results' not found</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward B. Lochocki.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

