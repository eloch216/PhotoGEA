<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Reading a Licor LI-6800 Excel log file — read_licor_6800_Excel • PhotoGEA</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reading a Licor LI-6800 Excel log file — read_licor_6800_Excel"><meta name="description" content="Tool for reading Excel log files created by Licor LI-6800 instruments and
  storing their contents in exdf objects."><meta property="og:description" content="Tool for reading Excel log files created by Licor LI-6800 instruments and
  storing their contents in exdf objects."><meta property="og:image" content="https://eloch216.github.io/PhotoGEA/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    padding-top: 70px;

    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PhotoGEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/PhotoGEA.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/analyzing_ball_berry_data.html">Analyzing Ball-Berry Data</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_c3_aci_curves.html">Analyzing C3 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_c4_aci_curves.html">Analyzing C4 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_gm_data.html">Analyzing Mesophyll Conductance Data</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_tdl_data.html">Analyzing TDL Data</a></li>
    <li><a class="dropdown-item" href="../articles/combining_with_other_packages.html">Combining PhotoGEA With Other Packages</a></li>
    <li><a class="dropdown-item" href="../articles/creating_your_own_processing_tools.html">Creating Your Own Processing Tools</a></li>
    <li><a class="dropdown-item" href="../articles/developing_a_data_analysis_pipeline.html">Developing a Data Analysis Pipeline</a></li>
    <li><a class="dropdown-item" href="../articles/working_with_extended_data_frames.html">Working With Extended Data Frames</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/eloch216/PhotoGEA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Reading a Licor LI-6800 Excel log file</h1>

      <div class="d-none name"><code>read_licor_6800_Excel.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Tool for reading Excel log files created by Licor LI-6800 instruments and
  storing their contents in <code><a href="exdf.html">exdf</a></code> objects.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">read_licor_6800_Excel</span><span class="op">(</span></span>
<span>    <span class="va">file_name</span>,</span>
<span>    column_name <span class="op">=</span> <span class="st">'obs'</span>,</span>
<span>    get_oxygen <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    check_for_zero <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'A'</span>, <span class="st">'gsw'</span><span class="op">)</span>,</span>
<span>    <span class="va">...</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-file-name">file_name<a class="anchor" aria-label="anchor" href="#arg-file-name"></a></dt>
<dd><p>A relative or absolute path to an Excel file containing Licor data.</p></dd>


  <dt id="arg-column-name">column_name<a class="anchor" aria-label="anchor" href="#arg-column-name"></a></dt>
<dd><p>A column name that should be present in the log file; used to identify the
    beginning of the data block in the file.</p></dd>


  <dt id="arg-get-oxygen">get_oxygen<a class="anchor" aria-label="anchor" href="#arg-get-oxygen"></a></dt>
<dd><p>A logical value indicating whether to get the oxygen percentage from the
    file's preamble using <code><a href="get_oxygen_from_preamble.html">get_oxygen_from_preamble</a></code>.</p></dd>


  <dt id="arg-check-for-zero">check_for_zero<a class="anchor" aria-label="anchor" href="#arg-check-for-zero"></a></dt>
<dd><p>The names of columns whose values should not all be zero; see below for
    details.</p></dd>


  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments; currently unused.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Licor LI-6800 instruments create two types of log files: a plain-text file and
  an Excel file, each containing the same information. In general, the Excel
  files are much easier to modify, for example, deleting rows or adding new
  columns. For this reason, it is helpful to be able to read these files in R.
  Unfortunately, base R does not have any functionality for reading Excel files,
  so here the <code>openxlsx</code> package is used.</p>
<p><code>read_licor_6800_Excel</code> looks for a particular data column
  (<code>column_name</code>) in order to identify the start of the data table within
  the contents of the Licor file. Rows above the main data table are assumed to
  be part of the preamble (or header), which are broken into pairs of rows
  representing names and values.</p>
<p><strong>"Calculating" formula values</strong>: By default, Licor Excel files do not
  "calculate" formula values. This causes a problem when reading them in R,
  since any data entry determined from a formula will be read as 0. To fix this
  issue for a Licor Excel file, open it in in Excel, go to the <code>Formulas</code>
  menu, and choose <code>Calculate Now</code>. (Alternatively, press F9.) Then save
  the file and close it. See these articles for more information about this
  issue:</p><ul><li><p><a href="https://github.com/ycphs/openxlsx/issues/261" class="external-link">GitHub issue 261 from the openxlsx package</a></p></li>
<li><p><a href="https://github.com/JanMarvin/openxlsx2/issues/863" class="external-link">GitHub issue 863 from the openxlsx2 package</a></p></li>
<li><p><a href="https://github.com/tidyverse/readxl/issues/495" class="external-link">GitHub issue 495 from the readxl package</a></p></li>
</ul><p><code>read_licor_6800_Excel</code> attempts to detect this issue by checking the
  values of key columns (specified by the <code>check_for_zero</code> input argument).
  If any of these columns are all 0, then an error message will be sent. This
  feature can be disabled by setting <code>check_for_zero = c()</code> when calling
  <code>read_licor_6800_Excel</code> or <code>read_gasex_file</code>.</p>
<p><strong>File structure</strong>: Not that this function is not foolproof and may not
  be able to read some LI-6800 log files. For example, this function assumes
  that the logged points are contained in a single table. If user constants are
  logged as rows rather than columns, the file will instead contain multiple
  tables, and this function will not be able to read it.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An <code>exdf</code> object that fully includes all the data from the Licor Excel
  file. In addition to the elements described in the documentation for
  <code><a href="read_gasex_file.html">read_gasex_file</a></code>, the following "extra" elements are also
  included:</p><ul><li><p><code>preamble</code>: A data frame containing the "preamble" (or "header")
          information from the file.</p></li>
<li><p><code>data_row</code>: The line of the file where the column name was found.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="read_gasex_file.html">read_gasex_file</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example 1: Reading a Licor Excel file that is included with the PhotoGEA</span></span></span>
<span class="r-in"><span><span class="co"># package.</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu">PhotoGEA</span><span class="fu">:::</span><span class="fu">read_licor_6800_Excel</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="PhotoGEA_example_file_path.html">PhotoGEA_example_file_path</a></span><span class="op">(</span><span class="st">'ball_berry_1.xlsx'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Reading a Licor Excel file that is included with the PhotoGEA</span></span></span>
<span class="r-in"><span><span class="co"># package; here we use a different column name to identify the data block within</span></span></span>
<span class="r-in"><span><span class="co"># the file's contents.</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu">PhotoGEA</span><span class="fu">:::</span><span class="fu">read_licor_6800_Excel</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="PhotoGEA_example_file_path.html">PhotoGEA_example_file_path</a></span><span class="op">(</span><span class="st">'ball_berry_1.xlsx'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  column_name <span class="op">=</span> <span class="st">'A'</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward B. Lochocki.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

