<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate C4 assimilation rates using a hyperbola — calculate_c4_assimilation_hyperbola • PhotoGEA</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate C4 assimilation rates using a hyperbola — calculate_c4_assimilation_hyperbola"><meta name="description" content="Calculates C4 assimilation rates based on an empirical hyperbolic model. This
  function can accomodate alternative colum names for the variables taken from
  Licor files in case they change at some point in the future. This function
  also checks the units of each required column and will produce an error if any
  units are incorrect."><meta property="og:description" content="Calculates C4 assimilation rates based on an empirical hyperbolic model. This
  function can accomodate alternative colum names for the variables taken from
  Licor files in case they change at some point in the future. This function
  also checks the units of each required column and will produce an error if any
  units are incorrect."><meta property="og:image" content="https://eloch216.github.io/PhotoGEA/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    padding-top: 70px;

    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PhotoGEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/PhotoGEA.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-user-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">User Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-user-guides"><li><h6 class="dropdown-header" data-toc-skip>ANALYSIS GUIDES</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/web_only/analyzing_ball_berry_data.html">Analyzing Ball-Berry Data</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/analyzing_c3_aci_curves.html">Analyzing C3 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/analyzing_c4_aci_curves.html">Analyzing C4 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/analyzing_gm_data.html">Analyzing Mesophyll Conductance Data</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/analyzing_tdl_data.html">Analyzing TDL Data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>GENERAL PHOTOGEA ADVICE</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/web_only/combining_with_other_packages.html">Combining PhotoGEA With Other Packages</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/creating_your_own_processing_tools.html">Creating Your Own Processing Tools</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/developing_a_data_analysis_pipeline.html">Developing a Data Analysis Pipeline</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/working_with_extended_data_frames.html">Working With Extended Data Frames</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/frequent_questions.html">Frequently Asked Questions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>GENERAL GAS EXCHANGE ADVICE</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/web_only/LI6800_user_constants.html">Guide to Licor LI-6800 User Constants</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/web_only/publications.html">Publications</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/eloch216/PhotoGEA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Calculate C4 assimilation rates using a hyperbola</h1>

      <div class="d-none name"><code>calculate_c4_assimilation_hyperbola.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates C4 assimilation rates based on an empirical hyperbolic model. This
  function can accomodate alternative colum names for the variables taken from
  Licor files in case they change at some point in the future. This function
  also checks the units of each required column and will produce an error if any
  units are incorrect.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calculate_c4_assimilation_hyperbola</span><span class="op">(</span></span>
<span>    <span class="va">exdf_obj</span>,</span>
<span>    <span class="va">c4_curvature</span>,</span>
<span>    <span class="va">c4_slope</span>,</span>
<span>    <span class="va">rL</span>,</span>
<span>    <span class="va">Vmax</span>,</span>
<span>    ci_column_name <span class="op">=</span> <span class="st">'Ci'</span>,</span>
<span>    hard_constraints <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    perform_checks <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    return_exdf <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-exdf-obj">exdf_obj<a class="anchor" aria-label="anchor" href="#arg-exdf-obj"></a></dt>
<dd><p>An <code>exdf</code> object.</p></dd>


  <dt id="arg-c-curvature">c4_curvature<a class="anchor" aria-label="anchor" href="#arg-c-curvature"></a></dt>
<dd><p>The empirical curvature parameter of the hyperbola (<code>dimensionless</code>).
    If <code>c4_curvature</code> is not a number, then there must be a column in
    <code>exdf_obj</code> called <code>c4_curvature</code> with appropriate units. A numeric
    value supplied here will overwrite the values in the <code>c4_curvature</code>
    column of <code>exdf_obj</code> if it exists.</p></dd>


  <dt id="arg-c-slope">c4_slope<a class="anchor" aria-label="anchor" href="#arg-c-slope"></a></dt>
<dd><p>The empirical slope parameter of the hyperbola (<code>mol m^(-2) s^(-1)</code>).
    If <code>c4_slope</code> is not a number, then there must be a column in
    <code>exdf_obj</code> called <code>c4_slope</code> with appropriate units. A numeric
    value supplied here will overwrite the values in the <code>c4_slope</code>
    column of <code>exdf_obj</code> if it exists.</p></dd>


  <dt id="arg-rl">rL<a class="anchor" aria-label="anchor" href="#arg-rl"></a></dt>
<dd><p>The respiration rate, expressed in <code>micromol m^(-2) s^(-1)</code>. If
    <code>rL</code> is not a number, then there must be a column in <code>exdf_obj</code>
    called <code>rL</code> with appropriate units. A numeric value supplied here will
    overwrite the values in the <code>rL</code> column of <code>exdf_obj</code> if it
    exists.</p></dd>


  <dt id="arg-vmax">Vmax<a class="anchor" aria-label="anchor" href="#arg-vmax"></a></dt>
<dd><p>The maximum gross assimilation rate, expressed in
    <code>micromol m^(-2) s^(-1)</code>. If <code>Vmax</code> is not a number, then there
    must be a column in <code>exdf_obj</code> called <code>Vmax</code> with appropriate
    units. A numeric value supplied here will overwrite the values in the
    <code>Vmax</code> column of <code>exdf_obj</code> if it exists.</p></dd>


  <dt id="arg-ci-column-name">ci_column_name<a class="anchor" aria-label="anchor" href="#arg-ci-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the intercellular
    CO2 concentration, expressed in <code>micromol mol^(-1)</code>.</p></dd>


  <dt id="arg-hard-constraints">hard_constraints<a class="anchor" aria-label="anchor" href="#arg-hard-constraints"></a></dt>
<dd><p>An integer numerical value indicating which types of hard constraints to
    place on the values of input parameters; see below for more details.</p></dd>


  <dt id="arg-perform-checks">perform_checks<a class="anchor" aria-label="anchor" href="#arg-perform-checks"></a></dt>
<dd><p>A logical value indicating whether to check units for the required columns.
    This should almost always be <code>TRUE</code>. The option to disable these checks
    is only intended to be used when <code><a href="fit_c4_aci_hyperbola.html">fit_c4_aci_hyperbola</a></code> calls
    this function, since performing these checks many times repeatedly slows
    down the fitting procedure.</p></dd>


  <dt id="arg-return-exdf">return_exdf<a class="anchor" aria-label="anchor" href="#arg-return-exdf"></a></dt>
<dd><p>A logical value indicating whether to return an <code>exdf</code> object. This
    should almost always be <code>TRUE</code>. The option to return a vector is mainly
    intended to be used when  <code><a href="fit_c4_aci_hyperbola.html">fit_c4_aci_hyperbola</a></code> calls this
    function, since creating an <code>exdf</code> object to return will slow down the
    fitting procedure.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>General Description of the Model</strong></p>
<p>In contrast to the mechanistic model implemented in
  <code><a href="calculate_c4_assimilation.html">calculate_c4_assimilation</a></code>, this is a simple empirical model for
  C4 assimilation based on a four-parameter hyperbola. In this model, the net
  CO2 assimilation rate (<code>An</code>) is given by</p>
<p><code>An = Ag - rL</code>,</p>
<p>where <code>Ag</code> is the gross assimilation rate and <code>rL</code> is the
  respiration rate. In turn, <code>Ag</code> is given by the smaller root of the
  following quadratic equation:</p>
<p><code>curvature * Ag^2 - (Vinitial + Vmax) * Ag + Vinitial * Vmax = 0</code>,</p>
<p>where 0 &lt;= <code>curvature</code> &lt;= 1 is an empirical curvature factor, <code>Vmax</code>
  is the maximum gross assimilation rate, and <code>Vinitial</code> represents the
  initial response of <code>Ag</code> to increases in the intercellular CO2
  concentration (<code>Ci</code>):</p>
<p><code>Vinitial = slope * Ci</code>.</p>
<p>Here the <code>slope</code> is another empirical factor.</p>
<p>By including the respiration offset, it is also possible to define two other
  quantities: the maximum net CO2 assimilation rate (<code>Amax</code>) and the
  initial net CO2 assimilation rate (<code>Ainitial</code>). These are given by</p>
<p><code>Amax = Vmax - rL</code></p>
<p>and</p>
<p><code>Ainitial = Vinitial - rL</code>.</p>
<p>Overall, this model exhibits a linear response of <code>An</code> to <code>Ci</code> at
  low <code>Ci</code>, a flat plateau of <code>An</code> at high <code>Ci</code>, and a smooth
  transition between these regions. The sharpess of the transition is set by the
  <code>curvature</code>. When <code>curvature = 1</code>, the model simplifies to</p>
<p><code>An = min{Vinitial, Vmax} - rL = min{Ainitial, Amax}</code>.</p>
<p>As the <code>curvature</code> increases to 1, the transition becomes smoother. When
  the <code>curvature</code> is not zero, <code>An</code> approaches <code>Amax</code>
  asymptotically, and may not reach <code>Amax</code> at a reasonable value of
  <code>Ci</code>.</p>
<p><strong>Code implementation</strong></p>
<p>In this function, <code>curvature</code> and <code>slope</code> above are referred to as
  <code>c4_curvature</code> and <code>c4_slope</code> to avoid any potential ambiguity with
  other models that may also have curvature and slope parameters.</p>
<p><strong>Temperature response</strong></p>
<p>Because this model does not represent any photosynthetic mechanisms,
  temperature response functions are not applied.</p>
<p><strong>Hard constraints</strong></p>
<p>Most input parameters to the this model have hard constraints on their values
  which are set by their interpretation; for example, <code>Vmax</code> cannot be
  negative and <code>c4_curvature</code> must lie between 0 and 1. Yet, because of
  measurement noise, sometimes it is necessary to use values outside these
  ranges when fitting an A-Ci curve with <code><a href="fit_c4_aci_hyperbola.html">fit_c4_aci_hyperbola</a></code>. To
  accomodate different potential use cases, it is possible to selectively apply
  these hard constraints by specifying different values of the
  <code>hard_constraints</code> input argument:</p>
<p></p><ul><li><p><code>hard_constraints = 0</code>: No constraints are applied.</p></li>
<li><p><code>hard_constraints = 1</code>: Checks whether all <code>Ci</code> values are
          non-negative.</p></li>
<li><p><code>hard_constraints = 2</code>: Includes the same constraints as when
          <code>hard_constraints</code> is 1, which additional constraints on the
          parameters that can be fitted. For example, <code>Vmax</code> must be
          non-negative and <code>c4_curvature</code> must lie between 0 and 1.</p></li>
</ul><p>If any input values violate any of the specified constraints, an error message
  will be thrown.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The return value depends on the value of <code>return_exdf</code>:</p><ul><li><p>If <code>return_exdf</code> is <code>TRUE</code>, the return value is an
          <code>exdf</code> object with the following columns: <code>Ag</code>,
          <code>Ainitial</code>, <code>Amax</code>, <code>An</code>, <code>c4_curvature</code>,
          <code>c4_slope</code>, <code>rL</code>, <code>Vinitial</code>, <code>Vmax</code>, and
          <code>c4_assimilation_hyperbola_msg</code>. Most of these are calculated as
          described above, while several are copies of the input arguments with
          the same name. The <code>c4_assimilation_hyperbola_msg</code> is usually
          blank but may contain information about any issues with the inputs.
          The category for each of these new columns is
          <code>calculate_c4_assimilation_hyperbola</code> to indicate that they were
          created using this function.</p></li>
<li><p>If <code>return_exdf</code> is <code>FALSE</code>, the return value is a numeric
          vector containing the calculated values of <code>An</code>.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Simulate a C4 A-Ci curve and plot the net assimilation rate.</span></span></span>
<span class="r-in"><span><span class="va">npts</span> <span class="op">&lt;-</span> <span class="fl">101</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">inputs</span> <span class="op">&lt;-</span> <span class="fu"><a href="exdf.html">exdf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  Ci <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1000</span>, length.out <span class="op">=</span> <span class="va">npts</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  total_pressure <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">inputs</span> <span class="op">&lt;-</span> <span class="fu"><a href="document_variables.html">document_variables</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">inputs</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">''</span>, <span class="st">'Ci'</span>,             <span class="st">'micromol mol^(-1)'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">''</span>, <span class="st">'total_pressure'</span>, <span class="st">'bar'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">assim</span> <span class="op">&lt;-</span> <span class="fu">calculate_c4_assimilation_hyperbola</span><span class="op">(</span><span class="va">inputs</span>, <span class="fl">0.8</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">55</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">Ainitial</span> <span class="op">+</span> <span class="va">Amax</span> <span class="op">+</span> <span class="va">An</span> <span class="op">~</span> <span class="va">inputs</span><span class="op">[</span>, <span class="st">'Ci'</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">assim</span><span class="op">$</span><span class="va">main_data</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">'l'</span>,</span></span>
<span class="r-in"><span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">65</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ('</span>, <span class="va">inputs</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">')'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Net CO2 assimilation rate ('</span>, <span class="va">assim</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">An</span>, <span class="st">')'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="calculate_c4_assimilation_hyperbola-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward B. Lochocki, Coralie E. Salesse-Smith, Justin M. McGrath.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

