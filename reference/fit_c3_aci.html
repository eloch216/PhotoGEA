<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fits a C3 assimilation model to an A-Ci curve — fit_c3_aci • PhotoGEA</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fits a C3 assimilation model to an A-Ci curve — fit_c3_aci"><meta name="description" content="Fits the Farquhar-von-Caemmerer-Berry model to an experimentally measured C3
  A-Ci curve.
It is possible to fit the following parameters: alpha_g,
  alpha_old, alpha_s, alpha_t, Gamma_star_at_25,
  gmc_at_25, J_at_25, Kc_at_25, Ko_at_25,
  RL_at_25, Tp_at_25, and Vcmax_at_25.
By default, only a subset of these parameters are actually fit:
  alpha_old, J_at_25, RL_at_25, Tp_at_25, and
  Vcmax_at_25. This can be altered using the fit_options argument,
  as described below.
Best-fit parameters are found using maximum likelihood fitting, where the
  optimizer (optim_fun) is used to minimize the error function (defined
  by error_function_c3_aci).
Once best-fit parameters are found, confidence intervals are calculated
  using confidence_intervals_c3_aci, and unreliable parameter
  estimates are removed.
For temperature-dependent parameters, best-fit values and confidence intervals
  are returned at 25 degrees C and at leaf temperature.
See below for more details."><meta property="og:description" content="Fits the Farquhar-von-Caemmerer-Berry model to an experimentally measured C3
  A-Ci curve.
It is possible to fit the following parameters: alpha_g,
  alpha_old, alpha_s, alpha_t, Gamma_star_at_25,
  gmc_at_25, J_at_25, Kc_at_25, Ko_at_25,
  RL_at_25, Tp_at_25, and Vcmax_at_25.
By default, only a subset of these parameters are actually fit:
  alpha_old, J_at_25, RL_at_25, Tp_at_25, and
  Vcmax_at_25. This can be altered using the fit_options argument,
  as described below.
Best-fit parameters are found using maximum likelihood fitting, where the
  optimizer (optim_fun) is used to minimize the error function (defined
  by error_function_c3_aci).
Once best-fit parameters are found, confidence intervals are calculated
  using confidence_intervals_c3_aci, and unreliable parameter
  estimates are removed.
For temperature-dependent parameters, best-fit values and confidence intervals
  are returned at 25 degrees C and at leaf temperature.
See below for more details."><meta property="og:image" content="https://eloch216.github.io/PhotoGEA/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    padding-top: 70px;

    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PhotoGEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/PhotoGEA.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-user-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">User Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-user-guides"><li><h6 class="dropdown-header" data-toc-skip>ANALYSIS GUIDES</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/analyzing_ball_berry_data.html">Analyzing Ball-Berry Data</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_c3_aci_curves.html">Analyzing C3 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_c4_aci_curves.html">Analyzing C4 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_gm_data.html">Analyzing Mesophyll Conductance Data</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_tdl_data.html">Analyzing TDL Data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>GENERAL PHOTOGEA ADVICE</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/combining_with_other_packages.html">Combining PhotoGEA With Other Packages</a></li>
    <li><a class="dropdown-item" href="../articles/creating_your_own_processing_tools.html">Creating Your Own Processing Tools</a></li>
    <li><a class="dropdown-item" href="../articles/developing_a_data_analysis_pipeline.html">Developing a Data Analysis Pipeline</a></li>
    <li><a class="dropdown-item" href="../articles/working_with_extended_data_frames.html">Working With Extended Data Frames</a></li>
    <li><a class="dropdown-item" href="../articles/frequent_questions.html">Frequently Asked Questions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>GENERAL GAS EXCHANGE ADVICE</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/LI6800_user_constants.html">Guide to Licor LI-6800 User Constants</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/publications.html">Publications</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/eloch216/PhotoGEA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Fits a C3 assimilation model to an A-Ci curve</h1>

      <div class="d-none name"><code>fit_c3_aci.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits the Farquhar-von-Caemmerer-Berry model to an experimentally measured C3
  A-Ci curve.</p>
<p>It is possible to fit the following parameters: <code>alpha_g</code>,
  <code>alpha_old</code>, <code>alpha_s</code>, <code>alpha_t</code>, <code>Gamma_star_at_25</code>,
  <code>gmc_at_25</code>, <code>J_at_25</code>, <code>Kc_at_25</code>, <code>Ko_at_25</code>,
  <code>RL_at_25</code>, <code>Tp_at_25</code>, and <code>Vcmax_at_25</code>.</p>
<p>By default, only a subset of these parameters are actually fit:
  <code>alpha_old</code>, <code>J_at_25</code>, <code>RL_at_25</code>, <code>Tp_at_25</code>, and
  <code>Vcmax_at_25</code>. This can be altered using the <code>fit_options</code> argument,
  as described below.</p>
<p>Best-fit parameters are found using maximum likelihood fitting, where the
  optimizer (<code>optim_fun</code>) is used to minimize the error function (defined
  by <code><a href="error_function_c3_aci.html">error_function_c3_aci</a></code>).</p>
<p>Once best-fit parameters are found, confidence intervals are calculated
  using <code><a href="confidence_intervals_c3_aci.html">confidence_intervals_c3_aci</a></code>, and unreliable parameter
  estimates are removed.</p>
<p>For temperature-dependent parameters, best-fit values and confidence intervals
  are returned at 25 degrees C and at leaf temperature.</p>
<p>See below for more details.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_c3_aci</span><span class="op">(</span></span>
<span>    <span class="va">replicate_exdf</span>,</span>
<span>    Ca_atmospheric <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    a_column_name <span class="op">=</span> <span class="st">'A'</span>,</span>
<span>    ca_column_name <span class="op">=</span> <span class="st">'Ca'</span>,</span>
<span>    ci_column_name <span class="op">=</span> <span class="st">'Ci'</span>,</span>
<span>    gamma_star_norm_column_name <span class="op">=</span> <span class="st">'Gamma_star_norm'</span>,</span>
<span>    gmc_norm_column_name <span class="op">=</span> <span class="st">'gmc_norm'</span>,</span>
<span>    j_norm_column_name <span class="op">=</span> <span class="st">'J_norm'</span>,</span>
<span>    kc_norm_column_name <span class="op">=</span> <span class="st">'Kc_norm'</span>,</span>
<span>    ko_norm_column_name <span class="op">=</span> <span class="st">'Ko_norm'</span>,</span>
<span>    oxygen_column_name <span class="op">=</span> <span class="st">'oxygen'</span>,</span>
<span>    rl_norm_column_name <span class="op">=</span> <span class="st">'RL_norm'</span>,</span>
<span>    total_pressure_column_name <span class="op">=</span> <span class="st">'total_pressure'</span>,</span>
<span>    tp_norm_column_name <span class="op">=</span> <span class="st">'Tp_norm'</span>,</span>
<span>    vcmax_norm_column_name <span class="op">=</span> <span class="st">'Vcmax_norm'</span>,</span>
<span>    sd_A <span class="op">=</span> <span class="st">'RMSE'</span>,</span>
<span>    Wj_coef_C <span class="op">=</span> <span class="fl">4.0</span>,</span>
<span>    Wj_coef_Gamma_star <span class="op">=</span> <span class="fl">8.0</span>,</span>
<span>    optim_fun <span class="op">=</span> <span class="fu"><a href="optimizers.html">optimizer_deoptim</a></span><span class="op">(</span><span class="fl">200</span><span class="op">)</span>,</span>
<span>    lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    fit_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    cj_crossover_min <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    cj_crossover_max <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    relative_likelihood_threshold <span class="op">=</span> <span class="fl">0.147</span>,</span>
<span>    hard_constraints <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    calculate_confidence_intervals <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    remove_unreliable_param <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    <span class="va">...</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-replicate-exdf">replicate_exdf<a class="anchor" aria-label="anchor" href="#arg-replicate-exdf"></a></dt>
<dd><p>An <code>exdf</code> object representing one CO2 response curve.</p></dd>


  <dt id="arg-ca-atmospheric">Ca_atmospheric<a class="anchor" aria-label="anchor" href="#arg-ca-atmospheric"></a></dt>
<dd><p>The atmospheric CO2 concentration (with units of <code>micromol mol^(-1)</code>);
    this will be used by <code><a href="estimate_operating_point.html">estimate_operating_point</a></code> to estimate the
    operating point. A value of <code>NA</code> disables this feature.</p></dd>


  <dt id="arg-a-column-name">a_column_name<a class="anchor" aria-label="anchor" href="#arg-a-column-name"></a></dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the net
    assimilation in <code>micromol m^(-2) s^(-1)</code>.</p></dd>


  <dt id="arg-ca-column-name">ca_column_name<a class="anchor" aria-label="anchor" href="#arg-ca-column-name"></a></dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the
    ambient CO2 concentration in <code>micromol mol^(-1)</code>.</p></dd>


  <dt id="arg-ci-column-name">ci_column_name<a class="anchor" aria-label="anchor" href="#arg-ci-column-name"></a></dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the
    intercellular CO2 concentration in <code>micromol mol^(-1)</code>.</p></dd>


  <dt id="arg-gamma-star-norm-column-name">gamma_star_norm_column_name<a class="anchor" aria-label="anchor" href="#arg-gamma-star-norm-column-name"></a></dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the normalized
    <code>Gamma_star</code> values (with units of
    <code>normalized to Gamma_star at 25 degrees C</code>).</p></dd>


  <dt id="arg-gmc-norm-column-name">gmc_norm_column_name<a class="anchor" aria-label="anchor" href="#arg-gmc-norm-column-name"></a></dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the normalized
    mesophyll conductance values (with units of
    <code>normalized to gmc at 25 degrees C</code>).</p></dd>


  <dt id="arg-j-norm-column-name">j_norm_column_name<a class="anchor" aria-label="anchor" href="#arg-j-norm-column-name"></a></dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the normalized
    <code>J</code> values (with units of <code>normalized to J at 25 degrees C</code>).</p></dd>


  <dt id="arg-kc-norm-column-name">kc_norm_column_name<a class="anchor" aria-label="anchor" href="#arg-kc-norm-column-name"></a></dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the normalized
    <code>Kc</code> values (with units of <code>normalized to Kc at 25 degrees C</code>).</p></dd>


  <dt id="arg-ko-norm-column-name">ko_norm_column_name<a class="anchor" aria-label="anchor" href="#arg-ko-norm-column-name"></a></dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the normalized
    <code>Ko</code> values (with units of <code>normalized to Ko at 25 degrees C</code>).</p></dd>


  <dt id="arg-oxygen-column-name">oxygen_column_name<a class="anchor" aria-label="anchor" href="#arg-oxygen-column-name"></a></dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the
    concentration of O2 in the ambient air, expressed as a percentage (commonly
    21% or 2%); the units must be <code>percent</code>.</p></dd>


  <dt id="arg-rl-norm-column-name">rl_norm_column_name<a class="anchor" aria-label="anchor" href="#arg-rl-norm-column-name"></a></dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the normalized
    <code>RL</code> values (with units of <code>normalized to RL at 25 degrees C</code>).</p></dd>


  <dt id="arg-total-pressure-column-name">total_pressure_column_name<a class="anchor" aria-label="anchor" href="#arg-total-pressure-column-name"></a></dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the total
    pressure in <code>bar</code>.</p></dd>


  <dt id="arg-tp-norm-column-name">tp_norm_column_name<a class="anchor" aria-label="anchor" href="#arg-tp-norm-column-name"></a></dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the normalized
    <code>Tp</code> values (with units of <code>normalized to Tp at 25 degrees C</code>).</p></dd>


  <dt id="arg-vcmax-norm-column-name">vcmax_norm_column_name<a class="anchor" aria-label="anchor" href="#arg-vcmax-norm-column-name"></a></dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the normalized
    <code>Vcmax</code> values (with units of
    <code>normalized to Vcmax at 25 degrees C</code>).</p></dd>


  <dt id="arg-sd-a">sd_A<a class="anchor" aria-label="anchor" href="#arg-sd-a"></a></dt>
<dd><p>A value of the standard deviation of measured <code>A</code> values, or the name
    of a method for determining the deviation; currently, the only supported
    option is <code>'RMSE'</code>.</p></dd>


  <dt id="arg-wj-coef-c">Wj_coef_C<a class="anchor" aria-label="anchor" href="#arg-wj-coef-c"></a></dt>
<dd><p>A coefficient in the equation for RuBP-regeneration-limited carboxylation,
    whose value depends on assumptions about the NADPH and ATP requirements of
    RuBP regeneration; see <code><a href="calculate_c3_assimilation.html">calculate_c3_assimilation</a></code> for more
    information.</p></dd>


  <dt id="arg-wj-coef-gamma-star">Wj_coef_Gamma_star<a class="anchor" aria-label="anchor" href="#arg-wj-coef-gamma-star"></a></dt>
<dd><p>A coefficient in the equation for RuBP-regeneration-limited carboxylation,
    whose value depends on assumptions about the NADPH and ATP requirements of
    RuBP regeneration; see <code><a href="calculate_c3_assimilation.html">calculate_c3_assimilation</a></code> for more
    information.</p></dd>


  <dt id="arg-optim-fun">optim_fun<a class="anchor" aria-label="anchor" href="#arg-optim-fun"></a></dt>
<dd><p>An optimization function that accepts the following input arguments: an
    initial guess, an error function, lower bounds, and upper bounds. It should
    return a list with the following elements: <code>par</code>, <code>convergence</code>,
    <code>feval</code>, and <code>convergence_msg</code>. See <code><a href="optimizers.html">optimizers</a></code> for a
    list of available options.</p></dd>


  <dt id="arg-lower">lower<a class="anchor" aria-label="anchor" href="#arg-lower"></a></dt>
<dd><p>A list of named numeric elements representing lower bounds to use when
    fitting. Values supplied here override the default values (see details
    below). For example, <code>lower = list(Vcmax_at_25 = 10)</code> sets the lower
    limit for <code>Vcmax_at_25</code> to 10 micromol / m^2 / s.</p></dd>


  <dt id="arg-upper">upper<a class="anchor" aria-label="anchor" href="#arg-upper"></a></dt>
<dd><p>A list of named numeric elements representing upper bounds to use when
    fitting. Values supplied here override the default values (see details
    below). For example, <code>upper = list(Vcmax_at_25 = 200)</code> sets the upper
    limit for <code>Vcmax_at_25</code> to 200 micromol / m^2 / s.</p></dd>


  <dt id="arg-fit-options">fit_options<a class="anchor" aria-label="anchor" href="#arg-fit-options"></a></dt>
<dd><p>A list of named elements representing fit options to use for each parameter.
    Values supplied here override the default values (see details below). Each
    element must be <code>'fit'</code>, <code>'column'</code>, or a numeric value. A value
    of <code>'fit'</code> means that the parameter will be fit; a value of
    <code>'column'</code> means that the value of the parameter will be taken from a
    column in <code>replicate_exdf</code> of the same name; and a numeric value means
    that the parameter will be set to that value. For example,
    <code>fit_options = list(alpha_g = 0, Vcmax_at_25 = 'fit', Tp_at_25 = 'column')</code>
    means that <code>alpha_g</code> will be set to 0, <code>Vcmax_at_25</code> will be fit,
    and <code>Tp_at_25</code> will be set to the values in the <code>Tp_at_25</code> column
    of <code>replicate_exdf</code>.</p></dd>


  <dt id="arg-cj-crossover-min">cj_crossover_min<a class="anchor" aria-label="anchor" href="#arg-cj-crossover-min"></a></dt>
<dd><p>The minimum value of <code>Cc</code> (in ppm) where <code>Aj</code> is allowed to become
    the overall rate-limiting factor. If <code>cj_crossover_min</code> is set to
    <code>NA</code>, this restriction will not be applied.</p></dd>


  <dt id="arg-cj-crossover-max">cj_crossover_max<a class="anchor" aria-label="anchor" href="#arg-cj-crossover-max"></a></dt>
<dd><p>The maximim value of <code>Cc</code> (in ppm) where <code>Wj</code> is allowed to be
    smaller than <code>Wc</code>. If <code>cj_crossover_max</code> is set to <code>NA</code>, this
    restriction will not be applied.</p></dd>


  <dt id="arg-relative-likelihood-threshold">relative_likelihood_threshold<a class="anchor" aria-label="anchor" href="#arg-relative-likelihood-threshold"></a></dt>
<dd><p>To be passed to <code><a href="confidence_intervals_c3_aci.html">confidence_intervals_c3_aci</a></code> when
    <code>calculate_confidence_intervals</code> is <code>TRUE</code>.</p></dd>


  <dt id="arg-hard-constraints">hard_constraints<a class="anchor" aria-label="anchor" href="#arg-hard-constraints"></a></dt>
<dd><p>To be passed to <code><a href="calculate_c3_assimilation.html">calculate_c3_assimilation</a></code>; see that function
    for more details.</p></dd>


  <dt id="arg-calculate-confidence-intervals">calculate_confidence_intervals<a class="anchor" aria-label="anchor" href="#arg-calculate-confidence-intervals"></a></dt>
<dd><p>A logical value indicating whether or not to estimate confidence intervals
    for the fitting parameters using <code><a href="confidence_intervals_c3_aci.html">confidence_intervals_c3_aci</a></code>.</p></dd>


  <dt id="arg-remove-unreliable-param">remove_unreliable_param<a class="anchor" aria-label="anchor" href="#arg-remove-unreliable-param"></a></dt>
<dd><p>An integer value indicating the rules to use when identifying and removing
    unreliable parameter estimates. A value of 2 is the most conservative
    option. A value of 0 disables this feature, which is not typically
    recommended. See below for more details.</p></dd>


  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments to be passed to <code><a href="calculate_c3_assimilation.html">calculate_c3_assimilation</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function calls <code><a href="apply_gm.html">apply_gm</a></code> and
  <code><a href="calculate_c3_assimilation.html">calculate_c3_assimilation</a></code> to calculate values of net
  assimilation. The user-supplied optimization function is used to vary the
  values of <code>alpha_g</code>, <code>alpha_old</code>, <code>alpha_s</code>, <code>alpha_t</code>,
  <code>Gamma_star_at_25</code>, <code>gmc_at_25</code>, <code>J_at_25</code>, <code>Kc_at_25</code>,
  <code>Ko_at_25</code>, <code>RL_at_25</code>, <code>Tp_at_25</code>, and <code>Vcmax_at_25</code> to
  find ones that best reproduce the experimentally measured values of net
  assimilation. By default, the following options are used for the fits:</p><ul><li><p><code>alpha_g</code>: lower = 0, upper = 10, fit_option = 0</p></li>
<li><p><code>alpha_old</code>: lower = 0, upper = 10, fit_option = <code>'fit'</code></p></li>
<li><p><code>alpha_s</code>: lower = 0, upper = 10, fit_option = 0</p></li>
<li><p><code>alpha_t</code>: lower = 0, upper = 10, fit_option = 0</p></li>
<li><p><code>Gamma_star_at_25</code>: lower = -20, upper = 200, fit_option = <code>'column'</code></p></li>
<li><p><code>gmc_at_25</code>: lower = -1, upper = 10,  fit_option = <code>Inf</code></p></li>
<li><p><code>J_at_25</code>: lower = -50, upper = 1000, fit_option = <code>'fit'</code></p></li>
<li><p><code>Kc_at_25</code>: lower = -50, upper = 1000, fit_option = <code>'column'</code></p></li>
<li><p><code>Ko_at_25</code>: lower = -50, upper = 1000, fit_option = <code>'column'</code></p></li>
<li><p><code>RL_at_25</code>: lower = -10, upper = 100, fit_option = <code>'fit'</code></p></li>
<li><p><code>Tp_at_25</code>: lower = -10, upper = 100, fit_option = <code>'fit'</code></p></li>
<li><p><code>Vcmax_at_25</code>: lower = -50, upper = 1000, fit_option = <code>'fit'</code></p></li>
</ul><p>With these settings, the "new" <code>alpha</code> parameters are set to 0; values of
  <code>Gamma_star_at_25</code>, <code>Kc_at_25</code>, and <code>Ko_at_25</code> are taken from
  the <code>Gamma_star_at_25</code>, <code>Kc_at_25</code>, and <code>Ko_at_25</code> columns of
  <code>replicate_exdf</code>; mesophyll conductance (<code>gmc_at_25</code>) is set to
  inifinity (so <code>Cc = Ci</code>); and the other parameters are fit during the
  process (see <code>fit_options</code> above). The bounds are chosen liberally to
  avoid any bias.</p>
<p>An initial guess for the parameters is generated by calling
  <code><a href="initial_guess_c3_aci.html">initial_guess_c3_aci</a></code> as follows:</p><ul><li><p><code>cc_threshold_rd</code> is set to 100 micromol / mol.</p></li>
<li><p>If <code>alpha_g</code> is being fit, the <code>alpha_g</code> argument of
          <code>initial_guess_c3_aci</code> is set to 0.5; otherwise, the argument is
          set to the value specified by the fit options.</p></li>
<li><p>If <code>alpha_old</code> is being fit, the <code>alpha_old</code> argument of
          <code>initial_guess_c3_aci</code> is set to 0.5; otherwise, the argument is
          set to the value specified by the fit options.</p></li>
<li><p>if <code>alpha_s</code> is being fit, the <code>alpha_s</code> argument of
          <code>initial_guess_c3_aci</code> is set to <code>0.3 * (1 - alpha_g)</code>;
          otherwise, the argument is set to the value specified by the fit
          options.</p></li>
<li><p>if <code>alpha_t</code> is being fit, the <code>alpha_t</code> argument of
          <code>initial_guess_c3_aci</code> is set to 0; otherwise, the argument is
          set to the value specified by the fit options.</p></li>
<li><p>If <code>Gamma_star_at_25</code> is being fit, the <code>Gamma_star_at_25</code>
          argument of <code>initial_guess_c3_aci</code> is set to 40; otherwise, the
          argument is set to the value specified by the fit options.</p></li>
<li><p>If <code>gmc_at_25</code> is being fit, the <code>gmc_at_25</code> argument of
          <code>initial_guess_c3_aci</code> is set to 1; otherwise, the argument is
          set to the value specified by the fit options.</p></li>
<li><p>If <code>Kc_at_25</code> is being fit, the <code>Kc_at_25</code> argument of
          <code>initial_guess_c3_aci</code> is set to 400; otherwise, the
          argument is set to the value specified by the fit options.</p></li>
<li><p>If <code>Ko_at_25</code> is being fit, the <code>Ko_at_25</code> argument of
          <code>initial_guess_c3_aci</code> is set to 275; otherwise, the
          argument is set to the value specified by the fit options.</p></li>
</ul><p>Note that any fixed values specified in the fit options will override the
  values returned by the guessing function.</p>
<p>The fit is made by creating an error function using
  <code><a href="error_function_c3_aci.html">error_function_c3_aci</a></code> and minimizing its value using
  <code>optim_fun</code>, starting from the initial guess described above.  The
  <code><a href="optimizers.html">optimizer_deoptim</a></code> optimizer is used by default since it has been
  found to reliably return great fits. However, it is a slow optimizer. If speed
  is important, consider reducing the number of generations or using
  <code><a href="optimizers.html">optimizer_nmkb</a></code>, but be aware that this optimizer is more likely
  to get stuck in a local minimum.</p>
<p>The photosynthesis model represented by <code>calculate_c3_assimilation</code> is
  not smooth in the sense that small changes in the input parameters do not
  necessarily cause changes in its outputs. This is related to the final step in
  the calculations, where the overall assimilation rate is taken to be the
  minimum of three enzyme-limited rates. For example, if the assimilation rate
  is never TPU-limited, modifying <code>Tp_at_25</code> will not change the model's
  outputs. For this reason, derivative-based optimizers tend to struggle when
  fitting C3 A-Ci curves. Best results are obtained using derivative-free
  methods.</p>
<p>Sometimes the optimizer may choose a set of parameter values where one or more
  of the potential limiting carboxylation rates (<code>Wc</code>, <code>Wj</code>, or
  <code>Wp</code>) is never the smallest rate. In this case, the corresponding
  parameter estimates (<code>Vcmax</code>, <code>J</code>, or <code>alpha_old</code> &amp; <code>Tp</code>)
  will be severely unreliable. This will be indicated by a value of <code>0</code> in
  the corresponding trust column(for example, <code>Vcmax_trust</code>). If
  <code>remove_unreliable_param</code> is <code>1</code> or larger, then such parameter
  estimates (and the corresponding rates) will be replaced by <code>NA</code> in the
  fitting results.</p>
<p>It is also possible that the upper limit of the confidence interval for a
  parameter is infinity; this indicates a potentially unreliable parameter
  estimate. This will be indicated by a value of <code>1</code> in the corresponding
  trust column (for example, <code>Vcmax_trust</code>). If
  <code>remove_unreliable_param</code> is <code>2</code> or larger, then such parameter
  estimates (but not the corresponding rates) will be replaced by <code>NA</code> in
  the fitting results.</p>
<p>The trust value for fully reliable parameter estimates is set to <code>2</code> and
  they will never be replaced by <code>NA</code>.</p>
<p>Once the best-fit parameters have been determined, this function also
  estimates the operating value of <code>Cc</code> from the atmospheric CO2
  concentration <code>atmospheric_ca</code> using
  <code><a href="estimate_operating_point.html">estimate_operating_point</a></code>, and then uses that value to estimate
  the modeled <code>An</code> at the operating point via
  <code><a href="calculate_c3_assimilation.html">calculate_c3_assimilation</a></code>. It also estimates the
  <a href="https://en.wikipedia.org/wiki/Akaike_information_criterion" class="external-link">Akaike information criterion (AIC)</a>.</p>
<p>This function assumes that <code>replicate_exdf</code> represents a single
  C3 A-Ci curve. To fit multiple curves at once, this function is often used
  along with <code><a href="by.exdf.html">by.exdf</a></code> and <code><a href="consolidate.html">consolidate</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with three elements:</p><ul><li><p><code>fits</code>: An <code>exdf</code> object including the original contents of
          <code>replicate_exdf</code> along with several new columns:</p><ul><li><p>The fitted values of net assimilation will be stored in a
                  column whose name is determined by appending <code>'_fit'</code> to
                  the end of <code>a_column_name</code>; typically, this will be
                  <code>'A_fit'</code>.</p></li>
<li><p>Residuals (measured - fitted) will be stored in a column whose
                  name is determined by appending <code>'_residuals'</code> to the end
                  of <code>a_column_name</code>; typically, this will be
                  <code>'A_residuals'</code>.</p></li>
<li><p>Values of fitting parameters at 25 degrees C will be stored in
                  the <code>Gamma_star_at_25</code>, <code>gmc_at_25</code>, <code>J_at_25</code>,
                  <code>Kc_at_25</code>, <code>Ko_at_25</code>, <code>RL_at_25</code>,
                  <code>Tp_at_25</code>, and <code>Vcmax_at_25</code> columns.</p></li>
<li><p>The other outputs from <code><a href="calculate_c3_assimilation.html">calculate_c3_assimilation</a></code>
                  will be stored in columns with the usual names:
                  <code>alpha_g</code>, <code>alpha_old</code>, <code>alpha_s</code>,
                  <code>alpha_t</code>, <code>Gamma_star_tl</code>, <code>gmc_tl</code>,
                  <code>Kc_tl</code>, <code>Ko_tl</code>, <code>Tp_tl</code>, <code>Vcmax_tl</code>,
                  <code>RL_tl</code>, <code>J_tl</code>, <code>Wc</code>, <code>Wj</code>, <code>Wp</code>,
                  <code>Vc</code>, <code>Ac</code>, <code>Aj</code>, and <code>Ap</code>.</p></li>
</ul></li>
<li><p><code>fits_interpolated</code>: An <code>exdf</code> object including the
          calculated assimilation rates at a fine spacing of <code>Ci</code> values
          (step size of 1 <code>micromol mol^(-1)</code>).</p></li>
<li><p><code>parameters</code>: An <code>exdf</code> object including the identifiers,
          fitting parameters, and convergence information for the A-Ci curve:</p><ul><li><p>The number of points where <code>An = Ac</code>, <code>An = Aj</code>, and
                  <code>An = Ap</code> are stored in the <code>n_Ac_limiting</code>,
                  <code>n_Aj_limiting</code>, and <code>n_Ap_limiting</code> columns.</p></li>
<li><p>The best-fit values are stored in the <code>alpha_g</code>,
                  <code>alpha_old</code>, <code>alpha_s</code>, <code>alpha_t</code>,
                  <code>Gamma_star_at_25</code>, <code>gmc_at_25</code>, <code>J_at_25</code>,
                  <code>Kc_at_25</code>, <code>Ko_at_25</code>, <code>RL_at_25</code>,
                  <code>Tp_at_25</code>, and <code>Vcmax_at_25</code> columns. If
                  <code>calculate_confidence_intervals</code> is <code>TRUE</code>, upper
                  and lower limits for each of these parameters will also be
                  included.</p></li>
<li><p>For parameters that depend on leaf temperature, the average
                  leaf-temperature-dependent values are stored in
                  <code>Gamma_star_tl_avg</code>, <code>gmc_tl_avg</code>, <code>J_tl_avg</code>,
                  <code>Kc_tl_avg</code>, <code>Ko_tl_avg</code>, <code>RL_tl_avg</code>,
                  <code>Tp_tl_avg</code>, and <code>Vcmax_tl_avg</code>.</p></li>
<li><p>Information about the operating point is stored in
                  <code>operating_Cc</code>, <code>operating_Ci</code>, <code>operating_An</code>,
                  and <code>operating_An_model</code>.</p></li>
<li><p>The <code>convergence</code> column indicates whether the fit was
                  successful (<code>==0</code>) or if the optimizer encountered a
                  problem (<code>!=0</code>).</p></li>
<li><p>The <code>feval</code> column indicates how many cost function
                  evaluations were required while finding the optimal parameter
                  values.</p></li>
<li><p>The residual stats as returned by <code><a href="residual_stats.html">residual_stats</a></code>
                  are included as columns with the default names: <code>dof</code>,
                  <code>RSS</code>, <code>RMSE</code>, etc.</p></li>
<li><p>The Akaike information criterion is included in the <code>AIC</code>
                  column.</p></li>
</ul></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Read an example Licor file included in the PhotoGEA package</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_gasex_file.html">read_gasex_file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="PhotoGEA_example_file_path.html">PhotoGEA_example_file_path</a></span><span class="op">(</span><span class="st">'c3_aci_1.xlsx'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define a new column that uniquely identifies each curve</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species_plot'</span><span class="op">]</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species'</span><span class="op">]</span>, <span class="st">'-'</span>, <span class="va">licor_file</span><span class="op">[</span>, <span class="st">'plot'</span><span class="op">]</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Organize the data</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="organize_response_curve_data.html">organize_response_curve_data</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">licor_file</span>,</span></span>
<span class="r-in"><span>    <span class="st">'species_plot'</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">'CO2_r_sp'</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate the total pressure in the Licor chamber</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_total_pressure.html">calculate_total_pressure</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate temperature-dependent values of C3 photosynthetic parameters</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_temperature_response.html">calculate_temperature_response</a></span><span class="op">(</span><span class="va">licor_file</span>, <span class="va">c3_temperature_param_bernacchi</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># For these examples, we will use a faster (but sometimes less reliable)</span></span></span>
<span class="r-in"><span><span class="co"># optimizer so they run faster</span></span></span>
<span class="r-in"><span><span class="va">optimizer</span> <span class="op">&lt;-</span> <span class="fu"><a href="optimizers.html">optimizer_nmkb</a></span><span class="op">(</span><span class="fl">1e-7</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We can fit just one curve from the data set, although it is rare to do this</span></span></span>
<span class="r-in"><span><span class="va">one_result</span> <span class="op">&lt;-</span> <span class="fu">fit_c3_aci</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">licor_file</span><span class="op">[</span><span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species_plot'</span><span class="op">]</span> <span class="op">==</span> <span class="st">'tobacco - 1'</span>, , <span class="cn">TRUE</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  Ca_atmospheric <span class="op">=</span> <span class="fl">420</span>,</span></span>
<span class="r-in"><span>  optim_fun <span class="op">=</span> <span class="va">optimizer</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We can fit the same curve, but allow alpha_old and Gamma_star_at_25 to vary</span></span></span>
<span class="r-in"><span><span class="va">one_result_v2</span> <span class="op">&lt;-</span> <span class="fu">fit_c3_aci</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">licor_file</span><span class="op">[</span><span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species_plot'</span><span class="op">]</span> <span class="op">==</span> <span class="st">'tobacco - 1'</span>, , <span class="cn">TRUE</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  Ca_atmospheric <span class="op">=</span> <span class="fl">420</span>,</span></span>
<span class="r-in"><span>  fit_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Gamma_star_at_25 <span class="op">=</span> <span class="st">'fit'</span>, alpha_old <span class="op">=</span> <span class="st">'fit'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  optim_fun <span class="op">=</span> <span class="va">optimizer</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit all curves in the data set (it is more common to do this)</span></span></span>
<span class="r-in"><span><span class="va">aci_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="consolidate.html">consolidate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">licor_file</span>,</span></span>
<span class="r-in"><span>  <span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species_plot'</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  <span class="va">fit_c3_aci</span>,</span></span>
<span class="r-in"><span>  Ca_atmospheric <span class="op">=</span> <span class="fl">420</span>,</span></span>
<span class="r-in"><span>  optim_fun <span class="op">=</span> <span class="va">optimizer</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View the fitting parameters for each species / plot</span></span></span>
<span class="r-in"><span><span class="va">col_to_keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">'species'</span>, <span class="st">'plot'</span>,                                       <span class="co"># identifiers</span></span></span>
<span class="r-in"><span>  <span class="st">'n_Ac_limiting'</span>, <span class="st">'n_Aj_limiting'</span>, <span class="st">'n_Ap_limiting'</span>,       <span class="co"># number of points where</span></span></span>
<span class="r-in"><span>                                                           <span class="co">#   each process is limiting</span></span></span>
<span class="r-in"><span>  <span class="st">'Tp_at_25'</span>, <span class="st">'J_at_25'</span>, <span class="st">'RL_at_25'</span>, <span class="st">'Vcmax_at_25'</span>,        <span class="co"># parameters scaled to 25 degrees C</span></span></span>
<span class="r-in"><span>  <span class="st">'J_tl_avg'</span>, <span class="st">'RL_tl_avg'</span>, <span class="st">'Vcmax_tl_avg'</span>,                 <span class="co"># average temperature-dependent values</span></span></span>
<span class="r-in"><span>  <span class="st">'operating_Ci'</span>, <span class="st">'operating_An'</span>, <span class="st">'operating_An_model'</span>,    <span class="co"># operating point info</span></span></span>
<span class="r-in"><span>  <span class="st">'dof'</span>, <span class="st">'RSS'</span>, <span class="st">'MSE'</span>, <span class="st">'RMSE'</span>, <span class="st">'RSE'</span>,                      <span class="co"># residual stats</span></span></span>
<span class="r-in"><span>  <span class="st">'convergence'</span>, <span class="st">'convergence_msg'</span>, <span class="st">'feval'</span>, <span class="st">'optimum_val'</span> <span class="co"># convergence info</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">aci_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span> , <span class="va">col_to_keep</span>, <span class="cn">TRUE</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Converting an `exdf` object to a `data.frame` before printing</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   species [UserDefCon] (NA) plot [UserDefCon] (NA)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                   soybean                     5a</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                   tobacco                      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                   tobacco                      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   n_Ac_limiting [identify_c3_unreliable_points] ()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                                8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                                8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                                9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   n_Aj_limiting [identify_c3_unreliable_points] ()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                                5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                                5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                                4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   n_Ap_limiting [identify_c3_unreliable_points] ()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                                0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                                0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                                0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Tp_at_25 [fit_c3_aci] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                             NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                             NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                             NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   J_at_25 [fit_c3_aci] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                      190.8859</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                      231.7749</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                      206.4820</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   RL_at_25 [fit_c3_aci] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                      0.5770711</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                      0.8490820</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                      0.3815406</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Vcmax_at_25 [fit_c3_aci] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                          144.5530</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                          157.7597</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                          124.2033</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   J_tl_avg [fit_c3_aci] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                       268.1496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                       319.2523</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                       285.9199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   RL_tl_avg [fit_c3_aci] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                       0.8149562</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                       1.1742260</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                       0.5306255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Vcmax_tl_avg [fit_c3_aci] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                           232.0402</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                           245.8747</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                           195.1092</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   operating_Ci [estimate_operating_point] (micromol mol^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                                    264.3297</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                                    294.7032</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                                    301.2673</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   operating_An [estimate_operating_point] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                                         31.00316</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                                         37.51608</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                                         31.57904</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   operating_An_model [fit_c3_aci] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                                 33.29502</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                                 40.46328</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                                 33.05702</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   dof [residual_stats] (NA) RSS [residual_stats] ((micromol m^(-2) s^(-1))^2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                         8                                         149.01920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                         8                                          53.22941</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                         8                                          49.78449</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   MSE [residual_stats] ((micromol m^(-2) s^(-1))^2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                         11.463015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                          4.094570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                          3.829576</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   RMSE [residual_stats] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                       3.385707</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                       2.023504</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                       1.956930</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   RSE [residual_stats] (micromol m^(-2) s^(-1)) convergence [fit_c3_aci] ()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                      4.315947                           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                      2.579472                           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                      2.494606                           0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   convergence_msg [fit_c3_aci] () feval [fit_c3_aci] ()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          Successful convergence                   243</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          Successful convergence                   214</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          Successful convergence                   218</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   optimum_val [fit_c3_aci] ()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                    34.30052</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                    27.60900</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                    27.17410</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View the fits for each species / plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_c3_aci_fit.html">plot_c3_aci_fit</a></span><span class="op">(</span><span class="va">aci_results</span>, <span class="st">'species_plot'</span>, <span class="st">'Ci'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fit_c3_aci-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View the residuals for each species / plot</span></span></span>
<span class="r-in"><span><span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">A_residuals</span> <span class="op">~</span> <span class="va">Ci</span> <span class="op">|</span> <span class="va">species_plot</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">aci_results</span><span class="op">$</span><span class="va">fits</span><span class="op">$</span><span class="va">main_data</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">'b'</span>,</span></span>
<span class="r-in"><span>  pch <span class="op">=</span> <span class="fl">16</span>,</span></span>
<span class="r-in"><span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ('</span>, <span class="va">aci_results</span><span class="op">$</span><span class="va">fits</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">')'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Assimilation rate residuals ('</span>, <span class="va">aci_results</span><span class="op">$</span><span class="va">fits</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">A_residuals</span>, <span class="st">')'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fit_c3_aci-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># In some of the curves above, there are no points where carboxylation is TPU</span></span></span>
<span class="r-in"><span><span class="co"># limited. Estimates of Tp are therefore unreliable and are removed.</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward B. Lochocki, Coralie E. Salesse-Smith, Justin M. McGrath.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

