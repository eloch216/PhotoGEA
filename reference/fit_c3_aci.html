<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Calculates a linear fit of stomatal conductance vs. the Ball-Berry index using
  the data in the exdf object. This function can accomodate alternative
  column names for the variables taken from the Licor file in case they change
  at some point in the future. This function also checks the units of each
  required column and will produce an error if any units are incorrect.
Fits a model to an experimentally measured CO2 response curve using the data
  in the exdf object along with a few other user-supplied parameters.
  This function can accomodate alternative column names for the variables taken
  from the Licor file in case they change at some point in the future. This
  function also checks the units of each required column and will produce an
  error if any units are incorrect."><title>fit_c3_aci — fit_c3_aci • PhotoGEA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="fit_c3_aci — fit_c3_aci"><meta property="og:description" content="Calculates a linear fit of stomatal conductance vs. the Ball-Berry index using
  the data in the exdf object. This function can accomodate alternative
  column names for the variables taken from the Licor file in case they change
  at some point in the future. This function also checks the units of each
  required column and will produce an error if any units are incorrect.
Fits a model to an experimentally measured CO2 response curve using the data
  in the exdf object along with a few other user-supplied parameters.
  This function can accomodate alternative column names for the variables taken
  from the Licor file in case they change at some point in the future. This
  function also checks the units of each required column and will produce an
  error if any units are incorrect."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    padding-top: 70px;

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PhotoGEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/PhotoGEA.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/analyzing_ball_berry_data.html">Analyzing Ball-Berry Data</a>
    <a class="dropdown-item" href="../articles/analyzing_c3_aci_curves.html">Analyzing C3 A-Ci Curves</a>
    <a class="dropdown-item" href="../articles/analyzing_tdl_data.html">Analyzing TDL Data</a>
    <a class="dropdown-item" href="../articles/developing_a_data_analysis_pipeline.html">Developing a Data Analysis Pipeline</a>
    <a class="dropdown-item" href="../articles/working_with_extended_data_frames.html">Working With Extended Data Frames</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/eloch216/PhotoGEA/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>fit_c3_aci</h1>
      
      <div class="d-none name"><code>fit_c3_aci.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates a linear fit of stomatal conductance vs. the Ball-Berry index using
  the data in the <code>exdf</code> object. This function can accomodate alternative
  column names for the variables taken from the Licor file in case they change
  at some point in the future. This function also checks the units of each
  required column and will produce an error if any units are incorrect.</p>
<p>Fits a model to an experimentally measured CO2 response curve using the data
  in the <code>exdf</code> object along with a few other user-supplied parameters.
  This function can accomodate alternative column names for the variables taken
  from the Licor file in case they change at some point in the future. This
  function also checks the units of each required column and will produce an
  error if any units are incorrect.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_c3_aci</span><span class="op">(</span></span>
<span>    <span class="va">replicate_exdf</span>,</span>
<span>    a_column_name <span class="op">=</span> <span class="st">'A'</span>,</span>
<span>    cc_column_name <span class="op">=</span> <span class="st">'Cc'</span>,</span>
<span>    pa_column_name <span class="op">=</span> <span class="st">'Pa'</span>,</span>
<span>    deltapcham_column_name <span class="op">=</span> <span class="st">'DeltaPcham'</span>,</span>
<span>    kc_column_name <span class="op">=</span> <span class="st">'Kc'</span>,</span>
<span>    ko_column_name <span class="op">=</span> <span class="st">'Ko'</span>,</span>
<span>    gamma_star_column_name <span class="op">=</span> <span class="st">'Gamma_star'</span>,</span>
<span>    vcmax_norm_column_name <span class="op">=</span> <span class="st">'Vcmax_norm'</span>,</span>
<span>    rd_norm_column_name <span class="op">=</span> <span class="st">'Rd_norm'</span>,</span>
<span>    j_norm_column_name <span class="op">=</span> <span class="st">'J_norm'</span>,</span>
<span>    POc <span class="op">=</span> <span class="fl">210000</span>,</span>
<span>    OPTIM_FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">guess</span>, <span class="va">fun</span>, <span class="va">lower</span>, <span class="va">upper</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu">dfoptim</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dfoptim/man/nmkb.html" class="external-link">nmkb</a></span><span class="op">(</span><span class="va">guess</span>, <span class="va">fun</span>, <span class="va">lower</span>, <span class="va">upper</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        tol <span class="op">=</span> <span class="fl">1e-7</span>,</span>
<span>        maxfeval <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>        restarts.max <span class="op">=</span> <span class="fl">10</span></span>
<span>      <span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    initial_guess <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">100</span>,  <span class="fl">0.5</span>, <span class="fl">90</span><span class="op">)</span>,</span>
<span>    lower <span class="op">=</span>         <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,  <span class="fl">0</span>,    <span class="fl">0</span>,   <span class="fl">0</span><span class="op">)</span>,</span>
<span>    upper <span class="op">=</span>         <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">1000</span>, <span class="fl">100</span>, <span class="fl">1000</span><span class="op">)</span>,</span>
<span>    min_aj_cutoff <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    max_aj_cutoff <span class="op">=</span> <span class="cn">NA</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>replicate_exdf</dt>
<dd><p>An <code>exdf</code> object representing one Ball-Berry curve.</p></dd>


  <dt>a_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the net
    assimilation in <code>micromol m^(-2) s^(-1)</code>.</p></dd>


  <dt>cc_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the
    chloroplastic CO2 concentration in <code>micromol mol^(-1)</code>.</p></dd>


  <dt>pa_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the
    atmospheric pressure in <code>kPa</code>.</p></dd>


  <dt>deltapcham_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the chamber
    overpressure in <code>kPa</code>.</p></dd>


  <dt>kc_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the
    Michaelis-Menten constant for rubisco carboxylation in
    <code>micromol mol^(-1)</code>.</p></dd>


  <dt>ko_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the
    Michaelis-Menten constant for rubisco oxygenation in
    <code>mmol mol^(-1)</code>.</p></dd>


  <dt>gamma_star_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the
    <code>Gamma_star</code> values in <code>micromol mol^(-1)</code>.</p></dd>


  <dt>vcmax_norm_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the normalized
    <code>Vcmax</code> values (with units of
    <code>normalized to Vcmax at 25 degrees C</code>).</p></dd>


  <dt>rd_norm_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the normalized
    <code>Rd</code> values (with units of <code>normalized to Rd at 25 degrees C</code>).</p></dd>


  <dt>j_norm_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the normalized
    <code>J</code> values (with units of <code>normalized to J at 25 degrees C</code>).</p></dd>


  <dt>POc</dt>
<dd><p>The partial pressure of O2 in the chloroplast, expressed in <code>microbar</code>.
    This is often assumed to be the ambient value. For air measurements, this
    would be 21 percent O2, which is about 210000 microbar at standard
    atmospheric pressure. For low oxygen measurements, this would be 2 percent
    O2, which is about 20000 microbar.</p></dd>


  <dt>OPTIM_FUN</dt>
<dd><p>An optimization function that accepts the following input arguments: an
    initial guess, an error function, lower bounds, and upper bounds. It should
    return a list with the following elements: <code>par</code>, <code>convergence</code>,
    <code>value</code>, and (optionally) <code>message</code>. The bounded optimizers from
    the <code>dfoptim</code> package meet these requirements. The base function
    <code>optim</code> with the <code>L-BFGS-B</code> method can also be used.</p></dd>


  <dt>initial_guess</dt>
<dd><p>A numeric vector containing initial guesses for the values of <code>TPU</code>,
    <code>J</code>, <code>Rd</code>, and <code>Vcmax</code>, in that order.</p></dd>


  <dt>lower</dt>
<dd><p>A numeric vector containing lower bounds for the values of <code>TPU</code>,
    <code>J</code>, <code>Rd</code>, and <code>Vcmax</code>, in that order.</p></dd>


  <dt>upper</dt>
<dd><p>A numeric vector containing upper bounds for the values of <code>TPU</code>,
    <code>J</code>, <code>Rd</code>, and <code>Vcmax</code>, in that order.</p></dd>


  <dt>min_aj_cutoff</dt>
<dd><p>The minimum value of <code>Cc</code> (in ppm) where <code>Aj</code> is allowed to become
    the overall rate-limiting factor. If <code>min_aj_cutoff</code> is set to
    <code>NA</code>, this restriction will not be applied.</p></dd>


  <dt>max_aj_cutoff</dt>
<dd><p>The maximum value of <code>Cc</code> (in ppm) where <code>Aj</code> is allowed to be
    smaller than <code>Ac</code>. If <code>max_aj_cutoff</code> is set to <code>NA</code>, this
    restriction will not be applied.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function calls <code><a href="calculate_c3_assimilation.html">calculate_c3_assimilation</a></code> to calculate
  values of net assimilation. The user-supplied optimization function is used to
  vary the values of <code>TPU</code>, <code>J</code>, <code>Rd</code>, and <code>Vcmax</code> to find
  ones that best reproduce the experimentally measured values of net
  assimilation.</p>
<p>The photosynthesis model represented by <code>calculate_c3_assimilation</code> is
  not smooth in the sense that small changes in the input parameters do not
  necessarily cause changes in its outputs. This is related to the final step in
  the calculations, where the overall assimilation rate is taken to be the
  minimum of three enzyme-limited rates. For example, if the assimilation rate
  is never phosphate-limited, modifying <code>TPU</code> will not change the model's
  outputs. For this reason, derivative-based optimizers tend to struggle when
  fitting C3 A-Ci curves. Best results are obtained using derivative-free
  methods. It has been found that <code><a href="https://rdrr.io/pkg/dfoptim/man/nmkb.html" class="external-link">dfoptim::nmkb</a></code> is often able to find a
  good fit.</p>
<p>Sometimes the optimizer will choose biologically unreasonable parameter values
  that nevertheless produce good fits to the supplied assimilation values. A
  common problem is that the fit result may not follow the expected progression
  of <code>Ac-limited -&gt; Aj-limited -&gt; Ap-limited</code> assimilation as <code>Cc</code>
  increases. In this case, the optional <code>min_aj_cutoff</code> and
  <code>max_aj_cutoff</code> can be used to constrain the range of <code>Cc</code> values
  (in ppm) where <code>Aj</code> is allowed to be the overall rate limiting factor.
  See the _Analyzing C3 A-Ci Curves_ vignette for an example of how these
  arguments can be used to improve the quality of a fit.</p>
<p>This function assumes that <code>replicate_exdf</code> represents a single
  C3 A-Ci curve. To fit multiple curves at once, this function is often used
  along with <code><a href="by.exdf.html">by.exdf</a></code> and <code><a href="consolidate.html">consolidate</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list with two elements:</p>
<p></p>
<ul><li><p><code>fits</code>: An <code>exdf</code> object including the measured values and
          the fitted values of net assimilation. The fitted values will be
          stored in a column whose name is determined by appending
          <code>'_fits'</code> to the end of <code>a_column_name</code>; typically, this
          will be <code>'A_fits'</code>.</p></li>
<li><p><code>parameters</code>: An <code>exdf</code> object including the fitting
          parameters and convergence information for each A-Ci curve. The
          best-fit values are stored in the <code>TPU</code>, <code>J_at_25</code>,
          <code>Rd_at_25</code>, and <code>Vcmax_at_25</code> columns. The
          <code>convergence</code> column indicates whether the fit was successful
          (<code>==0</code>) or if the optimizer encountered a problem (<code>!=0</code>).</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Read an example Licor file included in the PhotoGEA package</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_licor_file.html">read_licor_file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, <span class="st">'c3_aci_1.xlsx'</span>, package <span class="op">=</span> <span class="st">'PhotoGEA'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">11</span>, <span class="fl">13</span><span class="op">)</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="st">'time'</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define a new column that uniquely identifies each curve</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species_plot'</span><span class="op">]</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species'</span><span class="op">]</span>, <span class="st">'-'</span>, <span class="va">licor_file</span><span class="op">[</span>, <span class="st">'plot'</span><span class="op">]</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Organize the data</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="organize_response_curve_data.html">organize_response_curve_data</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">licor_file</span>,</span></span>
<span class="r-in"><span>    <span class="st">'species_plot'</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">'CO2_r_sp'</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specify an infinite mesophyll conductance (so `Cc` = `Ci`)</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="set_variable.html">set_variable</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">licor_file</span>,</span></span>
<span class="r-in"><span>  <span class="st">'gmc'</span>, <span class="st">'mol m^(-2) s^(-1) bar^(-1)'</span>, value <span class="op">=</span> <span class="cn">Inf</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate Cc</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_cc.html">calculate_cc</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate temperature-dependent values of C3 photosynthetic parameters</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_arrhenius.html">calculate_arrhenius</a></span><span class="op">(</span><span class="va">licor_file</span>, <span class="va">c3_arrhenius_bernacchi</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit just one curve from the data set (it is rare to do this)</span></span></span>
<span class="r-in"><span><span class="va">one_result</span> <span class="op">&lt;-</span> <span class="fu">fit_c3_aci</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">licor_file</span><span class="op">[</span><span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species_plot'</span><span class="op">]</span> <span class="op">==</span> <span class="st">'tobacco - 1'</span>, , <span class="cn">TRUE</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit all curves in the data set (it is more common to do this)</span></span></span>
<span class="r-in"><span><span class="va">aci_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="consolidate.html">consolidate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">licor_file</span>,</span></span>
<span class="r-in"><span>  <span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species_plot'</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  <span class="va">fit_c3_aci</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View the fitting parameters for each species / plot</span></span></span>
<span class="r-in"><span><span class="va">col_to_keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">'species'</span>, <span class="st">'plot'</span>, <span class="st">'TPU'</span>, <span class="st">'J_at_25'</span>, <span class="st">'Rd_at_25'</span>, <span class="st">'Vcmax_at_25'</span>, <span class="st">'convergence'</span>,</span></span>
<span class="r-in"><span>  <span class="st">'convergence_msg'</span>, <span class="st">'feval'</span>, <span class="st">'optimum_val'</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">aci_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span> , <span class="va">col_to_keep</span>, <span class="cn">TRUE</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    species [UserDefCon] (NA) plot [UserDefCon] (NA)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                    soybean                     5a</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14                   tobacco                      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27                   tobacco                      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    TPU [fit_c3_aci] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                   25.58415</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14                                  29.32262</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27                                  20.03634</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    J_at_25 [fit_c3_aci] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                       190.8857</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14                                      232.8343</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27                                     1000.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Rd_at_25 [fit_c3_aci] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                    5.769933e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14                                   3.554089e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27                                   6.369200e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Vcmax_at_25 [fit_c3_aci] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                           144.6398</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14                                          145.4359</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27                                          116.7613</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    convergence [fit_c3_aci] () convergence_msg [fit_c3_aci] ()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                            0          Successful convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14                           0          Successful convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27                           0          Successful convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    feval [fit_c3_aci] () optimum_val [fit_c3_aci] ()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                    195                   149.01374</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14                   203                    38.87372</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27                   295                   114.27896</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View the fits for each species / plot</span></span></span>
<span class="r-in"><span><span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">Ac</span> <span class="op">+</span> <span class="va">Aj</span> <span class="op">+</span> <span class="va">Ap</span> <span class="op">+</span> <span class="va">A_fit</span> <span class="op">+</span> <span class="va">A</span> <span class="op">~</span> <span class="va">Ci</span> <span class="op">|</span> <span class="va">species_plot</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">aci_results</span><span class="op">$</span><span class="va">fits</span><span class="op">$</span><span class="va">main_data</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">'b'</span>,</span></span>
<span class="r-in"><span>  pch <span class="op">=</span> <span class="fl">16</span>,</span></span>
<span class="r-in"><span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ('</span>, <span class="va">aci_results</span><span class="op">$</span><span class="va">fits</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">')'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Assimilation rate ('</span>, <span class="va">aci_results</span><span class="op">$</span><span class="va">fits</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">A</span>, <span class="st">')'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fit_c3_aci-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Edward B. Lochocki.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

