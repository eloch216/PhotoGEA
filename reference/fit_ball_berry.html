<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Calculates a linear fit of stomatal conductance vs. the Ball-Berry index using
  the data in the exdf object. This function can accomodate alternative
  column names for the variables taken from the Licor file in case they change
  at some point in the future. This function also checks the units of each
  required column and will produce an error if any units are incorrect."><title>Fits the Ball-Berry model to an experimental curve — fit_ball_berry • PhotoGEA</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fits the Ball-Berry model to an experimental curve — fit_ball_berry"><meta property="og:description" content="Calculates a linear fit of stomatal conductance vs. the Ball-Berry index using
  the data in the exdf object. This function can accomodate alternative
  column names for the variables taken from the Licor file in case they change
  at some point in the future. This function also checks the units of each
  required column and will produce an error if any units are incorrect."><meta property="og:image" content="https://eloch216.github.io/PhotoGEA/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    padding-top: 70px;

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PhotoGEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/PhotoGEA.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/analyzing_ball_berry_data.html">Analyzing Ball-Berry Data</a>
    <a class="dropdown-item" href="../articles/analyzing_c3_aci_curves.html">Analyzing C3 A-Ci Curves</a>
    <a class="dropdown-item" href="../articles/analyzing_c4_aci_curves.html">Analyzing C4 A-Ci Curves</a>
    <a class="dropdown-item" href="../articles/analyzing_gm_data.html">Analyzing Mesophyll Conductance Data</a>
    <a class="dropdown-item" href="../articles/analyzing_tdl_data.html">Analyzing TDL Data</a>
    <a class="dropdown-item" href="../articles/combining_with_other_packages.html">Combining PhotoGEA With Other Packages</a>
    <a class="dropdown-item" href="../articles/creating_your_own_processing_tools.html">Creating Your Own Processing Tools</a>
    <a class="dropdown-item" href="../articles/developing_a_data_analysis_pipeline.html">Developing a Data Analysis Pipeline</a>
    <a class="dropdown-item" href="../articles/working_with_extended_data_frames.html">Working With Extended Data Frames</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/eloch216/PhotoGEA/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Fits the Ball-Berry model to an experimental curve</h1>
      
      <div class="d-none name"><code>fit_ball_berry.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates a linear fit of stomatal conductance vs. the Ball-Berry index using
  the data in the <code>exdf</code> object. This function can accomodate alternative
  column names for the variables taken from the Licor file in case they change
  at some point in the future. This function also checks the units of each
  required column and will produce an error if any units are incorrect.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_ball_berry</span><span class="op">(</span></span>
<span>    <span class="va">replicate_exdf</span>,</span>
<span>    gsw_column_name <span class="op">=</span> <span class="st">'gsw'</span>,</span>
<span>    bb_index_column_name <span class="op">=</span> <span class="st">'bb_index'</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>replicate_exdf</dt>
<dd><p>An <code>exdf</code> object representing one Ball-Berry curve.</p></dd>


  <dt>gsw_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the stomatal
    conductance to water vapor in <code>mol m^(-2) s^(-1)</code>.</p></dd>


  <dt>bb_index_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the Ball-Berry
    index in <code>mol m^(-2) s^(-1)</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The Ball-Berry model is a simple way to describe the response of a leaf's
  stomata to its assimilation rate and local environmental conditions.
  Specifically, it predicts stomatal conductance to water vapor using the
  following equation:</p>
<p><code>gsw = bb_0 + bb_1 * A * h_s / C_s</code></p>
<p>where <code>gsw</code> is the stomatal conductance, <code>A</code> is the net assimilation
  rate, <code>h_s</code> is the relative humidity at the leaf surface, and <code>C_s</code>
  is the CO2 concentration at the leaf surface. The term <code>A * h_s / C_s</code> is
  commonly referred to as the Ball-Berry index, while the intercept
  (<code>bb_0</code>) and slope (<code>bb_1</code>) of the linear relationship are the
  Ball-Berry parameters which describe the stomatal response.</p>
<p>Although this model is certainly an oversimplification, it does encode some
  important stomatal responses. For example, when humidity is low, the stomata
  close, reducing stomatal conductance. Likewise, if the CO2 concentration
  around the leaf is depleted, the stomata open to allow more CO2 to diffuse
  into the leaf's interior, increasing somatal conductance. For more information
  about this model and some possible alternatives, see the following papers:</p><ul><li><p>Ball, J. T., Woodrow, I. E. and Berry, J. A. "A Model Predicting
          Stomatal Conductance and its Contribution to the Control of
          Photosynthesis under Different Environmental Conditions." in "Progress
          in Photosynthesis Research: Volume 4" (1986)
          [<a href="https://doi.org/10.1007/978-94-017-0519-6_48" class="external-link">doi:10.1007/978-94-017-0519-6_48</a>
].</p></li>
<li><p>Tardieu, F. and Davies, W. J. "Integration of hydraulic and chemical
          signalling in the control of stomatal conductance and water status of
          droughted plants." Plant, Cell &amp; Environment 16, 341–349 (1993).
          [<a href="https://doi.org/10.1111/j.1365-3040.1993.tb00880.x" class="external-link">doi:10.1111/j.1365-3040.1993.tb00880.x</a>
].</p></li>
<li><p>Leuning, R. "A critical appraisal of a combined
          stomatal-photosynthesis model for C3 plants." Plant, Cell &amp;
          Environment 18, 339–355 (1995)
          [<a href="https://doi.org/10.1111/j.1365-3040.1995.tb00370.x" class="external-link">doi:10.1111/j.1365-3040.1995.tb00370.x</a>
].</p></li>
<li><p>Dewar, R. C. "The Ball–Berry–Leuning and Tardieu–Davies stomatal
          models: synthesis and extension within a spatially aggregated picture
          of guard cell function." Plant, Cell &amp; Environment 25, 1383–1398 (2002).
          [<a href="https://doi.org/10.1046/j.1365-3040.2002.00909.x" class="external-link">doi:10.1046/j.1365-3040.2002.00909.x</a>
].</p></li>
</ul><p>Ball-Berry parameters are typically determined by measuring a Ball-Berry
  curve, where one or more of the factors that influence the Ball-Berry index
  is systematically varied across a range of values. At each value, care is
  taken that net assimilation and stomatal conductance have reached their
  steady-state values, and then those values are recorded. Then, a linear fit of
  the experimentally observed stomatal conductances as a function of the
  Ball-Berry index is performed to extract estimates for the Ball-Berry
  intercept and slope.</p>
<p>This function assumes that <code>replicate_exdf</code> represents a single
  Ball-Berry curve. To fit multiple curves at once, this function is often used
  along with <code><a href="by.exdf.html">by.exdf</a></code> and <code><a href="consolidate.html">consolidate</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list with two elements:</p>
<p></p>
<ul><li><p><code>fits</code>: An <code>exdf</code> object including the measured values and
          the fitted values of stomatal conductance. The fitted values will be
          stored in a column whose name is determined by appending
          <code>'_fits'</code> to the end of <code>gsw_column_name</code>; typically, this
          will be <code>'gsw_fits'</code>.</p></li>
<li><p><code>parameters</code>: An <code>exdf</code> object including the fitting
          parameters and R-squared values for each Ball-Berry curve. The
          Ball-Berry intercept is stored in the <code>bb_intercept</code> column, the
          Ball-Berry slope is stored in the <code>bb_slope</code> column, and the
          R-squared value for the fit is stored in the <code>r_squared</code> column.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Read an example Licor file included in the PhotoGEA package, calculate</span></span></span>
<span class="r-in"><span><span class="co"># additional gas properties, calculate the Ball-Berry index, define a new column</span></span></span>
<span class="r-in"><span><span class="co"># that uniquely identifies each curve, and then perform a fit to extract the</span></span></span>
<span class="r-in"><span><span class="co"># Ball-Berry parameters from each curve.</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_gasex_file.html">read_gasex_file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, <span class="st">'ball_berry_1.xlsx'</span>, package <span class="op">=</span> <span class="st">'PhotoGEA'</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_total_pressure.html">calculate_total_pressure</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_gas_properties.html">calculate_gas_properties</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">licor_file</span><span class="op">[</span>,<span class="st">'species_plot'</span><span class="op">]</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">[</span>,<span class="st">'species'</span><span class="op">]</span>, <span class="st">'-'</span>, <span class="va">licor_file</span><span class="op">[</span>,<span class="st">'plot'</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_ball_berry_index.html">calculate_ball_berry_index</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit just one curve from the data set (it is rare to do this)</span></span></span>
<span class="r-in"><span><span class="va">one_result</span> <span class="op">&lt;-</span> <span class="fu">fit_ball_berry</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">licor_file</span><span class="op">[</span><span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species_plot'</span><span class="op">]</span> <span class="op">==</span> <span class="st">'soybean - 1a'</span>, , <span class="cn">TRUE</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit all curves in the data set (it is more common to do this)</span></span></span>
<span class="r-in"><span><span class="va">bb_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="consolidate.html">consolidate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">licor_file</span>,</span></span>
<span class="r-in"><span>  <span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species_plot'</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  <span class="va">fit_ball_berry</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View the fitting parameters for each species / plot</span></span></span>
<span class="r-in"><span><span class="va">col_to_keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'species'</span>, <span class="st">'plot'</span>, <span class="st">'species_plot'</span>, <span class="st">'bb_intercept'</span>, <span class="st">'bb_slope'</span>, <span class="st">'r_squared'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bb_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span> , <span class="va">col_to_keep</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   species plot species_plot bb_intercept bb_slope r_squared</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 soybean   1a soybean - 1a   0.10331765 3.995129 0.8469371</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 soybean   1b soybean - 1b   0.10835188 6.492116 0.8394901</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 soybean    5  soybean - 5   0.13085656 7.300232 0.9094708</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 tobacco    2  tobacco - 2   0.09410874 3.613489 0.7186892</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View the fits for each species / plot</span></span></span>
<span class="r-in"><span><span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">gsw_fit</span> <span class="op">+</span> <span class="va">gsw</span> <span class="op">~</span> <span class="va">bb_index</span> <span class="op">|</span> <span class="va">species_plot</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">bb_results</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">main_data</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">'b'</span>,</span></span>
<span class="r-in"><span>  pch <span class="op">=</span> <span class="fl">16</span>,</span></span>
<span class="r-in"><span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Ball-Berry index ('</span>, <span class="va">licor_file</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">bb_index</span>, <span class="st">')'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Stomatal conductance ('</span>, <span class="va">licor_file</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">gsw</span>, <span class="st">')'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fit_ball_berry-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Edward B. Lochocki.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

