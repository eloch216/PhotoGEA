<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Fits a model to an experimentally measured C3 CO2 response curve + chlorophyll
  fluorescence using the data in the exdf object along with a few other
  user-supplied parameters. This function can accomodate alternative column
  names for the variables taken from the data file in case they change at some
  point in the future. This function also checks the units of each required
  column and will produce an error if any units are incorrect."><title>Fits a C3 assimilation model to an experimental curve — fit_c3_variable_j • PhotoGEA</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fits a C3 assimilation model to an experimental curve — fit_c3_variable_j"><meta property="og:description" content="Fits a model to an experimentally measured C3 CO2 response curve + chlorophyll
  fluorescence using the data in the exdf object along with a few other
  user-supplied parameters. This function can accomodate alternative column
  names for the variables taken from the data file in case they change at some
  point in the future. This function also checks the units of each required
  column and will produce an error if any units are incorrect."><meta property="og:image" content="https://eloch216.github.io/PhotoGEA/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    padding-top: 70px;

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PhotoGEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.11.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/PhotoGEA.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/analyzing_ball_berry_data.html">Analyzing Ball-Berry Data</a>
    <a class="dropdown-item" href="../articles/analyzing_c3_aci_curves.html">Analyzing C3 A-Ci Curves</a>
    <a class="dropdown-item" href="../articles/analyzing_c4_aci_curves.html">Analyzing C4 A-Ci Curves</a>
    <a class="dropdown-item" href="../articles/analyzing_gm_data.html">Analyzing Mesophyll Conductance Data</a>
    <a class="dropdown-item" href="../articles/analyzing_tdl_data.html">Analyzing TDL Data</a>
    <a class="dropdown-item" href="../articles/combining_with_other_packages.html">Combining PhotoGEA With Other Packages</a>
    <a class="dropdown-item" href="../articles/creating_your_own_processing_tools.html">Creating Your Own Processing Tools</a>
    <a class="dropdown-item" href="../articles/developing_a_data_analysis_pipeline.html">Developing a Data Analysis Pipeline</a>
    <a class="dropdown-item" href="../articles/working_with_extended_data_frames.html">Working With Extended Data Frames</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/eloch216/PhotoGEA/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Fits a C3 assimilation model to an experimental curve</h1>
      
      <div class="d-none name"><code>fit_c3_variable_j.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits a model to an experimentally measured C3 CO2 response curve + chlorophyll
  fluorescence using the data in the <code>exdf</code> object along with a few other
  user-supplied parameters. This function can accomodate alternative column
  names for the variables taken from the data file in case they change at some
  point in the future. This function also checks the units of each required
  column and will produce an error if any units are incorrect.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_c3_variable_j</span><span class="op">(</span></span>
<span>    <span class="va">replicate_exdf</span>,</span>
<span>    <span class="va">Ca_atmospheric</span>,</span>
<span>    a_column_name <span class="op">=</span> <span class="st">'A'</span>,</span>
<span>    ca_column_name <span class="op">=</span> <span class="st">'Ca'</span>,</span>
<span>    ci_column_name <span class="op">=</span> <span class="st">'Ci'</span>,</span>
<span>    etr_column_name <span class="op">=</span> <span class="st">'ETR'</span>,</span>
<span>    j_norm_column_name <span class="op">=</span> <span class="st">'J_norm'</span>,</span>
<span>    kc_column_name <span class="op">=</span> <span class="st">'Kc'</span>,</span>
<span>    ko_column_name <span class="op">=</span> <span class="st">'Ko'</span>,</span>
<span>    phips2_column_name <span class="op">=</span> <span class="st">'PhiPS2'</span>,</span>
<span>    qin_column_name <span class="op">=</span> <span class="st">'Qin'</span>,</span>
<span>    rd_norm_column_name <span class="op">=</span> <span class="st">'Rd_norm'</span>,</span>
<span>    total_pressure_column_name <span class="op">=</span> <span class="st">'total_pressure'</span>,</span>
<span>    vcmax_norm_column_name <span class="op">=</span> <span class="st">'Vcmax_norm'</span>,</span>
<span>    POc <span class="op">=</span> <span class="fl">210000</span>,</span>
<span>    atp_use <span class="op">=</span> <span class="fl">4.0</span>,</span>
<span>    nadph_use <span class="op">=</span> <span class="fl">8.0</span>,</span>
<span>    curvature_cj <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span>    curvature_cjp <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span>    OPTIM_FUN <span class="op">=</span> <span class="fu"><a href="optimizers.html">optimizer_deoptim</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    fit_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    cj_crossover_min <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    cj_crossover_max <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    require_positive_gmc <span class="op">=</span> <span class="st">'all'</span>,</span>
<span>    gmc_max <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>    error_threshold_factor <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>    calculate_confidence_intervals <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    remove_unreliable_param <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>replicate_exdf</dt>
<dd><p>An <code>exdf</code> object representing one CO2 response curve.</p></dd>


  <dt>Ca_atmospheric</dt>
<dd><p>The atmospheric CO2 concentration (with units of <code>micromol mol^(-1)</code>);
    this will be used by <code><a href="estimate_operating_point.html">estimate_operating_point</a></code> to estimate the
    operating point.</p></dd>


  <dt>a_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the net
    assimilation in <code>micromol m^(-2) s^(-1)</code>.</p></dd>


  <dt>ca_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the
    ambient CO2 concentration in <code>micromol mol^(-1)</code>.</p></dd>


  <dt>ci_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the
    intercellular CO2 concentration in <code>micromol mol^(-1)</code>.</p></dd>


  <dt>etr_column_name</dt>
<dd><p>The name of the column in <code>rc_exdf</code> that contains the electron
    transport rate as estimated by the measurement system in
    <code>micromol m^(-2) s^(-1)</code>.</p></dd>


  <dt>j_norm_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the normalized
    <code>J</code> values (with units of <code>normalized to J at 25 degrees C</code>).</p></dd>


  <dt>kc_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the
    Michaelis-Menten constant for rubisco carboxylation in
    <code>micromol mol^(-1)</code>.</p></dd>


  <dt>ko_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the
    Michaelis-Menten constant for rubisco oxygenation in
    <code>mmol mol^(-1)</code>.</p></dd>


  <dt>phips2_column_name</dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains values of the
    operating efficiency of photosystem II (dimensionless).</p></dd>


  <dt>qin_column_name</dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains values of the
    incident photosynthetically active flux density in
    <code>micromol m^(-2) s^(-1)</code>.</p></dd>


  <dt>rd_norm_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the normalized
    <code>Rd</code> values (with units of <code>normalized to Rd at 25 degrees C</code>).</p></dd>


  <dt>total_pressure_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the total
    pressure in <code>bar</code>.</p></dd>


  <dt>vcmax_norm_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the normalized
    <code>Vcmax</code> values (with units of
    <code>normalized to Vcmax at 25 degrees C</code>).</p></dd>


  <dt>POc</dt>
<dd><p>The partial pressure of O2 in the chloroplast, expressed in <code>microbar</code>.
    This is often assumed to be the ambient value. For air measurements, this
    would be 21 percent O2, which is about 210000 microbar at standard
    atmospheric pressure. For low oxygen measurements, this would be 2 percent
    O2, which is about 20000 microbar.</p></dd>


  <dt>atp_use</dt>
<dd><p>The number of ATP molecules used per C3 cycle.</p></dd>


  <dt>nadph_use</dt>
<dd><p>The number of NADPH molecules used per C3 cycle.</p></dd>


  <dt>curvature_cj</dt>
<dd><p>A dimensionless quadratic curvature parameter greater than or equal to 0 and
    less than or equal to 1 that sets the degree of co-limitation between
    <code>Wc</code> and <code>Wj</code>. A value of 1 indicates no co-limitation.</p></dd>


  <dt>curvature_cjp</dt>
<dd><p>A dimensionless quadratic curvature parameter greater than or equal to 0 and
    less than or equal to 1 that sets the degree of co-limitation between
    <code>Wcj</code> and <code>Wp</code>. A value of 1 indicates no co-limitation.</p></dd>


  <dt>OPTIM_FUN</dt>
<dd><p>An optimization function that accepts the following input arguments: an
    initial guess, an error function, lower bounds, and upper bounds. It should
    return a list with the following elements: <code>par</code>, <code>convergence</code>,
    <code>value</code>, and (optionally) <code>message</code>. The default option is an
    evolutionary optimizer that runs slow but tends to find good fits for most
    curves. <code><a href="optimizers.html">optimizer_nmkb</a></code> can also be used; it is faster, but
    doesn't always find a good fit.</p></dd>


  <dt>lower</dt>
<dd><p>A list of named numeric elements representing lower bounds to use when
    fitting. Values supplied here override the default values (see details
    below). For example, <code>lower = list(Vcmax_at_25 = 10)</code> sets the lower
    limit for <code>Vcmax_at_25</code> to 10 micromol / m^2 / s.</p></dd>


  <dt>upper</dt>
<dd><p>A list of named numeric elements representing upper bounds to use when
    fitting. Values supplied here override the default values (see details
    below). For example, <code>upper = list(Vcmax_at_25 = 200)</code> sets the upper
    limit for <code>Vcmax_at_25</code> to 200 micromol / m^2 / s.</p></dd>


  <dt>fit_options</dt>
<dd><p>A list of named elements representing fit options to use for each parameter.
    Values supplied here override the default values (see details below). Each
    element must be <code>'fit'</code>, <code>'column'</code>, or a numeric value. A value
    of <code>'fit'</code> means that the parameter will be fit; a value of
    <code>'column'</code> means that the value of the parameter will be taken from a
    column in <code>exdf_obj</code> of the same name; and a numeric value means that
    the parameter will be set to that value. For example, <code>fit_options =
    list(alpha_g = 0, Vcmax_at_25 = 'fit', Tp = 'column')</code> means that
    <code>alpha_g</code> will be set to 0, <code>Vcmax_at_25</code> will be fit, and
    <code>Tp</code> will be set to the values in the <code>Tp</code> column of
    <code>exdf_obj</code>.</p></dd>


  <dt>cj_crossover_min</dt>
<dd><p>To be passed to <code><a href="error_function_c3_variable_j.html">error_function_c3_variable_j</a></code>.</p></dd>


  <dt>cj_crossover_max</dt>
<dd><p>To be passed to <code><a href="error_function_c3_variable_j.html">error_function_c3_variable_j</a></code>.</p></dd>


  <dt>require_positive_gmc</dt>
<dd><p>To be passed to <code><a href="error_function_c3_variable_j.html">error_function_c3_variable_j</a></code>.</p></dd>


  <dt>gmc_max</dt>
<dd><p>To be passed to <code><a href="error_function_c3_variable_j.html">error_function_c3_variable_j</a></code>.</p></dd>


  <dt>error_threshold_factor</dt>
<dd><p>To be passed to <code><a href="confidence_intervals_c3_variable_j.html">confidence_intervals_c3_variable_j</a></code> when
    <code>calculate_confidence_intervals</code> is <code>TRUE</code>.</p></dd>


  <dt>calculate_confidence_intervals</dt>
<dd><p>A logical value indicating whether or not to estimate confidence intervals
    for the fitting parameters using
    <code><a href="confidence_intervals_c3_variable_j.html">confidence_intervals_c3_variable_j</a></code>.</p></dd>


  <dt>remove_unreliable_param</dt>
<dd><p>A logical value indicating whether or not to remove unreliable parameter
    estimates; see below for details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function calls <code><a href="calculate_c3_variable_j.html">calculate_c3_variable_j</a></code> and
  <code><a href="calculate_c3_assimilation.html">calculate_c3_assimilation</a></code> to calculate values of net
  assimilation. The user-supplied optimization function is used to vary the
  values of <code>alpha_g</code>, <code>J_at_25</code>, <code>Rd_at_25</code>, <code>tau</code>,
  <code>Tp</code>, and <code>Vcmax_at_25</code> to find ones that best reproduce the
  experimentally measured values of net assimilation. By default, the following
  options are used for the fits:</p><ul><li><p><code>alpha_g</code>: lower = 0, upper = 1, fit_option = 0</p></li>
<li><p><code>Gamma_star</code>: lower = 0, upper = 200, fit_option = <code>'column'</code></p></li>
<li><p><code>J_at_25</code>: lower = 0, upper = 1000, fit_option = <code>'fit'</code></p></li>
<li><p><code>Rd_at_25</code>: lower = 0, upper = 100, fit_option = <code>'fit'</code></p></li>
<li><p><code>tau</code>: lower = 0, upper = 1, fit_option = <code>'fit'</code></p></li>
<li><p><code>Tp</code>: lower = 0, upper = 40, fit_option = <code>'fit'</code></p></li>
<li><p><code>Vcmax_at_25</code>: lower = 0, upper = 1000, fit_option = <code>'fit'</code></p></li>
</ul><p>With these settings, <code>alpha_g</code> is set to 0, values of <code>Gamma_star</code> are
  taken from the <code>Gamma_star</code> column of <code>replicate_exdf</code>, and the
  other parameters are fit during the process (see <code>fit_options</code> above).</p>
<p>An initial guess for the parameters is generated by calling
  <code><a href="initial_guess_c3_variable_j.html">initial_guess_c3_variable_j</a></code> as follows:</p><ul><li><p><code>cc_threshold_rd</code> is set to 100 micromol / mol.</p></li>
<li><p>If <code>alpha_g</code> is being fit, the <code>alpha_g</code> argument of
          <code>initial_guess_c3_aci</code> is set to 0.5; otherwise, the argument is
          set to the value specified by the fit options.</p></li>
<li><p>If <code>Gamma_star</code> is being fit, the <code>Gamma_star</code> argument of
          <code>initial_guess_c3_aci</code> is set to 40; otherwise, the argument is
          set to the value specified by the fit options.</p></li>
</ul><p>Note that any fixed values specified in the fit options will override the
  values returned by the guessing function.</p>
<p>The fit is made by creating an error function using
  <code><a href="error_function_c3_variable_j.html">error_function_c3_variable_j</a></code> and minimizing its value using
  <code>OPTIM_FUN</code>, starting from the initial guess described above.</p>
<p>The photosynthesis model used here is not smooth in the sense that small
  changes in the input parameters do not necessarily cause changes in its
  outputs. This is related to the final step in the calculations, where the
  overall assimilation rate is taken to be the minimum of three enzyme-limited
  rates. For example, if the assimilation rate is never phosphate-limited,
  modifying <code>Tp</code> will not change the model's outputs. For this reason,
  derivative-based optimizers tend to struggle when fitting C3 A-Ci curves. Best
  results are obtained using derivative-free methods. It has been found that
  <code><a href="https://rdrr.io/pkg/DEoptim/man/DEoptim.html" class="external-link">DEoptim</a></code> is often able to find a good fit, although it
  may take a few minutes to run for a single curve.</p>
<p>Sometimes the optimizer may choose a set of parameter values where one or more
  of the potential limiting carboxylation rates (<code>Wc</code>, <code>Wj</code>, or
  <code>Wp</code>) is never the smallest rate. In this case, the corresponding
  parameter estimate (<code>Vcmax</code>, <code>J</code>, or <code>Tp</code>) will be unreliable;
  at best, it will represent a lower limit for the possible value of that
  parameter. If <code>remove_unreliable_param</code> is <code>TRUE</code>, such values will
  be set to <code>NA</code> in the outputs from <code>fit_c3_variable_j</code>.</p>
<p>Once the best-fit parameters have been determined, this function also
  estimates the operating value of `<code>Cc</code> from the atmospheric CO2
  concentration <code>atmospheric_ca</code> using
  <code><a href="estimate_operating_point.html">estimate_operating_point</a></code>, and then uses that value to estimate
  the modeled <code>An</code> at the operating point via
  <code><a href="calculate_c3_assimilation.html">calculate_c3_assimilation</a></code>.</p>
<p>This function assumes that <code>replicate_exdf</code> represents a single
  C3 A-Ci curve. To fit multiple curves at once, this function is often used
  along with <code><a href="by.exdf.html">by.exdf</a></code> and <code><a href="consolidate.html">consolidate</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list with two elements:</p>
<p></p>
<ul><li><p><code>fits</code>: An <code>exdf</code> object including the original contents of
          <code>replicate_exdf</code> along with several new columns:</p><ul><li><p>The fitted values of net assimilation will be stored in a
                  column whose name is determined by appending <code>'_fit'</code> to
                  the end of <code>a_column_name</code>; typically, this will be
                  <code>'A_fit'</code>.</p></li>
<li><p>Residuals (measured - fitted) will be stored in a column whose
                  name is determined by appending <code>'_residuals'</code> to the end
                  of <code>a_column_name</code>; typically, this will be
                  <code>'A_residuals'</code>.</p></li>
<li><p>Values of fitting parameters at 25 degrees C will be stored in
                  the <code>J_at_25</code>, <code>Rd_at_25</code>, and <code>Vcmax_at_25</code>
                  columns.</p></li>
<li><p>The other outputs from <code><a href="calculate_c3_variable_j.html">calculate_c3_variable_j</a></code>
                  and <code><a href="calculate_c3_assimilation.html">calculate_c3_assimilation</a></code> will be stored in
                  columns with the usual names: <code>tau</code>, <code>Tp</code>,
                  <code>Vcmax_tl</code>, <code>Rd_tl</code>, <code>J_tl</code>, <code>Ac</code>,
                  <code>Aj</code>, <code>Ap</code>, <code>gmc</code>, <code>J_F</code>, and <code>Cc</code>.</p></li>
</ul></li>
<li><p><code>parameters</code>: An <code>exdf</code> object including the identifiers,
          fitting parameters, and convergence information for the A-Ci curve:</p><ul><li><p>The best-fit values are stored in the <code>tau</code>, <code>Tp</code>,
                  <code>J_at_25</code>, <code>Rd_at_25</code>, and <code>Vcmax_at_25</code>
                  columns.</p></li>
<li><p>For parameters that depend on leaf temperature, the average
                  leaf-temperature-dependent values are stored in
                  <code>X_tl_avg</code> columns: <code>J_tl_avg</code>, <code>Rd_tl_avg</code>,
                  and <code>Vcmax_tl_avg</code>.</p></li>
<li><p>Information about the operating point is stored in
                  <code>operating_Cc</code>, <code>operating_Ci</code>, <code>operating_An</code>,
                  and <code>operating_An_model</code>.</p></li>
<li><p>The <code>convergence</code> column indicates whether the fit was
                  successful (<code>==0</code>) or if the optimizer encountered a
                  problem (<code>!=0</code>).</p></li>
<li><p>The <code>feval</code> column indicates how many cost function
                  evaluations were required while finding the optimal parameter
                  values.</p></li>
<li><p>The residual stats as returned by <code><a href="residual_stats.html">residual_stats</a></code>
                  are included as columns with the default names: <code>dof</code>,
                  <code>RSS</code>, <code>RMSE</code>, etc.</p></li>
</ul></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Read an example Licor file included in the PhotoGEA package</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_gasex_file.html">read_gasex_file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, <span class="st">'c3_aci_1.xlsx'</span>, package <span class="op">=</span> <span class="st">'PhotoGEA'</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define a new column that uniquely identifies each curve</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species_plot'</span><span class="op">]</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species'</span><span class="op">]</span>, <span class="st">'-'</span>, <span class="va">licor_file</span><span class="op">[</span>, <span class="st">'plot'</span><span class="op">]</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Organize the data</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="organize_response_curve_data.html">organize_response_curve_data</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">licor_file</span>,</span></span>
<span class="r-in"><span>    <span class="st">'species_plot'</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">'CO2_r_sp'</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate the total pressure in the Licor chamber</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_total_pressure.html">calculate_total_pressure</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate temperature-dependent values of C3 photosynthetic parameters</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_arrhenius.html">calculate_arrhenius</a></span><span class="op">(</span><span class="va">licor_file</span>, <span class="va">c3_arrhenius_bernacchi</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit just one curve from the data set (it is rare to do this). Here we also</span></span></span>
<span class="r-in"><span><span class="co"># calculate confidence intervals.</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">one_result</span> <span class="op">&lt;-</span> <span class="fu">fit_c3_variable_j</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">licor_file</span><span class="op">[</span><span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species_plot'</span><span class="op">]</span> <span class="op">==</span> <span class="st">'tobacco - 1'</span>, , <span class="cn">TRUE</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  Ca_atmospheric <span class="op">=</span> <span class="fl">420</span>,</span></span>
<span class="r-in"><span>  calculate_confidence_intervals <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit all curves in the data set (it is more common to do this). Here we use</span></span></span>
<span class="r-in"><span><span class="co"># `optimizer_nmkb` to speed up the fit, although the results might be better</span></span></span>
<span class="r-in"><span><span class="co"># with `optimizer_deoptim`</span></span></span>
<span class="r-in"><span><span class="va">aci_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="consolidate.html">consolidate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">licor_file</span>,</span></span>
<span class="r-in"><span>  <span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species_plot'</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  <span class="va">fit_c3_variable_j</span>,</span></span>
<span class="r-in"><span>  Ca_atmospheric <span class="op">=</span> <span class="fl">420</span>,</span></span>
<span class="r-in"><span>  OPTIM_FUN <span class="op">=</span> <span class="fu"><a href="optimizers.html">optimizer_nmkb</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View the fitting parameters for each species / plot</span></span></span>
<span class="r-in"><span><span class="va">col_to_keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">'species'</span>, <span class="st">'plot'</span>,                                       <span class="co"># identifiers</span></span></span>
<span class="r-in"><span>  <span class="st">'n_Wc_smallest'</span>, <span class="st">'n_Wj_smallest'</span>, <span class="st">'n_Wp_smallest'</span>,       <span class="co"># number of points where</span></span></span>
<span class="r-in"><span>                                                           <span class="co">#   each process is limiting</span></span></span>
<span class="r-in"><span>  <span class="st">'tau'</span>, <span class="st">'Tp'</span>,                                             <span class="co"># parameters with temperature response</span></span></span>
<span class="r-in"><span>  <span class="st">'J_at_25'</span>, <span class="st">'Rd_at_25'</span>, <span class="st">'Vcmax_at_25'</span>,                    <span class="co"># parameters scaled to 25 degrees C</span></span></span>
<span class="r-in"><span>  <span class="st">'J_tl_avg'</span>, <span class="st">'Rd_tl_avg'</span>, <span class="st">'Vcmax_tl_avg'</span>,                 <span class="co"># average temperature-dependent values</span></span></span>
<span class="r-in"><span>  <span class="st">'operating_Ci'</span>, <span class="st">'operating_An'</span>, <span class="st">'operating_An_model'</span>,    <span class="co"># operating point info</span></span></span>
<span class="r-in"><span>  <span class="st">'dof'</span>, <span class="st">'RSS'</span>, <span class="st">'MSE'</span>, <span class="st">'RMSE'</span>, <span class="st">'RSE'</span>,                      <span class="co"># residual stats</span></span></span>
<span class="r-in"><span>  <span class="st">'convergence'</span>, <span class="st">'convergence_msg'</span>, <span class="st">'feval'</span>, <span class="st">'optimum_val'</span> <span class="co"># convergence info</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">aci_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span> , <span class="va">col_to_keep</span>, <span class="cn">TRUE</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   species [UserDefCon] (NA) plot [UserDefCon] (NA)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                   soybean                     5a</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                   tobacco                      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                   tobacco                      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   n_Wc_smallest [fit_c3_variable_j] () n_Wj_smallest [fit_c3_variable_j] ()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                   11                                    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                   10                                    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                    9                                    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   n_Wp_smallest [fit_c3_variable_j] ()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   tau [fit_c3_variable_j] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                        0.9726786</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                        0.9793732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                        0.7441397</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Tp [fit_c3_variable_j] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                        19.98135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                        23.79105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                        39.78223</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   J_at_25 [fit_c3_variable_j] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                             479.8624</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                             631.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                             426.2146</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Rd_at_25 [fit_c3_variable_j] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                             0.9363464</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                             1.8306364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                             1.5912852</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Vcmax_at_25 [fit_c3_variable_j] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                                 573.3218</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                                 738.1945</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                                 479.3439</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   J_tl_avg [fit_c3_variable_j] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                              674.0935</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                              869.1543</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                              590.1882</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Rd_tl_avg [fit_c3_variable_j] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                               1.322335</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                               2.531653</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                               2.213071</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Vcmax_tl_avg [fit_c3_variable_j] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                                  920.3110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                                 1150.5052</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                                  752.9947</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   operating_Ci [estimate_operating_point] (micromol mol^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                                    264.3297</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                                    294.7032</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                                    301.2673</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   operating_An [estimate_operating_point] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                                         31.00316</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                                         37.51608</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                                         31.57904</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   operating_An_model [fit_c3_variable_j] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                                        30.52370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                                        36.27411</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                                        30.18355</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   dof [residual_stats] (NA) RSS [residual_stats] ((micromol m^(-2) s^(-1))^2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                         8                                          16.66090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                         8                                          16.70402</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                         8                                          17.95654</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   MSE [residual_stats] ((micromol m^(-2) s^(-1))^2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                          1.281607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                          1.284924</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                          1.381273</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   RMSE [residual_stats] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                       1.132081</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                       1.133545</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                       1.175276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   RSE [residual_stats] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                      1.443126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                      1.444992</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                      1.498188</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   convergence [fit_c3_variable_j] () convergence_msg [fit_c3_variable_j] ()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                  0                 Successful convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                  0                 Successful convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                  0                 Successful convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   feval [fit_c3_variable_j] () optimum_val [fit_c3_variable_j] ()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                         1069                           16.66090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                          623                           16.70402</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                          306                           17.95654</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View the fits for each species / plot</span></span></span>
<span class="r-in"><span><span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">Ac</span> <span class="op">+</span> <span class="va">Aj</span> <span class="op">+</span> <span class="va">Ap</span> <span class="op">+</span> <span class="va">A_fit</span> <span class="op">+</span> <span class="va">A</span> <span class="op">~</span> <span class="va">Ci</span> <span class="op">|</span> <span class="va">species_plot</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">aci_results</span><span class="op">$</span><span class="va">fits</span><span class="op">$</span><span class="va">main_data</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">'b'</span>,</span></span>
<span class="r-in"><span>  pch <span class="op">=</span> <span class="fl">16</span>,</span></span>
<span class="r-in"><span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ('</span>, <span class="va">aci_results</span><span class="op">$</span><span class="va">fits</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">')'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Assimilation rate ('</span>, <span class="va">aci_results</span><span class="op">$</span><span class="va">fits</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">A</span>, <span class="st">')'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fit_c3_variable_j-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View the residuals for each species / plot</span></span></span>
<span class="r-in"><span><span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">A_residuals</span> <span class="op">~</span> <span class="va">Ci</span> <span class="op">|</span> <span class="va">species_plot</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">aci_results</span><span class="op">$</span><span class="va">fits</span><span class="op">$</span><span class="va">main_data</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">'b'</span>,</span></span>
<span class="r-in"><span>  pch <span class="op">=</span> <span class="fl">16</span>,</span></span>
<span class="r-in"><span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ('</span>, <span class="va">aci_results</span><span class="op">$</span><span class="va">fits</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">')'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Assimilation rate residuals ('</span>, <span class="va">aci_results</span><span class="op">$</span><span class="va">fits</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">A_residuals</span>, <span class="st">')'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fit_c3_variable_j-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View the estimated mesophyll conductance values for each species / plot</span></span></span>
<span class="r-in"><span><span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">gmc</span> <span class="op">~</span> <span class="va">Ci</span> <span class="op">|</span> <span class="va">species_plot</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">aci_results</span><span class="op">$</span><span class="va">fits</span><span class="op">$</span><span class="va">main_data</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">'b'</span>,</span></span>
<span class="r-in"><span>  pch <span class="op">=</span> <span class="fl">16</span>,</span></span>
<span class="r-in"><span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Intercellular CO2 concentration ('</span>, <span class="va">aci_results</span><span class="op">$</span><span class="va">fits</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Ci</span>, <span class="st">')'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Mesophyll conductance to CO2 ('</span>, <span class="va">aci_results</span><span class="op">$</span><span class="va">fits</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">gmc</span>, <span class="st">')'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fit_c3_variable_j-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># In some of the curves above, there are no points where carboxylation is TPU</span></span></span>
<span class="r-in"><span><span class="co"># limited. We can automatically remove the unreliable Tp estimates.</span></span></span>
<span class="r-in"><span><span class="va">aci_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="consolidate.html">consolidate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">licor_file</span>,</span></span>
<span class="r-in"><span>  <span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species_plot'</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  <span class="va">fit_c3_variable_j</span>,</span></span>
<span class="r-in"><span>  Ca_atmospheric <span class="op">=</span> <span class="fl">420</span>,</span></span>
<span class="r-in"><span>  OPTIM_FUN <span class="op">=</span> <span class="fu"><a href="optimizers.html">optimizer_nmkb</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  remove_unreliable_param <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">aci_results</span><span class="op">$</span><span class="va">parameters</span><span class="op">[</span> , <span class="va">col_to_keep</span>, <span class="cn">TRUE</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   species [UserDefCon] (NA) plot [UserDefCon] (NA)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                   soybean                     5a</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                   tobacco                      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                   tobacco                      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   n_Wc_smallest [fit_c3_variable_j] () n_Wj_smallest [fit_c3_variable_j] ()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                   11                                    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                   10                                    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                    9                                    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   n_Wp_smallest [fit_c3_variable_j] ()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   tau [fit_c3_variable_j] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                        0.9726786</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                        0.9793732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                        0.7441397</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Tp [fit_c3_variable_j] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                        19.98135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                        23.79105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                              NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   J_at_25 [fit_c3_variable_j] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                             479.8624</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                             631.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                             426.2146</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Rd_at_25 [fit_c3_variable_j] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                             0.9363464</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                             1.8306364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                             1.5912852</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Vcmax_at_25 [fit_c3_variable_j] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                                 573.3218</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                                 738.1945</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                                 479.3439</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   J_tl_avg [fit_c3_variable_j] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                              674.0935</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                              869.1543</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                              590.1882</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Rd_tl_avg [fit_c3_variable_j] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                               1.322335</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                               2.531653</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                               2.213071</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Vcmax_tl_avg [fit_c3_variable_j] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                                  920.3110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                                 1150.5052</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                                  752.9947</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   operating_Ci [estimate_operating_point] (micromol mol^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                                    264.3297</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                                    294.7032</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                                    301.2673</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   operating_An [estimate_operating_point] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                                         31.00316</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                                         37.51608</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                                         31.57904</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   operating_An_model [fit_c3_variable_j] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                                        30.52370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                                        36.27411</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                                        30.18355</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   dof [residual_stats] (NA) RSS [residual_stats] ((micromol m^(-2) s^(-1))^2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                         8                                          16.66090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                         8                                          16.70402</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                         8                                          17.95654</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   MSE [residual_stats] ((micromol m^(-2) s^(-1))^2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                          1.281607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                          1.284924</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                          1.381273</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   RMSE [residual_stats] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                       1.132081</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                       1.133545</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                       1.175276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   RSE [residual_stats] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                      1.443126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                      1.444992</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                      1.498188</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   convergence [fit_c3_variable_j] () convergence_msg [fit_c3_variable_j] ()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                  0                 Successful convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                  0                 Successful convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                  0                 Successful convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   feval [fit_c3_variable_j] () optimum_val [fit_c3_variable_j] ()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                         1069                           16.66090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                          623                           16.70402</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                          306                           17.95654</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Edward B. Lochocki.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

