<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate the relative limiting factors to C3 photosynthesis — calculate_c3_limitations_grassi • PhotoGEA</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate the relative limiting factors to C3 photosynthesis — calculate_c3_limitations_grassi"><meta name="description" content="Uses the method from Grassi &amp;amp; Magnani (2005) to estimate the relative
  limitations to C3 photosynthesis due to stomatal conductance, mesophyll
  conductance, and biochemistry. This function can accomodate alternative
  column names for the variables taken from the data file in case they change
  at some point in the future. This function also checks the units of each
  required column and will produce an error if any units are incorrect."><meta property="og:description" content="Uses the method from Grassi &amp;amp; Magnani (2005) to estimate the relative
  limitations to C3 photosynthesis due to stomatal conductance, mesophyll
  conductance, and biochemistry. This function can accomodate alternative
  column names for the variables taken from the data file in case they change
  at some point in the future. This function also checks the units of each
  required column and will produce an error if any units are incorrect."><meta property="og:image" content="https://eloch216.github.io/PhotoGEA/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    padding-top: 70px;

    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PhotoGEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/PhotoGEA.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-user-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">User Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-user-guides"><li><h6 class="dropdown-header" data-toc-skip>ANALYSIS GUIDES</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/web_only/analyzing_ball_berry_data.html">Analyzing Ball-Berry Data</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/analyzing_c3_aci_curves.html">Analyzing C3 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/analyzing_c4_aci_curves.html">Analyzing C4 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/analyzing_gm_data.html">Analyzing Mesophyll Conductance Data</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/analyzing_tdl_data.html">Analyzing TDL Data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>GENERAL PHOTOGEA ADVICE</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/web_only/combining_with_other_packages.html">Combining PhotoGEA With Other Packages</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/creating_your_own_processing_tools.html">Creating Your Own Processing Tools</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/developing_a_data_analysis_pipeline.html">Developing a Data Analysis Pipeline</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/working_with_extended_data_frames.html">Working With Extended Data Frames</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/frequent_questions.html">Frequently Asked Questions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>GENERAL GAS EXCHANGE ADVICE</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/web_only/LI6800_user_constants.html">Guide to Licor LI-6800 User Constants</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/web_only/publications.html">Publications</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/eloch216/PhotoGEA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Estimate the relative limiting factors to C3 photosynthesis</h1>

      <div class="d-none name"><code>calculate_c3_limitations_grassi.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Uses the method from Grassi &amp; Magnani (2005) to estimate the relative
  limitations to C3 photosynthesis due to stomatal conductance, mesophyll
  conductance, and biochemistry. This function can accomodate alternative
  column names for the variables taken from the data file in case they change
  at some point in the future. This function also checks the units of each
  required column and will produce an error if any units are incorrect.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calculate_c3_limitations_grassi</span><span class="op">(</span></span>
<span>    <span class="va">exdf_obj</span>,</span>
<span>    Wj_coef_C <span class="op">=</span> <span class="fl">4.0</span>,</span>
<span>    Wj_coef_Gamma_star <span class="op">=</span> <span class="fl">8.0</span>,</span>
<span>    cc_column_name <span class="op">=</span> <span class="st">'Cc'</span>,</span>
<span>    gamma_star_column_name <span class="op">=</span> <span class="st">'Gamma_star_tl'</span>,</span>
<span>    gmc_column_name <span class="op">=</span> <span class="st">'gmc_tl'</span>,</span>
<span>    gsc_column_name <span class="op">=</span> <span class="st">'gsc'</span>,</span>
<span>    kc_column_name <span class="op">=</span> <span class="st">'Kc_tl'</span>,</span>
<span>    ko_column_name <span class="op">=</span> <span class="st">'Ko_tl'</span>,</span>
<span>    oxygen_column_name <span class="op">=</span> <span class="st">'oxygen'</span>,</span>
<span>    total_pressure_column_name <span class="op">=</span> <span class="st">'total_pressure'</span>,</span>
<span>    vcmax_column_name <span class="op">=</span> <span class="st">'Vcmax_tl'</span>,</span>
<span>    j_column_name <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-exdf-obj">exdf_obj<a class="anchor" aria-label="anchor" href="#arg-exdf-obj"></a></dt>
<dd><p>An <code>exdf</code> object representing gas exchange data.</p></dd>


  <dt id="arg-wj-coef-c">Wj_coef_C<a class="anchor" aria-label="anchor" href="#arg-wj-coef-c"></a></dt>
<dd><p>A coefficient in the equation for RuBP-regeneration-limited carboxylation,
    whose value depends on assumptions about the NADPH and ATP requirements of
    RuBP regeneration; see <code><a href="calculate_c3_assimilation.html">calculate_c3_assimilation</a></code> for more
    information.</p></dd>


  <dt id="arg-wj-coef-gamma-star">Wj_coef_Gamma_star<a class="anchor" aria-label="anchor" href="#arg-wj-coef-gamma-star"></a></dt>
<dd><p>A coefficient in the equation for RuBP-regeneration-limited carboxylation,
    whose value depends on assumptions about the NADPH and ATP requirements of
    RuBP regeneration; see <code><a href="calculate_c3_assimilation.html">calculate_c3_assimilation</a></code> for more
    information.</p></dd>


  <dt id="arg-cc-column-name">cc_column_name<a class="anchor" aria-label="anchor" href="#arg-cc-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the chloroplastic
    CO2 concentration in <code>micromol mol^(-1)</code>. Typically these are
    values that are automatically calculated by <code><a href="fit_c3_aci.html">fit_c3_aci</a></code>.</p></dd>


  <dt id="arg-gamma-star-column-name">gamma_star_column_name<a class="anchor" aria-label="anchor" href="#arg-gamma-star-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the
    <code>Gamma_star</code> values in <code>micromol mol^(-1)</code>. Typically these are
    the leaf-temperature dependent values that are automatically calculated by
    <code><a href="fit_c3_aci.html">fit_c3_aci</a></code>.</p></dd>


  <dt id="arg-gmc-column-name">gmc_column_name<a class="anchor" aria-label="anchor" href="#arg-gmc-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the mesophyll
    conductance to CO2 in <code>mol m^(-2) s^(-1) bar^(-1)</code>. Typically these are
    the leaf-temperature adjusted values that are automatically calculated by
    <code><a href="fit_c3_aci.html">fit_c3_aci</a></code>.</p></dd>


  <dt id="arg-gsc-column-name">gsc_column_name<a class="anchor" aria-label="anchor" href="#arg-gsc-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the stomatal
    conductance to CO2 in <code>mol m^(-2) s^(-1)</code>. Typically this column is
    calculated using <code><a href="calculate_gas_properties.html">calculate_gas_properties</a></code>.</p></dd>


  <dt id="arg-kc-column-name">kc_column_name<a class="anchor" aria-label="anchor" href="#arg-kc-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the
    Michaelis-Menten constant for rubisco carboxylation in
    <code>micromol mol^(-1)</code>. Typically these are the leaf-temperature dependent
    values that are automatically calculated by <code><a href="fit_c3_aci.html">fit_c3_aci</a></code>.</p></dd>


  <dt id="arg-ko-column-name">ko_column_name<a class="anchor" aria-label="anchor" href="#arg-ko-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the
    Michaelis-Menten constant for rubisco oxygenation in
    <code>mmol mol^(-1)</code>. Typically these are the leaf-temperature dependent
    values that are automatically calculated by <code><a href="fit_c3_aci.html">fit_c3_aci</a></code>.</p></dd>


  <dt id="arg-oxygen-column-name">oxygen_column_name<a class="anchor" aria-label="anchor" href="#arg-oxygen-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the concentration
    of O2 in the ambient air, expressed as a percentage (commonly 21% or 2%);
    the units must be <code>percent</code>.</p></dd>


  <dt id="arg-total-pressure-column-name">total_pressure_column_name<a class="anchor" aria-label="anchor" href="#arg-total-pressure-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the total pressure
    in <code>bar</code>. Typically this is calculated using
    <code><a href="calculate_total_pressure.html">calculate_total_pressure</a></code>.</p></dd>


  <dt id="arg-vcmax-column-name">vcmax_column_name<a class="anchor" aria-label="anchor" href="#arg-vcmax-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains values of the
    maximum Rubisco carboxylation rate (<code>Vcmax</code>) in
    <code>micromol m^(-2) s^(-1)</code>. Typically these are the leaf-temperature
    adjusted values that are automatically calculated by
    <code><a href="fit_c3_aci.html">fit_c3_aci</a></code>.</p></dd>


  <dt id="arg-j-column-name">j_column_name<a class="anchor" aria-label="anchor" href="#arg-j-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains values of the
    RuBP regeneration rate (<code>J</code>) in <code>micromol m^(-2) s^(-1)</code>.
    Typically these are the leaf-temperature adjusted values that are
    automatically calculated by <code><a href="fit_c3_aci.html">fit_c3_aci</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When analyzing or interpreting C3 gas exchange data, it is often useful to
  estimate the relative limitations to assimilation that are due to stomatal
  conductance, mesophyll conductance, and biochemistry. This can be done using
  a framework first introduced by Grassi &amp; Magnani (2005). In this framework,
  the relative limitation due to stomatal conductance (<code>ls</code>) is</p>
<p><code>ls = [(g_t / g_sc) * (dAdC)] / [g_t + dAdC]</code>,</p>
<p>the relative limitation due to mesophyll conductance (<code>lm</code>) is</p>
<p><code>lm = [(g_t / g_mc) * (dAdC)] / [g_t + dAdC]</code>,</p>
<p>and the relative limitation due to biochemistry (<code>lb</code>) is</p>
<p><code>ln = [g_t] / [g_t + dAdC]</code>,</p>
<p>where <code>g_sc</code> is the stomatal conductance to CO2, <code>g_mc</code> is the
  mesophyll conductance to CO2, <code>gt = 1 / (1 / g_mc + 1 / g_sc)</code> is the
  total conductance to CO2, and <code>dAdC</code> is the partial derivative of the
  net CO2 assimilation rate (<code>An</code>) with respect to the chloroplast CO2
  concentration (<code>Cc</code>). These can be found in Equation 7 from Grassi &amp;
  Magnani (2005).</p>
<p>These equations were derived by assuming that CO2 assimilation is limited by
  Rubisco activity; in other words, that the net CO2 assimilation rate is given
  by</p>
<p><code>Ac = Vcmax * (Cc - Gamma_star) / (Cc + Km) - RL</code>,</p>
<p>where <code>Vcmax</code> is the maximum Rubisco carboxylation rate,
  <code>Gamma_star</code> is the CO2 compensation point in the absence of day
  respiration, <code>RL</code> is the day respiration rate, <code>Km</code> is the effective
  Michaelis-Menten constant for Rubisco carboxylation. In turn, <code>Km</code> is
  given by <code>Km = Kc * (1 + O / Ko)</code>, where <code>Kc</code> is the
  Michaelis-Menten constant for carboxylation, <code>Ko</code> is the Michaelis-Menten
  constant for oxygenation, and <code>O</code> is the oxygen concentration in the
  chloroplast.</p>
<p>Under this assumption, it is possible to analytically determine the partial
  derivative <code>dAdC</code>:</p>
<p><code>dAdC_rubisco = Vcmax * (Gamma_star + Km) / (Cc + Km)^2</code></p>
<p>In this case, the limitation due to "biochemistry" actually refers to
  limitation due to the value of <code>Vcmax</code>. Note that sometimes this
  derivative is estimated from the initial slope of a measured A-Ci curve rather
  than calculated analytically. (See, for example, Pathare et al. (2023).)
  However, we do not take that approach here. Also note that the value of
  <code>Vcmax</code> can be estimated using different approaches. For example, Xiong
  (2023) uses single-point gas exchange measurements. When possible, it would be
  better to use an estimate from fitting an entire A-Ci curve, as shown in the
  example below.</p>
<p>To understand the meaning of these limiting factors, note that simultaneously
  making small fractional increases to <code>g_sc</code>, <code>g_mc</code>, and
  <code>Vcmax</code> will generally cause an associated small fractional increase in
  <code>An</code>. The limiting factors describe the fraction of the increase in
  <code>An</code> that can be attributed to each of <code>g_sc</code>, <code>g_mc</code>, and
  <code>Vcmax</code>. For example, <code>ls = 0.2, lm = 0.3, lb = 0.5</code> would mean that
  20 percent of the increase in <code>An</code> would be due to an increase in
  stomatal conductance, 30 percent due to an increase in mesophyll conductance,
  and 50 percent due to an increase in <code>Vcmax</code>. Note that <code>ls</code>,
  <code>lm</code>, and <code>lb</code> always add up to 1.</p>
<p>Thus, when one of the factors is large, changes in the related parameter
  produce relatively larger changes in the assimilation rate. In that case, it
  can be said that that parameter is setting a large limit on the assimilation
  rate. On the other hand, if a factor is small, small changes in the related
  parameter produce relatively small changes in <code>An</code>, and therefore that
  parameter is not setting a large limit on the assimilation rate.</p>
<p>It is also possible to calculate <code>dAdC</code> when assimilation is limited by
  RuBP regeneration. In this case, we have</p>
<p><code>Aj = J * (Cc - Gamma_star) / (4 * Cc + 8 * Gamma_star) - RL</code>,</p>
<p>where <code>J</code> is the RuBP regeneration rate, and the limitation due to
  "biochemistry" actually refers to limitation due to the value of <code>J</code>
  (rather than <code>Vcmax</code>. The same equations as before can be used to
  calculate the limiting factors (<code>ls</code>, <code>lm</code>, <code>lb</code>), but the
  partial derivative is now given by</p>
<p><code>dAdC_j = J * Gamma_star * 12 / (4 * Cc + 8 * Gamma_star)^2</code>.</p>
<p>Most users will want the limitations assuming Rubisco-limited assimilation.
  However, if <code>j_column_name</code> is not <code>NULL</code>, values of <code>J</code> will
  be used to calculate the limiting factors assuming RuBP-regeneration-limited
  assimilation. For an example of how these additional factors can be used, see
  Sakoda et al. (2021).</p>
<p>References:</p>
<p>Grassi, G. &amp; Magnani, F. "Stomatal, mesophyll conductance and biochemical
  limitations to photosynthesis as affected by drought and leaf ontogeny in ash
  and oak trees." Plant, Cell &amp; Environment 28, 834–849 (2005)
  [<a href="https://doi.org/10.1111/j.1365-3040.2005.01333.x" class="external-link">doi:10.1111/j.1365-3040.2005.01333.x</a>
].</p>
<p>Pathare, V. S. et al. "Altered cell wall hydroxycinnamate composition impacts
  leaf- and canopy-level CO2 uptake and water use in rice." Plant Physiology
  kiad428 (2023) [<a href="https://doi.org/10.1093/plphys/kiad428" class="external-link">doi:10.1093/plphys/kiad428</a>
].</p>
<p>Xiong, D. "Leaf anatomy does not explain the large variability of mesophyll
  conductance across C3 crop species." The Plant Journal 113, 1035–1048 (2023)
  [<a href="https://doi.org/10.1111/tpj.16098" class="external-link">doi:10.1111/tpj.16098</a>
].</p>
<p>Sakoda, K., Yamori, W., Groszmann, M. &amp; Evans, J. R. "Stomatal, mesophyll
  conductance, and biochemical limitations to photosynthesis during induction."
  Plant Physiology 185, 146–160 (2021)
  [<a href="https://doi.org/10.1093/plphys/kiaa011" class="external-link">doi:10.1093/plphys/kiaa011</a>
].</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>This function returns an <code>exdf</code> object based on <code>exdf_obj</code> but with
  several new columns representing the partial derivatives and limiting factors
  discussed above: <code>dAdC_rubisco</code>, <code>ls_rubisco_grassi</code>,
  <code>lm_rubisco_grassi</code>, and <code>lb_rubisco_grassi</code>. If
  <code>j_column_name</code> is not <code>NULL</code>, the output will also include
  <code>dAdC_j</code>, <code>ls_j_grassi</code>, <code>lm_j_grassi</code>, and <code>lb_j_grassi</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Read an example Licor file included in the PhotoGEA package</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_gasex_file.html">read_gasex_file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="PhotoGEA_example_file_path.html">PhotoGEA_example_file_path</a></span><span class="op">(</span><span class="st">'c3_aci_1.xlsx'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define a new column that uniquely identifies each curve</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species_plot'</span><span class="op">]</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species'</span><span class="op">]</span>, <span class="st">'-'</span>, <span class="va">licor_file</span><span class="op">[</span>, <span class="st">'plot'</span><span class="op">]</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Organize the data</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="organize_response_curve_data.html">organize_response_curve_data</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">licor_file</span>,</span></span>
<span class="r-in"><span>    <span class="st">'species_plot'</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">'CO2_r_sp'</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate the total pressure in the Licor chamber</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_total_pressure.html">calculate_total_pressure</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate additional gas properties</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_gas_properties.html">calculate_gas_properties</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate temperature-dependent values of C3 photosynthetic parameters</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_temperature_response.html">calculate_temperature_response</a></span><span class="op">(</span><span class="va">licor_file</span>, <span class="va">c3_temperature_param_bernacchi</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit all curves in the data set. Here we use a faster optimizer than the</span></span></span>
<span class="r-in"><span><span class="co"># default one to ensure the example runs quickly.</span></span></span>
<span class="r-in"><span><span class="va">aci_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="consolidate.html">consolidate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">licor_file</span>,</span></span>
<span class="r-in"><span>  <span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species_plot'</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  <span class="va">fit_c3_aci</span>,</span></span>
<span class="r-in"><span>  Ca_atmospheric <span class="op">=</span> <span class="fl">420</span>,</span></span>
<span class="r-in"><span>  optim_fun <span class="op">=</span> <span class="fu"><a href="optimizers.html">optimizer_nmkb</a></span><span class="op">(</span><span class="fl">1e-7</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  fit_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>gmc_at_25 <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get a subset of fitting results corresponding to the first measured point</span></span></span>
<span class="r-in"><span><span class="co"># in each curve (where CO2_r_sp = 400 ppm)</span></span></span>
<span class="r-in"><span><span class="va">aci_fit_subset</span> <span class="op">&lt;-</span> <span class="va">aci_results</span><span class="op">$</span><span class="va">fits</span><span class="op">[</span><span class="va">aci_results</span><span class="op">$</span><span class="va">fits</span><span class="op">[</span>, <span class="st">'CO2_r_sp'</span><span class="op">]</span> <span class="op">==</span> <span class="fl">400</span>, , <span class="cn">TRUE</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate limiting factors</span></span></span>
<span class="r-in"><span><span class="va">aci_fit_subset</span> <span class="op">&lt;-</span> <span class="fu">calculate_c3_limitations_grassi</span><span class="op">(</span><span class="va">aci_fit_subset</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View the limiting factors for each species / plot</span></span></span>
<span class="r-in"><span><span class="va">col_to_keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">'species'</span>, <span class="st">'plot'</span>,                                            <span class="co"># identifiers</span></span></span>
<span class="r-in"><span>  <span class="st">'ls_rubisco_grassi'</span>, <span class="st">'lm_rubisco_grassi'</span>, <span class="st">'lb_rubisco_grassi'</span> <span class="co"># limitation info</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">aci_fit_subset</span><span class="op">[</span> , <span class="va">col_to_keep</span>, <span class="cn">TRUE</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Converting an `exdf` object to a `data.frame` before printing</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    species [UserDefCon] (NA) plot [UserDefCon] (NA)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8                    soybean                     5a</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21                   tobacco                      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34                   tobacco                      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ls_rubisco_grassi [calculate_c3_limitations_grassi] (dimensionless)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8                                                            0.5089481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21                                                           0.3651309</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34                                                                  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    lm_rubisco_grassi [calculate_c3_limitations_grassi] (dimensionless)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8                                                            0.1426870</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21                                                           0.1917726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34                                                                  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    lb_rubisco_grassi [calculate_c3_limitations_grassi] (dimensionless)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8                                                            0.3483649</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21                                                           0.4430964</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34                                                                  NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># One of these fits has NA for all the limiting factors, which causes problems</span></span></span>
<span class="r-in"><span><span class="co"># when making bar charts with some versions of the `lattice` package, so we</span></span></span>
<span class="r-in"><span><span class="co"># exclude that curve for plotting</span></span></span>
<span class="r-in"><span><span class="va">data_for_barchart</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="va">aci_fit_subset</span><span class="op">$</span><span class="va">main_data</span><span class="op">[</span><span class="va">aci_fit_subset</span><span class="op">$</span><span class="va">main_data</span><span class="op">$</span><span class="va">species_plot</span> <span class="op">!=</span> <span class="st">'tobacco - 2'</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Display as a bar chart</span></span></span>
<span class="r-in"><span><span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">barchart</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">ls_rubisco_grassi</span> <span class="op">+</span> <span class="va">lm_rubisco_grassi</span> <span class="op">+</span> <span class="va">lb_rubisco_grassi</span> <span class="op">~</span> <span class="va">species_plot</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">data_for_barchart</span>,</span></span>
<span class="r-in"><span>  stack <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  ylab <span class="op">=</span> <span class="st">'Factors limiting assimilation'</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="calculate_c3_limitations_grassi-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward B. Lochocki, Coralie E. Salesse-Smith, Justin M. McGrath.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

