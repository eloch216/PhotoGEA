<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate statistics that describe the residuals of a fit — residual_stats • PhotoGEA</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate statistics that describe the residuals of a fit — residual_stats"><meta name="description" content="Calculates several key statistics from the residuals of of a fit: the residual
  sum of squares (RSS), the mean squared error (MSE), the root
  mean squared error (RMSE), the residual standard error (RSE),
  and the Akaike information criterion (AIC). This function is used
  internally by all fitting functions in the PhotoGEA package, such as
  fit_ball_berry and fit_c3_aci."><meta property="og:description" content="Calculates several key statistics from the residuals of of a fit: the residual
  sum of squares (RSS), the mean squared error (MSE), the root
  mean squared error (RMSE), the residual standard error (RSE),
  and the Akaike information criterion (AIC). This function is used
  internally by all fitting functions in the PhotoGEA package, such as
  fit_ball_berry and fit_c3_aci."><meta property="og:image" content="https://eloch216.github.io/PhotoGEA/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    padding-top: 70px;

    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PhotoGEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/PhotoGEA.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-user-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">User Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-user-guides"><li><h6 class="dropdown-header" data-toc-skip>ANALYSIS GUIDES</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/analyzing_ball_berry_data.html">Analyzing Ball-Berry Data</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_c3_aci_curves.html">Analyzing C3 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_c4_aci_curves.html">Analyzing C4 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_gm_data.html">Analyzing Mesophyll Conductance Data</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_tdl_data.html">Analyzing TDL Data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>GENERAL PHOTOGEA ADVICE</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/combining_with_other_packages.html">Combining PhotoGEA With Other Packages</a></li>
    <li><a class="dropdown-item" href="../articles/creating_your_own_processing_tools.html">Creating Your Own Processing Tools</a></li>
    <li><a class="dropdown-item" href="../articles/developing_a_data_analysis_pipeline.html">Developing a Data Analysis Pipeline</a></li>
    <li><a class="dropdown-item" href="../articles/working_with_extended_data_frames.html">Working With Extended Data Frames</a></li>
    <li><a class="dropdown-item" href="../articles/frequent_questions.html">Frequently Asked Questions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>GENERAL GAS EXCHANGE ADVICE</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/LI6800_user_constants.html">Guide to Licor LI-6800 User Constants</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/publications.html">Publications</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/eloch216/PhotoGEA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Calculate statistics that describe the residuals of a fit</h1>

      <div class="d-none name"><code>residual_stats.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates several key statistics from the residuals of of a fit: the residual
  sum of squares (<code>RSS</code>), the mean squared error (<code>MSE</code>), the root
  mean squared error (<code>RMSE</code>), the residual standard error (<code>RSE</code>),
  and the Akaike information criterion (<code>AIC</code>). This function is used
  internally by all fitting functions in the <code>PhotoGEA</code> package, such as
  <code><a href="fit_ball_berry.html">fit_ball_berry</a></code> and <code><a href="fit_c3_aci.html">fit_c3_aci</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">residual_stats</span><span class="op">(</span><span class="va">fit_residuals</span>, <span class="va">units</span>, <span class="va">nparam</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-fit-residuals">fit_residuals<a class="anchor" aria-label="anchor" href="#arg-fit-residuals"></a></dt>
<dd><p>A numeric vector representing the residuals from a fit, i.e., the
    differences between the measured and fitted values.</p></dd>


  <dt id="arg-units">units<a class="anchor" aria-label="anchor" href="#arg-units"></a></dt>
<dd><p>A string expressing the units of the residuals.</p></dd>


  <dt id="arg-nparam">nparam<a class="anchor" aria-label="anchor" href="#arg-nparam"></a></dt>
<dd><p>The number of free parameters that were varied when performing the fit.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function calculates several model-independent measures of the quality of
  a fit. The basis for these statistics are the <code>residuals</code> (also known as
  the <code>errors</code>). If the measured values of a quantity <code>y</code> are given by
  <code>y_measured</code> and the fitted values are <code>y_fitted</code>, then the
  residuals are defined to be <code>residual = y_measured - y_fitted</code>. The key
  statistics that can be calculated from the residuals are as follows:</p><ul><li><p>The residual sum of squares (<code>RSS</code>) is also known as the sum of
          squared errors (<code>SSE</code>). As its name implies, it is simply the sum
          of all the squared residuals: <code>RSS = sum(residuals^2)</code>.</p></li>
<li><p>The mean squared error (<code>MSE</code>) is the mean value of the squared
          residuals: <code>MSE = sum(residuals^2) / n = RSS / n</code>, where <code>n</code>
          is the number of residuals.</p></li>
<li><p>The root mean squared error (<code>RMSE</code>) is the square root of the
          mean squared error: <code>RMSE = sqrt(MSE) = sqrt(RSS / n)</code>.</p></li>
<li><p>The residual standard error <code>RSE</code> is given by <code>RSE =
          sqrt(RSS / dof)</code>, where <code>dof = n - nparam</code> is the number of
          degrees of freedom involved in the fit.</p></li>
<li><p>The Akaike information criterion <code>AIC</code> is given by <code>AIC =
          npts * (log(2 * pi) + 1) + npts * log(MSE) + 2 * (nparam + 1)</code>.</p></li>
</ul><p>For a given model, the <code>RMSE</code> is usually a good way to compare the
  quality of different fits. When trying to decide which model best fits the
  measured data, the <code>AIC</code> may be a more appropriate metric since it
  controls for the number of parameters in the model.</p>
<p>The AIC definition used here is appropriate for the results of maximum
  likelihood fitting with equal variance, or minimum least squares fitting. For
  more details about the AIC equation above and its relation to the more general
  definition of AIC, see Section 2 of Banks &amp; Joyner (2017).</p>
<p><strong>References</strong>:</p>
<p>Banks, H. T. &amp; Joyner, M. L. "AIC under the framework of least squares
  estimation." Applied Mathematics Letters 74, 33–45 (2017)
  [<a href="https://doi.org/10.1016/j.aml.2017.05.005" class="external-link">doi:10.1016/j.aml.2017.05.005</a>
].</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An <code>exdf</code> object with one row and the following columns: <code>npts</code> (the
  number of residual values), <code>nparam</code>, <code>dof</code>, <code>RSS</code>, <code>MSE</code>,
  <code>RMSE</code>, <code>RSE</code>, <code>AIC</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Generate some random residuals</span></span></span>
<span class="r-in"><span><span class="va">residuals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate residual stats as if these values had units of `kg` and were related</span></span></span>
<span class="r-in"><span><span class="co"># to a model with 3 free parameters</span></span></span>
<span class="r-in"><span><span class="fu">residual_stats</span><span class="op">(</span><span class="va">residuals</span>, <span class="st">'kg'</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Converting an `exdf` object to a `data.frame` before printing</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   npts [residual_stats] (NA) nparam [residual_stats] (NA)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                         10                            3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   dof [residual_stats] (NA) RSS [residual_stats] ((kg)^2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                         7                      3.632105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   MSE [residual_stats] ((kg)^2) RMSE [residual_stats] (kg)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                     0.3632105                  0.6026695</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   RSE [residual_stats] (kg) AIC [residual_stats] ()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                 0.7203278                26.25104</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward B. Lochocki, Coralie E. Salesse-Smith, Justin M. McGrath.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

