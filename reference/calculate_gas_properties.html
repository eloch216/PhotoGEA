<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Calculates gas properties that are typically not included in Licor files. This
  function can accomodate alternative column names for the variables taken from
  the Licor file in case they change at some point in the future. This function
  also checks the units of each required column and will produce an error if any
  units are incorrect."><title>Calculate gas properties that are typically not included in Licor files — calculate_gas_properties • PhotoGEA</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate gas properties that are typically not included in Licor files — calculate_gas_properties"><meta property="og:description" content="Calculates gas properties that are typically not included in Licor files. This
  function can accomodate alternative column names for the variables taken from
  the Licor file in case they change at some point in the future. This function
  also checks the units of each required column and will produce an error if any
  units are incorrect."><meta property="og:image" content="https://eloch216.github.io/PhotoGEA/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    padding-top: 70px;

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PhotoGEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.11.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/PhotoGEA.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/analyzing_ball_berry_data.html">Analyzing Ball-Berry Data</a>
    <a class="dropdown-item" href="../articles/analyzing_c3_aci_curves.html">Analyzing C3 A-Ci Curves</a>
    <a class="dropdown-item" href="../articles/analyzing_c4_aci_curves.html">Analyzing C4 A-Ci Curves</a>
    <a class="dropdown-item" href="../articles/analyzing_gm_data.html">Analyzing Mesophyll Conductance Data</a>
    <a class="dropdown-item" href="../articles/analyzing_tdl_data.html">Analyzing TDL Data</a>
    <a class="dropdown-item" href="../articles/combining_with_other_packages.html">Combining PhotoGEA With Other Packages</a>
    <a class="dropdown-item" href="../articles/creating_your_own_processing_tools.html">Creating Your Own Processing Tools</a>
    <a class="dropdown-item" href="../articles/developing_a_data_analysis_pipeline.html">Developing a Data Analysis Pipeline</a>
    <a class="dropdown-item" href="../articles/working_with_extended_data_frames.html">Working With Extended Data Frames</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/eloch216/PhotoGEA/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Calculate gas properties that are typically not included in Licor files</h1>
      
      <div class="d-none name"><code>calculate_gas_properties.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates gas properties that are typically not included in Licor files. This
  function can accomodate alternative column names for the variables taken from
  the Licor file in case they change at some point in the future. This function
  also checks the units of each required column and will produce an error if any
  units are incorrect.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calculate_gas_properties</span><span class="op">(</span></span>
<span>    <span class="va">licor_exdf</span>,</span>
<span>    a_column_name <span class="op">=</span> <span class="st">'A'</span>,</span>
<span>    ca_column_name <span class="op">=</span> <span class="st">'Ca'</span>,</span>
<span>    total_pressure_column_name <span class="op">=</span> <span class="st">'total_pressure'</span>,</span>
<span>    e_column_name <span class="op">=</span> <span class="st">'E'</span>,</span>
<span>    gbw_column_name <span class="op">=</span> <span class="st">'gbw'</span>,</span>
<span>    gsw_column_name <span class="op">=</span> <span class="st">'gsw'</span>,</span>
<span>    h2o_s_column_name <span class="op">=</span> <span class="st">'H2O_s'</span>,</span>
<span>    tleaf_column_name <span class="op">=</span> <span class="st">'TleafCnd'</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>licor_exdf</dt>
<dd><p>An <code>exdf</code> object representing data from a Licor gas exchange
    measurement system.</p></dd>


  <dt>a_column_name</dt>
<dd><p>The name of the column in <code>licor_exdf</code> that contains the net
    assimilation in <code>micromol m^(-2) s^(-1)</code>.</p></dd>


  <dt>ca_column_name</dt>
<dd><p>The name of the column in <code>licor_exdf</code> that contains the ambient CO2
    concentration in the chamber in <code>micromol mol^(-1)</code>.</p></dd>


  <dt>total_pressure_column_name</dt>
<dd><p>The name of the column in <code>licor_exdf</code> that contains the total pressure
    in <code>bar</code>.</p></dd>


  <dt>e_column_name</dt>
<dd><p>The name of the column in <code>licor_exdf</code> that contains the transpiration
    rate in <code>mol m^(-2) s^(-1)</code>.</p></dd>


  <dt>gbw_column_name</dt>
<dd><p>The name of the column in <code>licor_exdf</code> that contains the boundary layer
    conductance to water vapor in <code>mol m^(-2) s^(-1)</code>.</p></dd>


  <dt>gsw_column_name</dt>
<dd><p>The name of the column in <code>licor_exdf</code> that contains the stomatal
    conductance to water vapor in <code>mol m^(-2) s^(-1)</code>.</p></dd>


  <dt>h2o_s_column_name</dt>
<dd><p>The name of the column in <code>licor_exdf</code> that contains the sample cell
    H2O concentration in <code>mmol mol^(-1)</code>.</p></dd>


  <dt>tleaf_column_name</dt>
<dd><p>The name of the column in <code>licor_exdf</code> that contains the leaf
    temperature in <code>degrees C</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>By default, a Licor file provides the following gas concentrations and
  conductances:</p><ul><li><p>Water vapor conductance to diffusion through the stomata (<code>gsw</code>).</p></li>
<li><p>Water vapor conductance to diffusion through the boundary layer
          (<code>gbw</code>).</p></li>
<li><p>Water vapor conductance to diffusion from the leaf's intercellular
          spaces to the ambient air; in other words, the total conductance to
          water vapor (<code>gtw</code>).</p></li>
<li><p>Water vapor concentration in the sample cell (<code>H2O_s</code>).</p></li>
<li><p>CO2 conductance to diffusion from the leaf's intercellular spaces to
          the ambient air; in other words, the total conductance to CO2
          (<code>gtc</code>).</p></li>
<li><p>CO2 concentration in the sample cell, corrected for any chamber leaks
         (<code>Ca</code>).</p></li>
<li><p>CO2 concentration in the leaf's intercellular spaces (<code>Ci</code>).</p></li>
</ul><p>However, it is sometimes helpful to know the "missing" conductances and
  concentrations, for example, when calculating mesophyll conductances or
  Ball-Berry parameters. This function adds these missing values, along with a
  few related water vapor properties:</p><ul><li><p>Water vapor concentration at the sample surface (<code>H2O_surf</code>).</p></li>
<li><p>Water vapor concentration in the leaf's intercellular spaces
          (<code>H2O_i</code>).</p></li>
<li><p>Saturation water vapor pressure at the leaf temperature
          (<code>SVPleaf</code>).</p></li>
<li><p>Relative humidity at the leaf surface (<code>RHleaf</code>).</p></li>
<li><p>CO2 conductance to diffusion through the stomata (<code>gsc</code>).</p></li>
<li><p>CO2 conductance to diffusion through the boundary layer (<code>gbc</code>).</p></li>
<li><p>CO2 concentration at the leaf surface (<code>Cs</code>).</p></li>
</ul><p><em>Equations used for these calculations</em></p>
<p>The equations used to calculate these quantities can be found in the Licor
  Li-6800 manual (Appendix C), which relies heavily on Appendix 2 of the
  following paper: von Caemmerer, S. &amp; Farquhar, G. D. "Some relationships
  between the biochemistry of photosynthesis and the gas exchange of leaves"
  Planta <strong>153</strong>, 376–387 (1981) [<a href="https://doi.org/10.1007/BF00384257" class="external-link">doi:10.1007/BF00384257</a>
]</p>
<p>Equation C-79 in the Licor manual describes the total flow of water vapor from
  the leaf interior to the ambient air using <code>gtw</code>, <code>H2O_i</code>,
  <code>H2O_s</code>, and the transpiration rate <code>E</code>:</p>
<p>(1) <code>gtw = E * (1000 - (H2O_i + H2O_s) / 2) / (H2O_i - H2O_s)</code></p>
<p>In steady-state conditions, the flux of H2O molecules across any portion of
  the gas flow is identical to <code>E</code>, so we can also apply this equation to
  the flow of water vapor from the leaf surface to the ambient air:</p>
<p>(2) <code>gbw = E * (1000 - (H2O_surf + H2O_s) / 2) / (H2O_surf - H2O_s)</code></p>
<p>Equation (2) can be solved for <code>H2O_surf</code>:</p>
<p>(3) <code>H2O_surf = (E * (1000 - H2O_s / 2) + gbw * H2O_s) / (gbw + E / 2)</code></p>
<p>Equation C-70 in the Licor manual describes how to calculate saturation water
  vapor pressure from air temperature. At the leaf surface, the air temperature
  should be the same as the leaf temperature (<code>Tleaf</code>; in degrees C), so we
  can determine <code>SVPleaf</code> using Equation C-70 as follows:</p>
<p>(4) <code>SVPleaf = 0.6135 * e^((17.502 * Tleaf) / (240.97 + Tleaf))</code></p>
<p>For gas exchange measurements, we assume that water vapor is saturated in the
  leaf's intecellular spaces, so we can determine <code>H2O_i</code> from
  <code>SVPleaf</code> and the relationship between partial pressure and molar gas
  concentration:</p>
<p>(5) <code>H2O_i = SVPleaf / Pcham = SVPleaf / (Pa + deltaPcham)</code></p>
<p>where <code>Pcham</code> is th total pressure in the sample chamber, <code>Pa</code> is
  the atmospheric pressure, and <code>deltaPcham</code> is the chamber overpressure.
  These are related by <code>Pcham = Pa + deltaPcham</code>.</p>
<p>The relative humidity at the leaf surface <code>RHleaf</code> can be determined from
  <code>H2O_surf</code> and <code>SVPleaf</code> using the definitions of relative humidity
  and partial pressure:</p>
<p>(6) <code>RHleaf = Pwl / SVPleaf = H2O_surf * (Pa + deltaPcham) / SVPleaf</code></p>
<p>where <code>Pwl</code>, the partial pressure of H2O at the leaf surface, is given by
  <code>H2O_surf * Pcham</code>.</p>
<p>The CO2 conductances through the stomata and boundary layer can be determined
  from the corresponding H2O conductances using the ratios of molecular
  diffusivities for the two molecules, as explained in the vicinty of Equation
  C-106 in the Licor manual:</p>
<p>(7) <code>gsc = gsw / 1.6</code></p>
<p>(8) <code>gbc = gbw / 1.37</code></p>
<p>Equation C-105 in the Licor manual describes the flow of CO2 from the ambient
  air to the intercellular spaces:</p>
<p>(9) <code>C_i = ((gtc - E / 2) * Ca - A) / (gtc + E / 2)</code></p>
<p>where we have replaced <code>C_s</code> (the CO2 concentration in the sample
  chamber) with <code>Ca</code> for clarity. In steady state conditions, the flows of
  H2O and CO2 are identical to <code>E</code> and <code>A</code>, respectively, so we can
  also apply this equation to the flow of CO2 from the ambient air to the leaf
  surface:</p>
<p>(10) <code>Csurface = ((gbc - E / 2) * Ca - A) / (gbc + E / 2)</code></p>
<p>This function uses Equations (3)-(8) and (10) to calculate the desired values.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An <code>exdf</code> object based on <code>licor_exdf</code> that includes the following
  additional columns, calculated as described above: <code>H2O_surf</code>,</p>
<p></p>
<p><code>SVPleaf</code>, <code>H2O_i</code>, <code>RHleaf</code>, <code>gsc</code>, <code>gbc</code>, and</p>
<p></p>
<p><code>Csurface</code>. The category for each of these new columns is</p>
<p></p>
<p><code>calculate_gas_properties</code> to indicate that they were created using this
  function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Read an example Licor file included in the PhotoGEA package, calculate the</span></span></span>
<span class="r-in"><span><span class="co"># total pressure, and calculate additional gas properties.</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_gasex_file.html">read_gasex_file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, <span class="st">'ball_berry_1.xlsx'</span>, package <span class="op">=</span> <span class="st">'PhotoGEA'</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_total_pressure.html">calculate_total_pressure</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu">calculate_gas_properties</span><span class="op">(</span><span class="va">licor_file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">licor_file</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">RHleaf</span>      <span class="co"># View the units of the new `RHleaf` column</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "%"</span>
<span class="r-in"><span><span class="va">licor_file</span><span class="op">$</span><span class="va">categories</span><span class="op">$</span><span class="va">RHleaf</span> <span class="co"># View the category of the new `RHleaf` column</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "calculate_gas_properties"</span>
<span class="r-in"><span><span class="va">licor_file</span><span class="op">[</span>,<span class="st">'RHleaf'</span><span class="op">]</span>        <span class="co"># View the values of the new `RHleaf` column</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 72.82992 73.97870 74.65520 73.30259 73.32851 73.76332 74.02142 83.24810</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] 82.76472 81.59332 82.83944 79.67378 79.80127 79.81986 81.01622 81.70109</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] 81.91860 81.55661 81.12870 78.16409 77.93890 76.56099 78.22673 78.97098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] 78.41431 78.65405 79.31713 76.73647</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Edward B. Lochocki.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

