<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate RL using the Laisk method — calculate_RL_laisk • PhotoGEA</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate RL using the Laisk method — calculate_RL_laisk"><meta name="description" content="Uses the Laisk method to estimate CiStar and RL. This function
  can accomodate alternative colum names for the variables taken from log files
  in case they change at some point in the future. This function also checks the
  units of each required column and will produce an error if any units are
  incorrect."><meta property="og:description" content="Uses the Laisk method to estimate CiStar and RL. This function
  can accomodate alternative colum names for the variables taken from log files
  in case they change at some point in the future. This function also checks the
  units of each required column and will produce an error if any units are
  incorrect."><meta property="og:image" content="https://eloch216.github.io/PhotoGEA/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    padding-top: 70px;

    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PhotoGEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/PhotoGEA.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/analyzing_ball_berry_data.html">Analyzing Ball-Berry Data</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_c3_aci_curves.html">Analyzing C3 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_c4_aci_curves.html">Analyzing C4 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_gm_data.html">Analyzing Mesophyll Conductance Data</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_tdl_data.html">Analyzing TDL Data</a></li>
    <li><a class="dropdown-item" href="../articles/combining_with_other_packages.html">Combining PhotoGEA With Other Packages</a></li>
    <li><a class="dropdown-item" href="../articles/creating_your_own_processing_tools.html">Creating Your Own Processing Tools</a></li>
    <li><a class="dropdown-item" href="../articles/developing_a_data_analysis_pipeline.html">Developing a Data Analysis Pipeline</a></li>
    <li><a class="dropdown-item" href="../articles/working_with_extended_data_frames.html">Working With Extended Data Frames</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/eloch216/PhotoGEA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Calculate RL using the Laisk method</h1>

      <div class="d-none name"><code>calculate_RL_laisk.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Uses the Laisk method to estimate <code>CiStar</code> and <code>RL</code>. This function
  can accomodate alternative colum names for the variables taken from log files
  in case they change at some point in the future. This function also checks the
  units of each required column and will produce an error if any units are
  incorrect.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calculate_RL_laisk</span><span class="op">(</span></span>
<span>    <span class="va">exdf_obj</span>,</span>
<span>    <span class="va">curve_id_column_name</span>,</span>
<span>    ci_lower <span class="op">=</span> <span class="fl">40</span>,</span>
<span>    ci_upper <span class="op">=</span> <span class="fl">120</span>,</span>
<span>    a_column_name <span class="op">=</span> <span class="st">'A'</span>,</span>
<span>    ci_column_name <span class="op">=</span> <span class="st">'Ci'</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-exdf-obj">exdf_obj<a class="anchor" aria-label="anchor" href="#arg-exdf-obj"></a></dt>
<dd><p>An <code>exdf</code> object.</p></dd>


  <dt id="arg-curve-id-column-name">curve_id_column_name<a class="anchor" aria-label="anchor" href="#arg-curve-id-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that can be used to split it into
    individual response curves.</p></dd>


  <dt id="arg-ci-lower">ci_lower<a class="anchor" aria-label="anchor" href="#arg-ci-lower"></a></dt>
<dd><p>Lower end of <code>Ci</code> range used for linear fits of <code>An</code> vs.
    <code>Ci</code>.</p></dd>


  <dt id="arg-ci-upper">ci_upper<a class="anchor" aria-label="anchor" href="#arg-ci-upper"></a></dt>
<dd><p>Upper end of <code>Ci</code> range used for linear fits of <code>An</code> vs.
    <code>Ci</code>.</p></dd>


  <dt id="arg-a-column-name">a_column_name<a class="anchor" aria-label="anchor" href="#arg-a-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the net CO2
    assimilation rate <code>An</code> in <code>micromol m^(-2) s^(-1)</code>.</p></dd>


  <dt id="arg-ci-column-name">ci_column_name<a class="anchor" aria-label="anchor" href="#arg-ci-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the
    intercellular CO2 concentration <code>Ci</code> in <code>micromol mol^(-1)</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The Laisk method is a way to estimate <code>RL</code> and <code>CiStar</code> for a C3
  plant. Definitions of these quantities and a description of the theory
  underpinning this method is given below.</p>
<p>For a C3 plant, the net CO2 assimilation rate <code>An</code> is given by</p>
<p><code>An = Vc - Rp - RL</code>,</p>
<p>where <code>Vc</code> is the rate of RuBP carboxylation, <code>Rp</code> is the rate of
  carbon loss due to photorespiration, and <code>RL</code> is the rate of carbon loss
  due to non-photorespiratory respiration (also known as the rate of day
  respiration). Because RuBP carboxylation and photorespiration both occur due
  to Rubisco activity, these rates are actually proportional to each other:</p>
<p><code>Rp = Vc * GammaStar / Cc</code>,</p>
<p>where <code>Cc</code> is the CO2 concentration in the chloroplast (where Rubisco is
  located) and <code>GammaStar</code> will be discussed below. Using this expression,
  the net CO2 assimilation rate can be written as</p>
<p><code>An = Vc * (1 - GammaStar / Cc) - RL</code>.</p>
<p>When <code>Cc</code> is equal to <code>GammaStar</code>, the net assimilation rate is
  equal to <code>-RL</code>. For this reason, <code>GammaStar</code> is usually referred to
  as the CO2 compensation point in the absence of day respiration.</p>
<p>In general, <code>Cc</code> is related to the intercellular CO2 concentration
  <code>Ci</code> according to</p>
<p><code>Ci = Cc + An / gmc</code>,</p>
<p>where <code>gmc</code> is the mesophyll conductance to CO2 diffusion. When <code>Cc</code>
  is equal to <code>GammaStar</code>, we therefore have
  <code>Ci = GammaStar - RL / gmc</code>. This special value of <code>Ci</code> is referred
  to as <code>CiStar</code>, and can be understood as the value of <code>Ci</code> where
  <code>Cc = GammaStar</code> and <code>An = -RL</code>. Note that the values of
  <code>GammaStar</code> and <code>CiStar</code> depend on Rubisco properties, mesophyll
  conductance, and the ambient O2 concentration, but not on the incident light
  intensity.</p>
<p>These observations suggest a method for estimating <code>RL</code> from a leaf:
  Measure <code>An</code> vs. <code>Ci</code> curves at several light intensities, and find
  the value of <code>Ci</code> where the curves intersect with each other. This will
  be <code>CiStar</code>, and the corresponding value of <code>An</code> will be equal to
  <code>-RL</code>.</p>
<p>In practice, it is unlikely that the measured curves will all exactly
  intersect at a single point. In <code>calculate_RL_laisk</code>, the value of
  <code>CiStar</code> is chosen as the value of <code>Ci</code> that minimizes the variance
  of the corresponding <code>An</code> values. It is also unlikely that any of the
  measured points exactly correspond to <code>Ci = CiStar</code>, so
  <code>calculate_RL_laisk</code> uses a linear fit of each curve at low <code>Ci</code> to
  find <code>An</code> at arbitrary values of <code>Ci</code>.</p>
<p>Note: it is possible that <code>RL</code> depends on incident light intensity, an
  issue which complicates the application of the Laisk method.</p>
<p>References:</p>
<p>Yin, X., Sun, Z., Struik, P. C. &amp; Gu, J. "Evaluating a new method to estimate
  the rate of leaf respiration in the light by analysis of combined gas exchange
  and chlorophyll fluorescence measurements." Journal of Experimental Botany 62,
  3489–3499 (2011) [<a href="https://doi.org/10.1093/jxb/err038" class="external-link">doi:10.1093/jxb/err038</a>
].</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>This function returns a list with the following named elements:</p><ul><li><p><code>Ci_star</code>: The estimated value of <code>CiStar</code>.</p></li>
<li><p><code>RL</code>: The estimated value of <code>RL</code>.</p></li>
<li><p><code>parameters</code>: An <code>exdf</code> object with the slope and intercept
          of each linear fit used to estimate <code>Ci_star</code> and <code>RL</code>.</p></li>
<li><p><code>fits</code>: An <code>exdf</code> object based on <code>exdf_obj</code> that also
          includes the fitted values of <code>An</code> in a new column whose name is
          <code>a_column_name</code> followed by <code>_fit</code> (for example,
          <code>A_fit</code>).</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Read an example Licor file included in the PhotoGEA package</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_gasex_file.html">read_gasex_file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="PhotoGEA_example_file_path.html">PhotoGEA_example_file_path</a></span><span class="op">(</span><span class="st">'c3_aci_1.xlsx'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define a new column that uniquely identifies each curve</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species_plot'</span><span class="op">]</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species'</span><span class="op">]</span>, <span class="st">'-'</span>, <span class="va">licor_file</span><span class="op">[</span>, <span class="st">'plot'</span><span class="op">]</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Organize the data</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="organize_response_curve_data.html">organize_response_curve_data</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">licor_file</span>,</span></span>
<span class="r-in"><span>    <span class="st">'species_plot'</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">'CO2_r_sp'</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Apply the Laisk method. Note: this is a bad example because these curves were</span></span></span>
<span class="r-in"><span><span class="co"># measured at the same light intensity, but from different species. Because of</span></span></span>
<span class="r-in"><span><span class="co"># this, the results are not meaningful.</span></span></span>
<span class="r-in"><span><span class="va">laisk_results</span> <span class="op">&lt;-</span> <span class="fu">calculate_RL_laisk</span><span class="op">(</span><span class="va">licor_file</span>, <span class="st">'species_plot'</span>, <span class="fl">20</span>, <span class="fl">150</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get estimated values</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">laisk_results</span><span class="op">$</span><span class="va">RL</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.617453</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">laisk_results</span><span class="op">$</span><span class="va">Ci_star</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 69.37657</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot each curve and overlay the calculated point of intersection as a filled</span></span></span>
<span class="r-in"><span><span class="co"># red circle</span></span></span>
<span class="r-in"><span><span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">A</span> <span class="op">~</span> <span class="va">Ci</span>,</span></span>
<span class="r-in"><span>  group <span class="op">=</span> <span class="va">species_plot</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">laisk_results</span><span class="op">$</span><span class="va">fits</span><span class="op">$</span><span class="va">main_data</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">'b'</span>,</span></span>
<span class="r-in"><span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  panel <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/panel.xyplot.html" class="external-link">panel.xyplot</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></span>
<span class="r-in"><span>      <span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/llines.html" class="external-link">panel.points</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>          <span class="op">-</span><span class="va">laisk_results</span><span class="op">$</span><span class="va">RL</span> <span class="op">~</span> <span class="va">laisk_results</span><span class="op">$</span><span class="va">Ci_star</span>,</span></span>
<span class="r-in"><span>          type <span class="op">=</span> <span class="st">'p'</span>,</span></span>
<span class="r-in"><span>          col <span class="op">=</span> <span class="st">'red'</span>,</span></span>
<span class="r-in"><span>          pch <span class="op">=</span> <span class="fl">16</span></span></span>
<span class="r-in"><span>      <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="calculate_RL_laisk-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot each curve and its linear fit</span></span></span>
<span class="r-in"><span><span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">A_fit</span> <span class="op">+</span> <span class="va">A</span> <span class="op">~</span> <span class="va">Ci</span> <span class="op">|</span> <span class="va">species_plot</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">laisk_results</span><span class="op">$</span><span class="va">fits</span><span class="op">$</span><span class="va">main_data</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">'b'</span>,</span></span>
<span class="r-in"><span>  pch <span class="op">=</span> <span class="fl">16</span>,</span></span>
<span class="r-in"><span>  auto <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="calculate_RL_laisk-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward B. Lochocki.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

