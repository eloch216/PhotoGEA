<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Uses the method from Warren et al. (2003) to estimate the relative limitations
  to C3 photosynthesis due to stomatal conductance and mesophyll conductance.
  This function can accomodate alternative column names for the variables taken
  from the data file in case they change at some point in the future. This
  function also checks the units of each required column and will produce an
  error if any units are incorrect."><title>Estimate the relative limiting factors to C3 photosynthesis — calculate_c3_limitations_warren • PhotoGEA</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate the relative limiting factors to C3 photosynthesis — calculate_c3_limitations_warren"><meta property="og:description" content="Uses the method from Warren et al. (2003) to estimate the relative limitations
  to C3 photosynthesis due to stomatal conductance and mesophyll conductance.
  This function can accomodate alternative column names for the variables taken
  from the data file in case they change at some point in the future. This
  function also checks the units of each required column and will produce an
  error if any units are incorrect."><meta property="og:image" content="https://eloch216.github.io/PhotoGEA/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    padding-top: 70px;

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PhotoGEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.10.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/PhotoGEA.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/analyzing_ball_berry_data.html">Analyzing Ball-Berry Data</a>
    <a class="dropdown-item" href="../articles/analyzing_c3_aci_curves.html">Analyzing C3 A-Ci Curves</a>
    <a class="dropdown-item" href="../articles/analyzing_c4_aci_curves.html">Analyzing C4 A-Ci Curves</a>
    <a class="dropdown-item" href="../articles/analyzing_gm_data.html">Analyzing Mesophyll Conductance Data</a>
    <a class="dropdown-item" href="../articles/analyzing_tdl_data.html">Analyzing TDL Data</a>
    <a class="dropdown-item" href="../articles/combining_with_other_packages.html">Combining PhotoGEA With Other Packages</a>
    <a class="dropdown-item" href="../articles/creating_your_own_processing_tools.html">Creating Your Own Processing Tools</a>
    <a class="dropdown-item" href="../articles/developing_a_data_analysis_pipeline.html">Developing a Data Analysis Pipeline</a>
    <a class="dropdown-item" href="../articles/working_with_extended_data_frames.html">Working With Extended Data Frames</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/eloch216/PhotoGEA/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Estimate the relative limiting factors to C3 photosynthesis</h1>
      
      <div class="d-none name"><code>calculate_c3_limitations_warren.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Uses the method from Warren et al. (2003) to estimate the relative limitations
  to C3 photosynthesis due to stomatal conductance and mesophyll conductance.
  This function can accomodate alternative column names for the variables taken
  from the data file in case they change at some point in the future. This
  function also checks the units of each required column and will produce an
  error if any units are incorrect.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calculate_c3_limitations_warren</span><span class="op">(</span></span>
<span>    <span class="va">exdf_obj</span>,</span>
<span>    POc <span class="op">=</span> <span class="fl">210000</span>,</span>
<span>    atp_use <span class="op">=</span> <span class="fl">4.0</span>,</span>
<span>    nadph_use <span class="op">=</span> <span class="fl">8.0</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.0</span>,</span>
<span>    curvature_cj <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span>    curvature_cjp <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span>    ca_column_name <span class="op">=</span> <span class="st">'Ca'</span>,</span>
<span>    cc_column_name <span class="op">=</span> <span class="st">'Cc'</span>,</span>
<span>    ci_column_name <span class="op">=</span> <span class="st">'Ci'</span>,</span>
<span>    gamma_star_column_name <span class="op">=</span> <span class="st">'Gamma_star'</span>,</span>
<span>    j_column_name <span class="op">=</span> <span class="st">'J_at_25'</span>,</span>
<span>    j_norm_column_name <span class="op">=</span> <span class="st">'J_norm'</span>,</span>
<span>    kc_column_name <span class="op">=</span> <span class="st">'Kc'</span>,</span>
<span>    ko_column_name <span class="op">=</span> <span class="st">'Ko'</span>,</span>
<span>    rd_column_name <span class="op">=</span> <span class="st">'Rd_at_25'</span>,</span>
<span>    rd_norm_column_name <span class="op">=</span> <span class="st">'Rd_norm'</span>,</span>
<span>    total_pressure_column_name <span class="op">=</span> <span class="st">'total_pressure'</span>,</span>
<span>    tpu_column_name <span class="op">=</span> <span class="st">'TPU'</span>,</span>
<span>    vcmax_column_name <span class="op">=</span> <span class="st">'Vcmax_at_25'</span>,</span>
<span>    vcmax_norm_column_name <span class="op">=</span> <span class="st">'Vcmax_norm'</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>exdf_obj</dt>
<dd><p>An <code>exdf</code> object representing gas exchange data.</p></dd>


  <dt>POc</dt>
<dd><p>The partial pressure of O2 in the chloroplast, expressed in <code>microbar</code>.
    This is often assumed to be the ambient value. For air measurements, this
    would be 21 percent O2, which is about 210000 microbar at standard
    atmospheric pressure. For low oxygen measurements, this would be 2 percent
    O2, which is about 20000 microbar.</p></dd>


  <dt>atp_use</dt>
<dd><p>The number of ATP molecules used per C3 cycle.</p></dd>


  <dt>nadph_use</dt>
<dd><p>The number of NADPH molecules used per C3 cycle.</p></dd>


  <dt>alpha</dt>
<dd><p>A dimensionless parameter greater than or equal to 0 and less than or equal
    to 1 that represents the fraction of glycolate carbon not returned to the
    chloroplast.</p></dd>


  <dt>curvature_cj</dt>
<dd><p>A dimensionless quadratic curvature parameter greater than or equal to 0 and
    less than or equal to 1 that sets the degree of co-limitation between
    <code>Wc</code> and <code>Wj</code>. A value of 1 indicates no co-limitation.</p></dd>


  <dt>curvature_cjp</dt>
<dd><p>A dimensionless quadratic curvature parameter greater than or equal to 0 and
    less than or equal to 1 that sets the degree of co-limitation between
    <code>Wcj</code> and <code>Wp</code>. A value of 1 indicates no co-limitation.</p></dd>


  <dt>ca_column_name</dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the ambient
    CO2 concentration in <code>micromol mol^(-1)</code>.</p></dd>


  <dt>cc_column_name</dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the chloroplastic
    CO2 concentration in <code>micromol mol^(-1)</code>. Typically these are
    calculated using <code><a href="apply_gm.html">apply_gm</a></code>.</p></dd>


  <dt>ci_column_name</dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the intercellular
    CO2 concentration in <code>micromol mol^(-1)</code>.</p></dd>


  <dt>gamma_star_column_name</dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the
    <code>Gamma_star</code> values in <code>micromol mol^(-1)</code>. Typically these are
    the leaf-temperature dependent values calculated using
    <code><a href="calculate_arrhenius.html">calculate_arrhenius</a></code>.</p></dd>


  <dt>j_column_name</dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains values of the
    RuBP regeneration rate (<code>J</code>) in <code>micromol m^(-2) s^(-1)</code> at 25
    degrees C.</p></dd>


  <dt>j_norm_column_name</dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the normalized
    <code>J</code> values (with units of <code>normalized to J at 25 degrees C</code>).
    Typically these are the leaf-temperature dependent values calculated using
    <code><a href="calculate_arrhenius.html">calculate_arrhenius</a></code>.</p></dd>


  <dt>kc_column_name</dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the
    Michaelis-Menten constant for rubisco carboxylation in
    <code>micromol mol^(-1)</code>. Typically these are the leaf-temperature dependent
    values calculated using <code><a href="calculate_arrhenius.html">calculate_arrhenius</a></code>.</p></dd>


  <dt>ko_column_name</dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the
    Michaelis-Menten constant for rubisco oxygenation in
    <code>mmol mol^(-1)</code>. Typically these are the leaf-temperature dependent
    values calculated using <code><a href="calculate_arrhenius.html">calculate_arrhenius</a></code>.</p></dd>


  <dt>rd_column_name</dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains values of the day
    respiration rate (<code>Rd</code>) in <code>micromol m^(-2) s^(-1)</code> at 25 degrees
    C.</p></dd>


  <dt>rd_norm_column_name</dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the normalized
    <code>Rd</code> values (with units of <code>normalized to Rd at 25 degrees C</code>).</p></dd>


  <dt>total_pressure_column_name</dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the total pressure
    in <code>bar</code>. Typically this is calculated using
    <code><a href="calculate_total_pressure.html">calculate_total_pressure</a></code>.</p></dd>


  <dt>tpu_column_name</dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the rate of triose
    phosphate utilization in <code>micromol m^(-2) s^(-1)</code>.</p></dd>


  <dt>vcmax_column_name</dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the maximum rate of
    Rubisco carboxylation (<code>Vcmax</code>) in <code>micromol m^(-2) s^(-1)</code> at 25
    degrees C.</p></dd>


  <dt>vcmax_norm_column_name</dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the normalized
    <code>Vcmax</code> values (with units of
    <code>normalized to Vcmax at 25 degrees C</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When analyzing or interpreting C3 gas exchange data, it is often useful to
  estimate the relative limitations to assimilation that are due to stomatal
  conductance or mesophyll conductance. This can be done using a framework first
  introduced by Warren et al. (2003). In this framework, the relative limitation
  due to stomatal conductance (<code>ls</code>) is</p>
<p><code>ls = (An_inf_gsc - A_modeled) / An_inf_gsc</code></p>
<p>and the relative limitation due to mesophyll conductance (<code>lm</code>) is</p>
<p><code>lm = (An_inf_gmc - A_modeled) / An_inf_gmc</code>. These are equations 10 and
  11 in Warren et al. (2003).</p>
<p>In these equations <code>A_modeled</code> is the net assimilation rate calculated
  using the Farquhar-von-Caemmerer-Berry (FvCB) model at the measured value of
  the chloroplast CO2 concentration (<code>Cc</code>). The other two assimilation
  rates (<code>An_inf_gsc</code> and <code>An_inf_gmc</code>) are also calculated using the
  FvCB model, but under different assumptions: <code>An_inf_gsc</code> assumes that
  stomatal conductance is infinite while mesophyll conductance is as measured,
  while <code>An_inf_gmc</code> assumes that mesophyll conductance is infinite while
  stomatal conductance is as measured.</p>
<p>In other words, <code>ls</code> expresses the observed assimilation rate as a
  fractional decrease relative to a hypothetical plant with infinite stomatal
  conductance, while <code>lm</code> expresses the observed assimilation rate as a
  fractional decrease relative to a hypothetical plant with infinite mesophyll
  conductance.</p>
<p>For example, if <code>lm = 0.4</code>, this means that the observed assimilation
  rate is 40 percet lower than a hypothetical plant with infinite mesophyll
  conductance. If mesophyll conductance were to increase (all else remaining
  the same), then <code>lm</code> would decrease. This is not the case with other
  estimations of limiting factors, such as the one used in
  <code><a href="calculate_c3_limitations_grassi.html">calculate_c3_limitations_grassi</a></code>. (See Leverett &amp; Kromdijk for
  more details.)</p>
<p>To actually calculate <code>An_inf_gsc</code> and <code>An_inf_gmc</code>, it is first
  necessary to estimate the corresponding values of <code>Cc</code> that would occur
  with infinite stomatal or mesophyll conductance. This can be done with a 1D
  diffusion equation expressed using drawdown values:</p>
<p><code>Cc = Ca - drawdown_cs - drawdown_cm</code>,</p>
<p>where <code>drawdown_cs = Ca - Ci</code> is the drawdown of CO2 across the stomata
  (assuming infinite boundary layer conductance) and
  <code>drawdown_cm = Ci - Cc</code> is the drawdown of CO2 across the mesophyll. If
  one conductance is infinite, the corresponding drawdown becomes zero. Thus, we
  have:</p>
<p><code>Cc_inf_gsc = Ca - 0 - (Ci - Cc) = Ca - Ci + Cc</code></p>
<p>and</p>
<p><code>Cc_inf_gmc = Ca - (Ca - Ci) - 0 = Ci</code>,</p>
<p>where <code>Cc_inf_gsc</code> is the value of <code>Cc</code> that would occur with
  infinite stomatal conductance and the measured mesophyll conductance, and
  <code>Cc_inf_gmc</code> is the value of <code>Cc</code> that would occur with infinite
  mesophyll conductance and the measured stomatal conductance.</p>
<p>Once values of <code>Cc</code>, <code>Cc_inf_gsc</code>, and <code>Cc_inf_gmc</code>, the
  corresponding assimilation rates are calculated using
  <code><a href="calculate_c3_assimilation.html">calculate_c3_assimilation</a></code>, and then the limitation factors are
  calculated as described above.</p>
<p>References:</p>
<p>Warren, C. R. et al. "Transfer conductance in second growth Douglas-fir
  (Pseudotsuga menziesii (Mirb.)Franco) canopies." Plant, Cell &amp; Environment 26,
  1215–1227 (2003) [<a href="https://doi.org/10.1046/j.1365-3040.2003.01044.x" class="external-link">doi:10.1046/j.1365-3040.2003.01044.x</a>
].</p>
<p>Leverett, A. &amp; Kromdijk, J. "The long and tortuous path towards improving
  photosynthesis by engineering elevated mesophyll conductance."
  [<a href="https://doi.org/10.22541/au.170016201.13513761/v1" class="external-link">doi:10.22541/au.170016201.13513761/v1</a>
].</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>This function returns an <code>exdf</code> object based on <code>exdf_obj</code> but with
  several new columns representing the quantities discussed above:</p>
<p></p>
<p><code>Cc_inf_gsc</code>, <code>Cc_inf_gmc</code>, <code>An_inf_gsc</code>, <code>An_inf_gmc</code>,</p>
<p></p>
<p><code>ls_warren</code>, and <code>lm_warren</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Read an example Licor file included in the PhotoGEA package</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_gasex_file.html">read_gasex_file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, <span class="st">'c3_aci_1.xlsx'</span>, package <span class="op">=</span> <span class="st">'PhotoGEA'</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define a new column that uniquely identifies each curve</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species_plot'</span><span class="op">]</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species'</span><span class="op">]</span>, <span class="st">'-'</span>, <span class="va">licor_file</span><span class="op">[</span>, <span class="st">'plot'</span><span class="op">]</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Organize the data</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="organize_response_curve_data.html">organize_response_curve_data</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">licor_file</span>,</span></span>
<span class="r-in"><span>    <span class="st">'species_plot'</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">'CO2_r_sp'</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Specify mesophyll conductance</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="set_variable.html">set_variable</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">licor_file</span>,</span></span>
<span class="r-in"><span>  <span class="st">'gmc'</span>, <span class="st">'mol m^(-2) s^(-1) bar^(-1)'</span>, value <span class="op">=</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate the total pressure in the Licor chamber</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_total_pressure.html">calculate_total_pressure</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate additional gas properties</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_gas_properties.html">calculate_gas_properties</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate Cc</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="apply_gm.html">apply_gm</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate temperature-dependent values of C3 photosynthetic parameters</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_arrhenius.html">calculate_arrhenius</a></span><span class="op">(</span><span class="va">licor_file</span>, <span class="va">c3_arrhenius_bernacchi</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit all curves in the data set</span></span></span>
<span class="r-in"><span><span class="va">aci_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="consolidate.html">consolidate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">licor_file</span>,</span></span>
<span class="r-in"><span>  <span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species_plot'</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  <span class="va">fit_c3_aci</span>,</span></span>
<span class="r-in"><span>  Ca_atmospheric <span class="op">=</span> <span class="fl">420</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get a subset of fitting results corresponding to the first measured point</span></span></span>
<span class="r-in"><span><span class="co"># in each curve (where CO2_r_sp = 400 ppm)</span></span></span>
<span class="r-in"><span><span class="va">aci_fit_subset</span> <span class="op">&lt;-</span> <span class="va">aci_results</span><span class="op">$</span><span class="va">fits</span><span class="op">[</span><span class="va">aci_results</span><span class="op">$</span><span class="va">fits</span><span class="op">[</span>, <span class="st">'CO2_r_sp'</span><span class="op">]</span> <span class="op">==</span> <span class="fl">400</span>, , <span class="cn">TRUE</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate limiting factors</span></span></span>
<span class="r-in"><span><span class="va">aci_fit_subset</span> <span class="op">&lt;-</span> <span class="fu">calculate_c3_limitations_warren</span><span class="op">(</span><span class="va">aci_fit_subset</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View the limiting factors for each species / plot</span></span></span>
<span class="r-in"><span><span class="va">col_to_keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">'species'</span>, <span class="st">'plot'</span>,       <span class="co"># identifiers</span></span></span>
<span class="r-in"><span>  <span class="st">'ls_warren'</span>, <span class="st">'lm_warren'</span> <span class="co"># limitation info</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">aci_fit_subset</span><span class="op">[</span> , <span class="va">col_to_keep</span>, <span class="cn">TRUE</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    species [UserDefCon] (NA) plot [UserDefCon] (NA)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8                    soybean                     5a</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21                   tobacco                      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34                   tobacco                      2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ls_warren [calculate_c3_limitations_warren] (dimensionless)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8                                                    0.8230455</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21                                                   0.2632085</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34                                                   0.3086578</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    lm_warren [calculate_c3_limitations_warren] (dimensionless)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8                                                    0.6894644</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21                                                   0.1977779</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34                                                   0.2381895</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Display as a bar chart</span></span></span>
<span class="r-in"><span><span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">barchart</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">ls_warren</span> <span class="op">+</span> <span class="va">lm_warren</span> <span class="op">~</span> <span class="va">species_plot</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">aci_fit_subset</span><span class="op">$</span><span class="va">main</span>,</span></span>
<span class="r-in"><span>  stack <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  auto <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  ylab <span class="op">=</span> <span class="st">'Factors limiting assimilation'</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="calculate_c3_limitations_warren-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Edward B. Lochocki.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

