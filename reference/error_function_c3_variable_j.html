<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Creates a function that returns an error value (the sum of squared residuals)
  representing the amount of agreement between modeled and measured An
  values."><title>Generate an error function for C3 Variable J curve fitting — error_function_c3_variable_j • PhotoGEA</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate an error function for C3 Variable J curve fitting — error_function_c3_variable_j"><meta property="og:description" content="Creates a function that returns an error value (the sum of squared residuals)
  representing the amount of agreement between modeled and measured An
  values."><meta property="og:image" content="https://eloch216.github.io/PhotoGEA/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    padding-top: 70px;

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PhotoGEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/PhotoGEA.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/analyzing_ball_berry_data.html">Analyzing Ball-Berry Data</a>
    <a class="dropdown-item" href="../articles/analyzing_c3_aci_curves.html">Analyzing C3 A-Ci Curves</a>
    <a class="dropdown-item" href="../articles/analyzing_c4_aci_curves.html">Analyzing C4 A-Ci Curves</a>
    <a class="dropdown-item" href="../articles/analyzing_gm_data.html">Analyzing Mesophyll Conductance Data</a>
    <a class="dropdown-item" href="../articles/analyzing_tdl_data.html">Analyzing TDL Data</a>
    <a class="dropdown-item" href="../articles/combining_with_other_packages.html">Combining PhotoGEA With Other Packages</a>
    <a class="dropdown-item" href="../articles/creating_your_own_processing_tools.html">Creating Your Own Processing Tools</a>
    <a class="dropdown-item" href="../articles/developing_a_data_analysis_pipeline.html">Developing a Data Analysis Pipeline</a>
    <a class="dropdown-item" href="../articles/working_with_extended_data_frames.html">Working With Extended Data Frames</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/eloch216/PhotoGEA/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Generate an error function for C3 Variable J curve fitting</h1>
      
      <div class="d-none name"><code>error_function_c3_variable_j.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates a function that returns an error value (the sum of squared residuals)
  representing the amount of agreement between modeled and measured <code>An</code>
  values.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">error_function_c3_variable_j</span><span class="op">(</span></span>
<span>    <span class="va">replicate_exdf</span>,</span>
<span>    fit_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    sd_A <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    atp_use <span class="op">=</span> <span class="fl">4.0</span>,</span>
<span>    nadph_use <span class="op">=</span> <span class="fl">8.0</span>,</span>
<span>    curvature_cj <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span>    curvature_cjp <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span>    a_column_name <span class="op">=</span> <span class="st">'A'</span>,</span>
<span>    ci_column_name <span class="op">=</span> <span class="st">'Ci'</span>,</span>
<span>    j_norm_column_name <span class="op">=</span> <span class="st">'J_norm'</span>,</span>
<span>    kc_column_name <span class="op">=</span> <span class="st">'Kc'</span>,</span>
<span>    ko_column_name <span class="op">=</span> <span class="st">'Ko'</span>,</span>
<span>    oxygen_column_name <span class="op">=</span> <span class="st">'oxygen'</span>,</span>
<span>    phips2_column_name <span class="op">=</span> <span class="st">'PhiPS2'</span>,</span>
<span>    qin_column_name <span class="op">=</span> <span class="st">'Qin'</span>,</span>
<span>    rd_norm_column_name <span class="op">=</span> <span class="st">'Rd_norm'</span>,</span>
<span>    total_pressure_column_name <span class="op">=</span> <span class="st">'total_pressure'</span>,</span>
<span>    vcmax_norm_column_name <span class="op">=</span> <span class="st">'Vcmax_norm'</span>,</span>
<span>    cj_crossover_min <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    cj_crossover_max <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    require_positive_gmc <span class="op">=</span> <span class="st">'all'</span>,</span>
<span>    gmc_max <span class="op">=</span> <span class="cn">Inf</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>replicate_exdf</dt>
<dd><p>An <code>exdf</code> object representing one CO2 response curve.</p></dd>


  <dt>fit_options</dt>
<dd><p>A list of named elements representing fit options to use for each parameter.
    Values supplied here override the default values (see details below). Each
    element must be <code>'fit'</code>, <code>'column'</code>, or a numeric value. A value
    of <code>'fit'</code> means that the parameter will be fit; a value of
    <code>'column'</code> means that the value of the parameter will be taken from a
    column in <code>replicate_exdf</code> of the same name; and a numeric value means
    that the parameter will be set to that value. For example,
    <code>fit_options = list(alpha_g = 0, Vcmax_at_25 = 'fit', Tp = 'column')</code>
    means that <code>alpha_g</code> will be set to 0, <code>Vcmax_at_25</code> will be fit,
    and <code>Tp</code> will be set to the values in the <code>Tp</code> column of
    <code>replicate_exdf</code>.</p></dd>


  <dt>sd_A</dt>
<dd><p>The standard deviation of the measured values of the net CO2 assimilation
    rate, expressed in units of <code>micromol m^(-2) s^(-1)</code>. If
    <code>sd_A</code> is not a number, then there must be a column in <code>exdf_obj</code>
    called <code>sd_A</code> with appropriate units. A numeric value supplied here
    will overwrite the values in the <code>sd_A</code> column of <code>exdf_obj</code> if it
    exists.</p></dd>


  <dt>atp_use</dt>
<dd><p>The number of ATP molecules used per C3 cycle.</p></dd>


  <dt>nadph_use</dt>
<dd><p>The number of NADPH molecules used per C3 cycle.</p></dd>


  <dt>curvature_cj</dt>
<dd><p>A dimensionless quadratic curvature parameter greater than or equal to 0 and
    less than or equal to 1 that sets the degree of co-limitation between
    <code>Wc</code> and <code>Wj</code>. A value of 1 indicates no co-limitation.</p></dd>


  <dt>curvature_cjp</dt>
<dd><p>A dimensionless quadratic curvature parameter greater than or equal to 0 and
    less than or equal to 1 that sets the degree of co-limitation between
    <code>Wcj</code> and <code>Wp</code>. A value of 1 indicates no co-limitation.</p></dd>


  <dt>a_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the net
    assimilation in <code>micromol m^(-2) s^(-1)</code>.</p></dd>


  <dt>ci_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the
    intercellular CO2 concentration in <code>micromol mol^(-1)</code>.</p></dd>


  <dt>j_norm_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the normalized
    <code>J</code> values (with units of <code>normalized to J at 25 degrees C</code>).</p></dd>


  <dt>kc_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the
    Michaelis-Menten constant for rubisco carboxylation in
    <code>micromol mol^(-1)</code>.</p></dd>


  <dt>ko_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the
    Michaelis-Menten constant for rubisco oxygenation in
    <code>mmol mol^(-1)</code>.</p></dd>


  <dt>oxygen_column_name</dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the concentration
    of O2 in the ambient air, expressed as a percentage (commonly 21% or 2%);
    the units must be <code>percent</code>.</p></dd>


  <dt>phips2_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains values of the
    operating efficiency of photosystem II (dimensionless).</p></dd>


  <dt>qin_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains values of the
    incident photosynthetically active flux density in
    <code>micromol m^(-2) s^(-1)</code>.</p></dd>


  <dt>rd_norm_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the normalized
    <code>Rd</code> values (with units of <code>normalized to Rd at 25 degrees C</code>).</p></dd>


  <dt>total_pressure_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the total
    pressure in <code>bar</code>.</p></dd>


  <dt>vcmax_norm_column_name</dt>
<dd><p>The name of the column in <code>replicate_exdf</code> that contains the normalized
    <code>Vcmax</code> values (with units of
    <code>normalized to Vcmax at 25 degrees C</code>).</p></dd>


  <dt>cj_crossover_min</dt>
<dd><p>The minimum value of <code>Cc</code> (in ppm) where <code>Aj</code> is allowed to become
    the overall rate-limiting factor. If <code>cj_crossover_min</code> is set to
    <code>NA</code>, this restriction will not be applied.</p></dd>


  <dt>cj_crossover_max</dt>
<dd><p>The maximim value of <code>Cc</code> (in ppm) where <code>Wj</code> is allowed to be
    smaller than <code>Wc</code>. If <code>cj_crossover_max</code> is set to <code>NA</code>, this
    restriction will not be applied.</p></dd>


  <dt>require_positive_gmc</dt>
<dd><p>A character string specifying the method to be used for requiring positive
    values of mesophyll conductance. Can be <code>'none'</code>, <code>'all'</code>, or
    <code>'positive_a'</code>. See below for more details.</p></dd>


  <dt>gmc_max</dt>
<dd><p>The maximum value of mesophyll conductance that should be considered to be
    acceptable. See below for more details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When fitting A-Ci + chlorophyll fluorescence curves using the Variable J
  method, it is necessary to define a function that calculates the likelihood
  of a given set of <code>alpha_g</code>, <code>Gamma_star</code>, <code>J_at_25</code>,
  <code>Rd_at_25</code>, <code>tau</code>, <code>Tp</code>, and <code>Vcmax_at_25</code> values by
  comparing a model prediction to a measured curve. This function will be passed
  to an optimization algorithm which will determine the values that produce the
  smallest error.</p>
<p>The <code>error_function_c3_variable_j</code> returns such a function, which is
  based on a particular replicate and a set of fitting options. It is possible
  to just fit a subset of the available fitting parameters; by default, the
  fitting parameters are <code>J_at_25</code>, <code>Rd_at_25</code>, <code>Tp</code>,
  <code>tau</code>, and <code>Vcmax_at_25</code>. This behavior can be changed via the
  <code>fit_options</code> argument.</p>
<p>For practical reasons, the function actually returns values of <code>-ln(L)</code>,
  where <code>L</code> is the likelihood. The logarithm of <code>L</code> is simpler to
  calculate than <code>L</code> itself, and the minus sign converts the problem from
  a maximization to a minimization, which is important because most optimizers
  are designed to minimize a value.</p>
<p>Sometimes an optimizer will choose biologically unreasonable parameter values
  that nevertheless produce good fits to the supplied assimilation values. There
  are several options for preventing an optimizer from choosing such parameter
  values:</p><ul><li><p><code>Enforcing Rubisco limitations</code>: A common problem is that the fit
          result may not indicate Rubisc-limited assimilation at low CO2 values,
          which should be the case for any A-Ci curves measured at saturating
          light. In this case, the optional <code>cj_crossover_min</code> and
          <code>cj_crossover_max</code> can be used to constrain the range of
          <code>Cc</code> values (in ppm) where <code>Wj</code> is allowed to be the overall
          rate limiting factor. If the crossover from Rubisco-limited to
          RuBP-regeneration limited carboxylation occurs outside these bounds
          (when they are supplied), a heavy penalty will be added to the error
          function, preventing the optimizer from choosing those parameter
          values.</p></li>
<li><p><code>Requiring positive gmc</code>: The Variable J method sometimes
          predicts negative values of the mesophyll conductance (<code>gmc</code>).
          Such values are probably not realistic, especially when <code>Cc</code> is
          above the CO2 compensation point. The <code>require_positive_gmc</code>
          input argument can be used to penalize negative values of <code>gmc</code>.
          When <code>require_positive_gmc</code> is <code>'all'</code>, a heavy penalty will
          be added to the error function if there are any negative <code>gmc</code>
          values. When <code>require_positive_gmc</code> is <code>'positive_a'</code>, a
          heavy penalty will be added to the error function if there are any
          negative <code>gmc</code> values when <code>A</code> is positive; negative
          <code>gmc</code> for negative <code>A</code> will be allowed. When
          <code>require_positive_gmc</code> is <code>'none'</code>, these restrictions are
          disabled and no penalties are added for negative <code>gmc</code>.</p></li>
<li><p><code>Preventing large values of gmc</code>: The Variable J method sometimes
          produces unreasonably high values of <code>gmc</code>. The <code>gmc_max</code>
          argument can be used to address this. If any predicted <code>gmc</code>
          values exceed <code>gmc_max</code> when <code>A</code> is positive, a heavy
          penalty will be added to the error function.</p></li>
</ul><p>A penalty is also added for any parameter combination where <code>An</code> is not a
  number, or where <code><a href="calculate_c3_variable_j.html">calculate_c3_variable_j</a></code> or
  <code><a href="calculate_c3_assimilation.html">calculate_c3_assimilation</a></code> produce an error.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A function with one input argument <code>guess</code>, which should be a numeric
  vector representing values of the parameters to be fitted (which are specified
  by the <code>fit_options</code> input argument.) Each element of <code>guess</code> is the
  value of one parameter (arranged in alphabetical order.) For example, with the
  default settings, <code>guess</code> should contain values of <code>J_at_25</code>,</p>
<p></p>
<p><code>Rd_at_25</code>, <code>tau</code>, <code>Tp</code>, and <code>Vcmax_at_25</code> (in that
  order).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Read an example Licor file included in the PhotoGEA package</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_gasex_file.html">read_gasex_file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="PhotoGEA_example_file_path.html">PhotoGEA_example_file_path</a></span><span class="op">(</span><span class="st">'c3_aci_1.xlsx'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define a new column that uniquely identifies each curve</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species_plot'</span><span class="op">]</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species'</span><span class="op">]</span>, <span class="st">'-'</span>, <span class="va">licor_file</span><span class="op">[</span>, <span class="st">'plot'</span><span class="op">]</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Organize the data</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="organize_response_curve_data.html">organize_response_curve_data</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">licor_file</span>,</span></span>
<span class="r-in"><span>    <span class="st">'species_plot'</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">16</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">'CO2_r_sp'</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate the total pressure in the Licor chamber</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_total_pressure.html">calculate_total_pressure</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate temperature-dependent values of C3 photosynthetic parameters</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_arrhenius.html">calculate_arrhenius</a></span><span class="op">(</span><span class="va">licor_file</span>, <span class="va">c3_arrhenius_bernacchi</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define an error function for one curve from the set</span></span></span>
<span class="r-in"><span><span class="va">error_fcn</span> <span class="op">&lt;-</span> <span class="fu">error_function_c3_variable_j</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">licor_file</span><span class="op">[</span><span class="va">licor_file</span><span class="op">[</span>, <span class="st">'species_plot'</span><span class="op">]</span> <span class="op">==</span> <span class="st">'tobacco - 1'</span>, , <span class="cn">TRUE</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Evaluate the error for J_at_25 = 200, Rd_at_25 = 1, tau = 0.5, Tp = 15,</span></span></span>
<span class="r-in"><span><span class="co"># Vcmax_at_25 = 100</span></span></span>
<span class="r-in"><span><span class="fu">error_fcn</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">15</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>number of items to replace is not a multiple of replacement length</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1e+10</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Make a plot of error vs. Tp when the other parameters are fixed to the values</span></span></span>
<span class="r-in"><span><span class="co"># above. As Tp increases, it eventually stops limiting the assimilation rate</span></span></span>
<span class="r-in"><span><span class="co"># and its value stops influencing the error.</span></span></span>
<span class="r-in"><span><span class="va">tpu_error_fcn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Tp</span><span class="op">)</span> <span class="op">{</span><span class="fu">error_fcn</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">1</span>, <span class="fl">0.5</span>, <span class="va">Tp</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">tpu_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">lattice</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">tpu_seq</span>, <span class="va">tpu_error_fcn</span><span class="op">)</span> <span class="op">~</span> <span class="va">tpu_seq</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">'b'</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">'Tp (micromol / m^2 / s)'</span>,</span></span>
<span class="r-in"><span>  ylab <span class="op">=</span> <span class="st">'Negative log likelihood (dimensionless)'</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>number of items to replace is not a multiple of replacement length</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>number of items to replace is not a multiple of replacement length</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>number of items to replace is not a multiple of replacement length</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>number of items to replace is not a multiple of replacement length</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>number of items to replace is not a multiple of replacement length</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>number of items to replace is not a multiple of replacement length</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>number of items to replace is not a multiple of replacement length</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>number of items to replace is not a multiple of replacement length</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>number of items to replace is not a multiple of replacement length</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>number of items to replace is not a multiple of replacement length</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>number of items to replace is not a multiple of replacement length</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>number of items to replace is not a multiple of replacement length</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>number of items to replace is not a multiple of replacement length</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>number of items to replace is not a multiple of replacement length</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>number of items to replace is not a multiple of replacement length</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>number of items to replace is not a multiple of replacement length</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>number of items to replace is not a multiple of replacement length</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>number of items to replace is not a multiple of replacement length</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>number of items to replace is not a multiple of replacement length</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>number of items to replace is not a multiple of replacement length</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>number of items to replace is not a multiple of replacement length</span>
<span class="r-plt img"><img src="error_function_c3_variable_j-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward B. Lochocki.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

