<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate mesophyll conductance to CO2 diffusion — calculate_gm_ubierna • PhotoGEA</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate mesophyll conductance to CO2 diffusion — calculate_gm_ubierna"><meta name="description" content="Calculates mesophyll conductance to CO2 diffusion (gmc) from combined
  gas exchange and isotope discrimination measurements as described in Ubierna
  et al. (2018). This function can accomodate alternative colum names for the
  variables taken from exdf_obj; it also checks the units of each
  required column and will produce an error if any units are incorrect."><meta property="og:description" content="Calculates mesophyll conductance to CO2 diffusion (gmc) from combined
  gas exchange and isotope discrimination measurements as described in Ubierna
  et al. (2018). This function can accomodate alternative colum names for the
  variables taken from exdf_obj; it also checks the units of each
  required column and will produce an error if any units are incorrect."><meta property="og:image" content="https://eloch216.github.io/PhotoGEA/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    padding-top: 70px;

    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PhotoGEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/PhotoGEA.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/analyzing_ball_berry_data.html">Analyzing Ball-Berry Data</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_c3_aci_curves.html">Analyzing C3 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_c4_aci_curves.html">Analyzing C4 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_gm_data.html">Analyzing Mesophyll Conductance Data</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_tdl_data.html">Analyzing TDL Data</a></li>
    <li><a class="dropdown-item" href="../articles/combining_with_other_packages.html">Combining PhotoGEA With Other Packages</a></li>
    <li><a class="dropdown-item" href="../articles/creating_your_own_processing_tools.html">Creating Your Own Processing Tools</a></li>
    <li><a class="dropdown-item" href="../articles/developing_a_data_analysis_pipeline.html">Developing a Data Analysis Pipeline</a></li>
    <li><a class="dropdown-item" href="../articles/working_with_extended_data_frames.html">Working With Extended Data Frames</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/eloch216/PhotoGEA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Calculate mesophyll conductance to CO2 diffusion</h1>

      <div class="d-none name"><code>calculate_gm_ubierna.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates mesophyll conductance to CO2 diffusion (<code>gmc</code>) from combined
  gas exchange and isotope discrimination measurements as described in Ubierna
  et al. (2018). This function can accomodate alternative colum names for the
  variables taken from <code>exdf_obj</code>; it also checks the units of each
  required column and will produce an error if any units are incorrect.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calculate_gm_ubierna</span><span class="op">(</span></span>
<span>    <span class="va">exdf_obj</span>,</span>
<span>    e <span class="op">=</span> <span class="op">-</span><span class="fl">3</span>,</span>
<span>    f <span class="op">=</span> <span class="fl">11</span>,</span>
<span>    a_bar_column_name <span class="op">=</span> <span class="st">'a_bar'</span>,</span>
<span>    a_column_name <span class="op">=</span> <span class="st">'A'</span>,</span>
<span>    ci_column_name <span class="op">=</span> <span class="st">'Ci'</span>,</span>
<span>    co2_s_column_name <span class="op">=</span> <span class="st">'CO2_s'</span>,</span>
<span>    csurface_column_name <span class="op">=</span> <span class="st">'Csurface'</span>,</span>
<span>    delta_c13_r_column_name <span class="op">=</span> <span class="st">'delta_C13_r'</span>,</span>
<span>    delta_obs_tdl_column_name <span class="op">=</span> <span class="st">'Delta_obs_tdl'</span>,</span>
<span>    gamma_star_column_name <span class="op">=</span> <span class="st">'Gamma_star'</span>,</span>
<span>    rl_column_name <span class="op">=</span> <span class="st">'RL'</span>,</span>
<span>    total_pressure_column_name <span class="op">=</span> <span class="st">'total_pressure'</span>,</span>
<span>    t_column_name <span class="op">=</span> <span class="st">'t'</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-exdf-obj">exdf_obj<a class="anchor" aria-label="anchor" href="#arg-exdf-obj"></a></dt>
<dd><p>An <code>exdf</code> object.</p></dd>


  <dt id="arg-e">e<a class="anchor" aria-label="anchor" href="#arg-e"></a></dt>
<dd><p>The isotopic fractionation during day respiration in <code>ppt</code>.</p></dd>


  <dt id="arg-f">f<a class="anchor" aria-label="anchor" href="#arg-f"></a></dt>
<dd><p>The isotopic fractionation during photorespiration in <code>ppt</code>.</p></dd>


  <dt id="arg-a-bar-column-name">a_bar_column_name<a class="anchor" aria-label="anchor" href="#arg-a-bar-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the weighted
    isotopic fractionation across the boundary layer and stomata in <code>ppt</code>.
    Values of <code>a_bar</code> are typically calculated using
    <code><a href="calculate_ternary_correction.html">calculate_ternary_correction</a></code>.</p></dd>


  <dt id="arg-a-column-name">a_column_name<a class="anchor" aria-label="anchor" href="#arg-a-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the net CO2
    assimilation rate in <code>micromol m^(-2) s^(-1)</code>.</p></dd>


  <dt id="arg-ci-column-name">ci_column_name<a class="anchor" aria-label="anchor" href="#arg-ci-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the intercellular
    CO2 concentration in <code>micromol mol^(-1)</code>.</p></dd>


  <dt id="arg-co-s-column-name">co2_s_column_name<a class="anchor" aria-label="anchor" href="#arg-co-s-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the CO2
    concentration in the sample line (outgoing air) in <code>micromol mol^(-1)</code>.</p></dd>


  <dt id="arg-csurface-column-name">csurface_column_name<a class="anchor" aria-label="anchor" href="#arg-csurface-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the CO2
    concentration at the leaf surface in <code>micromol mol^(-1)</code>. Values of
    <code>Csurface</code> are typically calculated using
    <code><a href="calculate_gas_properties.html">calculate_gas_properties</a></code>.</p></dd>


  <dt id="arg-delta-c-r-column-name">delta_c13_r_column_name<a class="anchor" aria-label="anchor" href="#arg-delta-c-r-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the CO2 isotope
    ratio in the reference line (incoming air) in <code>ppt</code>.</p></dd>


  <dt id="arg-delta-obs-tdl-column-name">delta_obs_tdl_column_name<a class="anchor" aria-label="anchor" href="#arg-delta-obs-tdl-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the observed isotope
    discrimination values in <code>ppt</code>.</p></dd>


  <dt id="arg-gamma-star-column-name">gamma_star_column_name<a class="anchor" aria-label="anchor" href="#arg-gamma-star-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the CO2 compensation
    point in the absence of day respiration in <code>micromol mol^(-1)</code>.  Values
    of <code>Gamma_star</code> are typically calculated using
    <code><a href="calculate_gamma_star.html">calculate_gamma_star</a></code> or <code><a href="calculate_arrhenius.html">calculate_arrhenius</a></code>.</p></dd>


  <dt id="arg-rl-column-name">rl_column_name<a class="anchor" aria-label="anchor" href="#arg-rl-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the rate of day
    respiration in <code>micromol m^(-2) s^(-1)</code>.</p></dd>


  <dt id="arg-total-pressure-column-name">total_pressure_column_name<a class="anchor" aria-label="anchor" href="#arg-total-pressure-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the total pressure
    in <code>bar</code>.</p></dd>


  <dt id="arg-t-column-name">t_column_name<a class="anchor" aria-label="anchor" href="#arg-t-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the ternary
    correction factor (<code>dimensionless</code>). Values of <code>t</code> are typically
    calculated using <code><a href="calculate_ternary_correction.html">calculate_ternary_correction</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function uses the comprehensive model for photosynthetic discrimination
  against 13C in C3 plants to calculate mesophyll conductance, as described in
  Ubierna et al. (2018). In particular, the following equations from that source
  are implemented in the code:</p>
<p></p><ul><li><p>Isotopic fractionation due to day respiration (<code>e_prime</code>) is
          calculated using Equations 28 and 30.</p></li>
<li><p>Isotopic discrimination due to photorespiration (<code>Delta_f</code>), due
          to day respiration (<code>Delta_e</code>), and that would occur if Ci = Cc
          in the absence of any respiratory fractionation (<code>Delta_i</code>) are
          calculated using Equations 34, 33, and 31, respectively.</p></li>
<li><p>Mesophyll conductance to CO2 diffusion (<code>gmc</code>) is calculated
          using Equation 44. This equation is broken up into two factors called
          <code>Delta_difference</code> and <code>equation_top</code> which are separately
          returned in the output from <code>calculate_gm_ubierna</code>.</p></li>
</ul><p>For an alternative method for calculating <code>gmc</code>, see
  <code><a href="calculate_gm_busch.html">calculate_gm_busch</a></code>.</p>
<p>References:</p>
<p>Ubierna, N., Holloway-Phillips, M.-M. and Farquhar, G. D. "Using Stable Carbon
  Isotopes to Study C3 and C4 Photosynthesis: Models and Calculations." in
  Photosynthesis: Methods and Protocols (ed. Covshoff, S.) 155–196 (Springer,
  2018) [<a href="https://doi.org/10.1007/978-1-4939-7786-4_10" class="external-link">doi:10.1007/978-1-4939-7786-4_10</a>
].</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An <code>exdf</code> object based on <code>exdf_obj</code> that includes the following
  additional columns, calculated as described above: <code>e_prime</code>,
  <code>Delta_i</code>, <code>Delta_e</code>, <code>Delta_f</code>, <code>Delta_difference</code>,
  <code>equation_top</code>, and <code>gmc</code>. The category for each of these new
  columns is <code>calculate_gm_ubierna</code> to indicate that they were created
  using this function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## In this example we load gas exchange and TDL data files, calibrate the TDL</span></span></span>
<span class="r-in"><span><span class="co">## data, pair the data tables together, and then calculate mesophyll conductance</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Read the TDL data file, making sure to interpret the time zone as US Central</span></span></span>
<span class="r-in"><span><span class="co"># time</span></span></span>
<span class="r-in"><span><span class="va">tdl_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_gasex_file.html">read_gasex_file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="PhotoGEA_example_file_path.html">PhotoGEA_example_file_path</a></span><span class="op">(</span><span class="st">'tdl_for_gm.dat'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">'TIMESTAMP'</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>tz <span class="op">=</span> <span class="st">'US/Central'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Identify cycles within the TDL data</span></span></span>
<span class="r-in"><span><span class="va">tdl_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="identify_tdl_cycles.html">identify_tdl_cycles</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">tdl_data</span>,</span></span>
<span class="r-in"><span>  valve_column_name <span class="op">=</span> <span class="st">'valve_number'</span>,</span></span>
<span class="r-in"><span>  cycle_start_valve <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  expected_cycle_length_minutes <span class="op">=</span> <span class="fl">2.7</span>,</span></span>
<span class="r-in"><span>  expected_cycle_num_valves <span class="op">=</span> <span class="fl">9</span>,</span></span>
<span class="r-in"><span>  timestamp_colname <span class="op">=</span> <span class="st">'TIMESTAMP'</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use reference tanks to calibrate the TDL data</span></span></span>
<span class="r-in"><span><span class="va">processed_tdl</span> <span class="op">&lt;-</span> <span class="fu"><a href="consolidate.html">consolidate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/by.html" class="external-link">by</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">tdl_data</span>,</span></span>
<span class="r-in"><span>  <span class="va">tdl_data</span><span class="op">[</span>, <span class="st">'cycle_num'</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  <span class="va">process_tdl_cycle_erml</span>,</span></span>
<span class="r-in"><span>  noaa_valve <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  calibration_0_valve <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  calibration_1_valve <span class="op">=</span> <span class="fl">21</span>,</span></span>
<span class="r-in"><span>  calibration_2_valve <span class="op">=</span> <span class="fl">23</span>,</span></span>
<span class="r-in"><span>  calibration_3_valve <span class="op">=</span> <span class="fl">26</span>,</span></span>
<span class="r-in"><span>  noaa_cylinder_co2_concentration <span class="op">=</span> <span class="fl">294.996</span>,</span></span>
<span class="r-in"><span>  noaa_cylinder_isotope_ratio <span class="op">=</span> <span class="op">-</span><span class="fl">8.40</span>,</span></span>
<span class="r-in"><span>  calibration_isotope_ratio <span class="op">=</span> <span class="op">-</span><span class="fl">11.505</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Read the gas exchange data, making sure to interpret the time stamp in the US</span></span></span>
<span class="r-in"><span><span class="co"># Central time zone</span></span></span>
<span class="r-in"><span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_gasex_file.html">read_gasex_file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="PhotoGEA_example_file_path.html">PhotoGEA_example_file_path</a></span><span class="op">(</span><span class="st">'licor_for_gm_site11.xlsx'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">'time'</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>tz <span class="op">=</span> <span class="st">'US/Central'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get TDL valve information from Licor file name; for this TDL system, the</span></span></span>
<span class="r-in"><span><span class="co"># reference valve is 12 when the sample valve is 11</span></span></span>
<span class="r-in"><span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_sample_valve_from_filename.html">get_sample_valve_from_filename</a></span><span class="op">(</span><span class="va">licor_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">'11'</span> <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get oxygen info from the Licor file preamble (needed for calculate_gamma_star)</span></span></span>
<span class="r-in"><span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_oxygen_from_preamble.html">get_oxygen_from_preamble</a></span><span class="op">(</span><span class="va">licor_data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Pair the Licor and TDL data by locating the TDL cycle corresponding to each</span></span></span>
<span class="r-in"><span><span class="co"># Licor measurement</span></span></span>
<span class="r-in"><span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="pair_gasex_and_tdl.html">pair_gasex_and_tdl</a></span><span class="op">(</span><span class="va">licor_data</span>, <span class="va">processed_tdl</span><span class="op">$</span><span class="va">tdl_data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate total pressure (needed for calculate_gas_properties)</span></span></span>
<span class="r-in"><span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_total_pressure.html">calculate_total_pressure</a></span><span class="op">(</span><span class="va">licor_data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate Csurface (needed for calculate_ternary_correction)</span></span></span>
<span class="r-in"><span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_gas_properties.html">calculate_gas_properties</a></span><span class="op">(</span><span class="va">licor_data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate ternary correction</span></span></span>
<span class="r-in"><span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_ternary_correction.html">calculate_ternary_correction</a></span><span class="op">(</span><span class="va">licor_data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Set Rubisco specificity (needed for calculate_gamma_star)</span></span></span>
<span class="r-in"><span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="set_variable.html">set_variable</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">licor_data</span>,</span></span>
<span class="r-in"><span>    <span class="st">'specificity_at_tleaf'</span>,</span></span>
<span class="r-in"><span>    <span class="st">'M / M'</span>,</span></span>
<span class="r-in"><span>    value <span class="op">=</span> <span class="fl">90</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate Gamma_star (needed for calculate_gm_ubierna)</span></span></span>
<span class="r-in"><span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_gamma_star.html">calculate_gamma_star</a></span><span class="op">(</span><span class="va">licor_data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate isotope discrimination (needed for calculate_gm_ubierna)</span></span></span>
<span class="r-in"><span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_isotope_discrimination.html">calculate_isotope_discrimination</a></span><span class="op">(</span><span class="va">licor_data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Set respiration (needed for calculate_gm_ubierna)</span></span></span>
<span class="r-in"><span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="set_variable.html">set_variable</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">licor_data</span>,</span></span>
<span class="r-in"><span>  <span class="st">'RL'</span>,</span></span>
<span class="r-in"><span>  <span class="st">'micromol m^(-2) s^(-1)'</span>,</span></span>
<span class="r-in"><span>  value <span class="op">=</span> <span class="fl">1.2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate mesophyll conductance</span></span></span>
<span class="r-in"><span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu">calculate_gm_ubierna</span><span class="op">(</span><span class="va">licor_data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate Cc using the new values of mesophyll conductance</span></span></span>
<span class="r-in"><span><span class="va">licor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="apply_gm.html">apply_gm</a></span><span class="op">(</span><span class="va">licor_data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View some of the results</span></span></span>
<span class="r-in"><span><span class="va">licor_data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'replicate'</span>, <span class="st">'CO2_s'</span>, <span class="st">'Delta_obs_tdl'</span>, <span class="st">'gmc'</span>, <span class="st">'Ci'</span>, <span class="st">'Cc'</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    replicate   CO2_s Delta_obs_tdl       gmc       Ci        Cc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          1 417.363      8.039825 0.1741069 286.7663 101.16460</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2          1 420.552      8.137268 0.1842769 276.9970 102.18154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3          1 418.796      7.893969 0.1673113 291.8317  99.66079</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          1 419.493      8.029239 0.1692570 291.1437 101.71697</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          1 420.102      8.964915 0.1803390 293.7559 116.32286</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          1 421.133      8.673921 0.1735334 295.9070 112.25005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7          1 262.873      6.434975 0.1593770 182.7755  55.38615</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8          1 262.720      6.747186 0.1653412 181.1386  58.17641</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9          1 262.633      6.326945 0.1620221 179.6180  54.02724</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10         1 262.271      6.358834 0.1494173 191.7498  55.54918</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11         1 262.112      7.450206 0.1535156 199.2717  66.72640</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12         1 262.176      6.843263 0.1423399 204.1826  61.50326</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward B. Lochocki.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

