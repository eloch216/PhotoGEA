<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate intrinsic water use efficiency — calculate_wue • PhotoGEA</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate intrinsic water use efficiency — calculate_wue"><meta name="description" content="Calculates the intrinsic water use efficiency (iWUE). This function can
  accomodate alternative column names for the variables taken from the data
  file in case they change at some point in the future. This function also
  checks the units of each required column and will produce an error if any
  units are incorrect."><meta property="og:description" content="Calculates the intrinsic water use efficiency (iWUE). This function can
  accomodate alternative column names for the variables taken from the data
  file in case they change at some point in the future. This function also
  checks the units of each required column and will produce an error if any
  units are incorrect."><meta property="og:image" content="https://eloch216.github.io/PhotoGEA/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    padding-top: 70px;

    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PhotoGEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/PhotoGEA.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-user-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">User Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-user-guides"><li><h6 class="dropdown-header" data-toc-skip>ANALYSIS GUIDES</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/analyzing_ball_berry_data.html">Analyzing Ball-Berry Data</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_c3_aci_curves.html">Analyzing C3 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_c4_aci_curves.html">Analyzing C4 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_gm_data.html">Analyzing Mesophyll Conductance Data</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_tdl_data.html">Analyzing TDL Data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>GENERAL PHOTOGEA ADVICE</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/combining_with_other_packages.html">Combining PhotoGEA With Other Packages</a></li>
    <li><a class="dropdown-item" href="../articles/creating_your_own_processing_tools.html">Creating Your Own Processing Tools</a></li>
    <li><a class="dropdown-item" href="../articles/developing_a_data_analysis_pipeline.html">Developing a Data Analysis Pipeline</a></li>
    <li><a class="dropdown-item" href="../articles/working_with_extended_data_frames.html">Working With Extended Data Frames</a></li>
    <li><a class="dropdown-item" href="../articles/frequent_questions.html">Frequently Asked Questions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>GENERAL GAS EXCHANGE ADVICE</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/LI6800_user_constants.html">Guide to Licor LI-6800 User Constants</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/publications.html">Publications</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/eloch216/PhotoGEA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Calculate intrinsic water use efficiency</h1>

      <div class="d-none name"><code>calculate_wue.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates the intrinsic water use efficiency (<code>iWUE</code>). This function can
  accomodate alternative column names for the variables taken from the data
  file in case they change at some point in the future. This function also
  checks the units of each required column and will produce an error if any
  units are incorrect.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calculate_wue</span><span class="op">(</span></span>
<span>    <span class="va">exdf_obj</span>,</span>
<span>    calculate_c3 <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    a_column_name <span class="op">=</span> <span class="st">'A'</span>,</span>
<span>    ca_column_name <span class="op">=</span> <span class="st">'Ca'</span>,</span>
<span>    cc_column_name <span class="op">=</span> <span class="st">'Cc'</span>,</span>
<span>    ci_column_name <span class="op">=</span> <span class="st">'Ci'</span>,</span>
<span>    e_column_name <span class="op">=</span> <span class="st">'E'</span>,</span>
<span>    gmc_column_name <span class="op">=</span> <span class="st">'gmc_tl'</span>,</span>
<span>    gsw_column_name <span class="op">=</span> <span class="st">'gsw'</span>,</span>
<span>    h2o_a_column_name <span class="op">=</span> <span class="st">'H2O_s'</span>,</span>
<span>    h2o_i_column_name <span class="op">=</span> <span class="st">'H2O_i'</span>,</span>
<span>    total_pressure_column_name <span class="op">=</span> <span class="st">'total_pressure'</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-exdf-obj">exdf_obj<a class="anchor" aria-label="anchor" href="#arg-exdf-obj"></a></dt>
<dd><p>An <code>exdf</code> object.</p></dd>


  <dt id="arg-calculate-c-">calculate_c3<a class="anchor" aria-label="anchor" href="#arg-calculate-c-"></a></dt>
<dd><p>A logical variable indicating whether to calculate additional variables that
    can be useful for C3 plants (<code>g_ratio</code> and <code>drawdown_ct</code>). Note
    that these quantities require values of mesophyll conductance and <code>Cc</code>,
    so it is not always possible to calculate them.</p></dd>


  <dt id="arg-a-column-name">a_column_name<a class="anchor" aria-label="anchor" href="#arg-a-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the net CO2
    assimilation rate in <code>micromol m^(-2) s^(-1)</code>.</p></dd>


  <dt id="arg-ca-column-name">ca_column_name<a class="anchor" aria-label="anchor" href="#arg-ca-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the ambient
    CO2 concentration in <code>micromol mol^(-1)</code>.</p></dd>


  <dt id="arg-cc-column-name">cc_column_name<a class="anchor" aria-label="anchor" href="#arg-cc-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the chloroplastic
    CO2 concentration in <code>micromol mol^(-1)</code>. Typically these are
    calculated using <code><a href="apply_gm.html">apply_gm</a></code>.</p></dd>


  <dt id="arg-ci-column-name">ci_column_name<a class="anchor" aria-label="anchor" href="#arg-ci-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the intercellular
    CO2 concentration in <code>micromol mol^(-1)</code>.</p></dd>


  <dt id="arg-e-column-name">e_column_name<a class="anchor" aria-label="anchor" href="#arg-e-column-name"></a></dt>
<dd><p>The name of the column in <code>licor_exdf</code> that contains the transpiration
    rate in <code>mol m^(-2) s^(-1)</code>.</p></dd>


  <dt id="arg-gmc-column-name">gmc_column_name<a class="anchor" aria-label="anchor" href="#arg-gmc-column-name"></a></dt>
<dd><p>The name of the column in <code>licor_exdf</code> that contains the mesophyll
    conductance to CO2 at leaf temperature in <code>mol m^(-2) s^(-1) bar^(-1)</code>.</p></dd>


  <dt id="arg-gsw-column-name">gsw_column_name<a class="anchor" aria-label="anchor" href="#arg-gsw-column-name"></a></dt>
<dd><p>The name of the column in <code>licor_exdf</code> that contains the stomatal
    conductance to water vapor in <code>mol m^(-2) s^(-1)</code>.</p></dd>


  <dt id="arg-h-o-a-column-name">h2o_a_column_name<a class="anchor" aria-label="anchor" href="#arg-h-o-a-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the water vapor
    concentration in the air surrounding the leaf (i.e., the ambient water
    vapor concentration) in <code>mmol mol^(-1)</code>.</p></dd>


  <dt id="arg-h-o-i-column-name">h2o_i_column_name<a class="anchor" aria-label="anchor" href="#arg-h-o-i-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the water vapor
    concentration in the leaf's intercellular air spaces in
    <code>mmol mol^(-1)</code>. Typically this value is calculated using
    <code><a href="calculate_gas_properties.html">calculate_gas_properties</a></code>.</p></dd>


  <dt id="arg-total-pressure-column-name">total_pressure_column_name<a class="anchor" aria-label="anchor" href="#arg-total-pressure-column-name"></a></dt>
<dd><p>The name of the column in <code>exdf_obj</code> that contains the total pressure
    in <code>bar</code>. Typically this value is calculated using
    <code><a href="calculate_total_pressure.html">calculate_total_pressure</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Leaf-level water use efficiency (<code>lWUE</code>) is defined as the ratio of net
  CO2 assimilation (<code>An</code>) to transpiration (<code>E</code>):</p>
<p><code>lWUE = An / E</code>.</p>
<p>This quantity can also be expressed in terms of water and CO2 concentrations:</p>
<p><code>lWUE = 0.6 * Ca * (1 - Ci / Ca) / (H2Oi - H2Oa)</code>.</p>
<p>Here, <code>Ca</code> and <code>Ci</code> are the atmospheric and intercellular CO2
  concentrations, and <code>H2Oa</code> and <code>H2Oi</code> are the atmospheric and
  intercellular water vapor concentrations. If differences in <code>lWUE</code> are
  measured between different groups of plants, it can be helpful to separately
  investigate <code>Ci / Ca</code> and <code>H2Oi - H2Oa</code> to see which factor is
  driving the differences.</p>
<p>The intrinsic water use efficiency <code>iWUE</code> is a measure of leaf-level
  water use efficiency, and it is defined to be the ratio <code>An</code> and the
  stomatal conductance to H2O diffusion (<code>gsw</code>):</p>
<p><code>iWUE = An / gsw</code>.</p>
<p>For C3 plants, <code>iWUE</code> can be reexpressed as</p>
<p><code>iWUE = (gmc / gsw) / (1 + (gmc / gsw)) * (Ca - Cc)</code>,</p>
<p>where <code>gmc</code> is the mesophyll conductance to CO2 diffusion and <code>Cc</code>
  is the chloroplast CO2 concentration. If differences in <code>iWUE</code> are
  measured between different groups of plants, it can be helpful to separately
  investigate <code>gmc / gsw</code> and <code>Ca - Cc</code> to see which factor is driving
  the differences.</p>
<p>Note: both measures of water use efficiency depend directly or indirectly on
  stomatal conductance. Stomata are notoriously slow to reach steady-state, but
  water use efficiency is only reliable at steady-state. For this reason, it is
  recommended to only analyze water use efficiency for gas exchange measurements
  where stomatal conductance has stabilized. For an A-Ci or A-Q curve, only the
  first measured point has typically reached steady-state stomatal conductance.
  On the other hand, for a Ball-Berry curve, all measured points should have
  reached steady-state stomatal conductance.</p>
<p>For more details about these quantities, see Leakey et al. "Water Use
  Efficiency as a Constraint and Target for Improving the Resilience and
  Productivity of C3 and C4 Crops." Annual Review of Plant Biology 70 (1):
  781–808 (2019) [<a href="https://doi.org/10.1146/annurev-arplant-042817-040305" class="external-link">doi:10.1146/annurev-arplant-042817-040305</a>
].</p>
<p>In this function, the following variables are calculated:</p><ul><li><p><code>lWUE</code>, given by <code>iWUE = An / E</code></p></li>
<li><p><code>Cia_ratio</code>, given by <code>Cia_ratio = Ci / Ca</code></p></li>
<li><p><code>drawdown_sw</code>, given by <code>drawdown_sw = H2Oi - H2Oa</code> (this
          is the drawdown of water vapor across the stomata)</p></li>
<li><p><code>iWUE</code>, given by <code>iWUE = An / gsw</code></p></li>
<li><p><code>g_ratio</code>, given by <code>g_ratio = gmc / gsw</code></p></li>
<li><p><code>drawdown_ct</code>, given by <code>drawdown_ct = Ca - Cc</code> (this is the
          total drawdown of CO2 from the ambient air to the chloroplast)</p></li>
</ul><p>Note: <code>g_ratio</code> and <code>drawdown_ct</code> are only calculated if
  <code>calculate_c3</code> is <code>TRUE</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An <code>exdf</code> object based on <code>exdf_obj</code> that includes the quantities
  listed above, along with their units. The category of each of these new
  columns is <code>calculate_wue</code> to indicate that it was created using this
  function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Read an example Licor file included in the PhotoGEA package and calculate the</span></span></span>
<span class="r-in"><span><span class="co"># water use efficiency.</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_gasex_file.html">read_gasex_file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="PhotoGEA_example_file_path.html">PhotoGEA_example_file_path</a></span><span class="op">(</span><span class="st">'ball_berry_1.xlsx'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_total_pressure.html">calculate_total_pressure</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_temperature_response.html">calculate_temperature_response</a></span><span class="op">(</span><span class="va">licor_file</span>, <span class="va">c3_temperature_param_sharkey</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="calculate_gas_properties.html">calculate_gas_properties</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="apply_gm.html">apply_gm</a></span><span class="op">(</span><span class="va">licor_file</span>, gmc_at_25 <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu">calculate_wue</span><span class="op">(</span><span class="va">licor_file</span>, calculate_c3 <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">licor_file</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">iWUE</span>      <span class="co"># View the units of the new `iWUE` column</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "micromol CO2 / mol H2O"</span>
<span class="r-in"><span><span class="va">licor_file</span><span class="op">$</span><span class="va">categories</span><span class="op">$</span><span class="va">iWUE</span> <span class="co"># View the category of the new `iWUE` column</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "calculate_wue"</span>
<span class="r-in"><span><span class="va">licor_file</span><span class="op">[</span>, <span class="st">'iWUE'</span><span class="op">]</span>       <span class="co"># View the values of the new `iWUE` column</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  91.19402  75.52585  90.68321 106.78757  78.24615  66.21068  33.68671</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8]  52.19154  54.09650  58.52669  39.81239  57.99448  49.35733  33.84908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15]  68.74848  53.75126  51.55032  56.41271  40.15597  92.38880  45.67573</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22] 102.10911  97.68654  89.89394  72.98826  54.17163  58.44461  94.55687</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward B. Lochocki, Coralie E. Salesse-Smith, Justin M. McGrath.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

