<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Checks to make sure an exdf object representing response curve data
  has the expected number of rows and does not contain infinite values."><title>Reorganize response curve data for analysis and plotting — organize_response_curve_data • PhotoGEA</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reorganize response curve data for analysis and plotting — organize_response_curve_data"><meta property="og:description" content="Checks to make sure an exdf object representing response curve data
  has the expected number of rows and does not contain infinite values."><meta property="og:image" content="https://eloch216.github.io/PhotoGEA/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    padding-top: 70px;

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PhotoGEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/PhotoGEA.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/analyzing_ball_berry_data.html">Analyzing Ball-Berry Data</a>
    <a class="dropdown-item" href="../articles/analyzing_c3_aci_curves.html">Analyzing C3 A-Ci Curves</a>
    <a class="dropdown-item" href="../articles/analyzing_c4_aci_curves.html">Analyzing C4 A-Ci Curves</a>
    <a class="dropdown-item" href="../articles/analyzing_gm_data.html">Analyzing Mesophyll Conductance Data</a>
    <a class="dropdown-item" href="../articles/analyzing_tdl_data.html">Analyzing TDL Data</a>
    <a class="dropdown-item" href="../articles/combining_with_other_packages.html">Combining PhotoGEA With Other Packages</a>
    <a class="dropdown-item" href="../articles/creating_your_own_processing_tools.html">Creating Your Own Processing Tools</a>
    <a class="dropdown-item" href="../articles/developing_a_data_analysis_pipeline.html">Developing a Data Analysis Pipeline</a>
    <a class="dropdown-item" href="../articles/working_with_extended_data_frames.html">Working With Extended Data Frames</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/eloch216/PhotoGEA/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Reorganize response curve data for analysis and plotting</h1>
      
      <div class="d-none name"><code>organize_response_curve_data.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Checks to make sure an <code>exdf</code> object representing response curve data
  has the expected number of rows and does not contain infinite values.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">organize_response_curve_data</span><span class="op">(</span></span>
<span>    <span class="va">licor_exdf</span>,</span>
<span>    <span class="va">identifier_columns</span>,</span>
<span>    <span class="va">measurement_numbers_to_remove</span>,</span>
<span>    <span class="va">column_for_ordering</span>,</span>
<span>    ordering_column_tolerance <span class="op">=</span> <span class="cn">Inf</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>licor_exdf</dt>
<dd><p>An <code>exdf</code> object representing response curve data from a Licor gas
    exchange measurement system.</p></dd>


  <dt>identifier_columns</dt>
<dd><p>A vector or list of strings representing the names of columns in
    <code>licor_exdf</code> that, taken together, uniquely identify each curve. This
    often includes names like <code>plot</code>, <code>event</code>, <code>replicate</code>, etc.</p></dd>


  <dt>measurement_numbers_to_remove</dt>
<dd><p>A vector of integers specifying which points to remove from each curve; for
    example, if each curve has 16 points and the 10^th^ and 11^th^ points along
    the sequence should not be included in subsequent analysis,
    <code>measurement_numbers_to_remove</code> could be specified as <code>c(10, 11)</code>.</p></dd>


  <dt>column_for_ordering</dt>
<dd><p>The name of a column that is systematically varied to produce each curve;
    for example, in a light response curve, this would typically by <code>Qin</code>.</p></dd>


  <dt>ordering_column_tolerance</dt>
<dd><p>To be passed to <code><a href="check_response_curve_data.html">check_response_curve_data</a></code> as the
    <code>driving_column_tolerance</code> input argument; the
    <code>ordering_column_tolerance</code> can be set to <code>Inf</code> to disable this
    check.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For an <code>exdf</code> object consisting of multiple response curves that can be
  identified using the values of its <code>identifier_columns</code>, this function
  performs the following actions:</p><ul><li><p>Assigns a sequential number to each measurement in each curve,
          beginning with 1; in other words, the first point in the curve is
          given number 1, the second is given number 2, etc. These numbers are
          stored as a new column called <code>seq_num</code>.</p></li>
<li><p>Extracts a subset of the data corresponding to the values of
          <code>seq_num</code> not in <code>measurement_numbers_to_remove</code>; this is
          often helpful for A-Ci curves, where the CO~2~ concentration begins at
          the ambient value, is decreased to a low value, is reset to
          atmospheric for several measurements to allow the plant to
          reacclimate, and then is increased to higher values. In this case,
          only the first measurement at ambient CO~2~ is used for plotting or
          additional analysis.</p></li>
<li><p>Reorders the data according to ascending values of the
          <code>column_for_ordering</code>. For example, the points in an A-Ci curve
          would not be ordered according to their Ci values in a curve measured
          using a sequence as described above. This can cause issues when making
          line plots, so it may be convenient to reorder them according to their
          Ci values.</p></li>
</ul><p>Before performing these operations, this function checks to make sure that the
  <code>identifier_columns</code> specify response curves that (1) each have the same
  number of points and where (2) the <code>column_for_ordering</code> follows the same
  sequence of values in each curve (within the tolerance set by
  <code>ordering_column_tolerance</code>). This check is accomplished via
  <code><a href="check_response_curve_data.html">check_response_curve_data</a></code>, treating the
  <code>column_for_ordering</code> as the <code>driving_column</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An <code>exdf</code> object based on <code>licor_exdf</code> but processed as described
  above.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Read an example Licor file included in the PhotoGEA package and organize it.</span></span></span>
<span class="r-in"><span><span class="co"># This file includes several 7-point light-response curves that can be uniquely</span></span></span>
<span class="r-in"><span><span class="co"># identified by the values of its 'species' and 'plot' columns. Since these are</span></span></span>
<span class="r-in"><span><span class="co"># light-response curves, each one follows a pre-set sequence of `Qin` values.</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_gasex_file.html">read_gasex_file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="PhotoGEA_example_file_path.html">PhotoGEA_example_file_path</a></span><span class="op">(</span><span class="st">'ball_berry_1.xlsx'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Split the data into individual curves, keep all seven measurement points in</span></span></span>
<span class="r-in"><span><span class="co"># each curve, and order them by their incident light values (since these are</span></span></span>
<span class="r-in"><span><span class="co"># light response curves). The curves were measured from high to low values of</span></span></span>
<span class="r-in"><span><span class="co"># `Qin`, so after organizing the curves, their order will be reversed from the</span></span></span>
<span class="r-in"><span><span class="co"># original version.</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu">organize_response_curve_data</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">licor_file</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'species'</span>, <span class="st">'plot'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">'Qin'</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View a subset of the data, including the new `seq_num` column</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">licor_file</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'species'</span>, <span class="st">'plot'</span>, <span class="st">'seq_num'</span>, <span class="st">'Qin'</span>, <span class="st">'A'</span><span class="op">)</span>, <span class="cn">TRUE</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    species [UserDefCon] (NA) plot [UserDefCon] (NA) seq_num [NA] (NA)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                    soybean                     1a                 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                    soybean                     1a                 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                    soybean                     1a                 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                    soybean                     1a                 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                    soybean                     1a                 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6                    soybean                     1a                 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7                    soybean                     1a                 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8                    soybean                     1b                 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9                    soybean                     1b                 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10                   soybean                     1b                 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11                   soybean                     1b                 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12                   soybean                     1b                 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13                   soybean                     1b                 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14                   soybean                     1b                 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15                   tobacco                      2                 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16                   tobacco                      2                 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17                   tobacco                      2                 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18                   tobacco                      2                 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19                   tobacco                      2                 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20                   tobacco                      2                 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21                   tobacco                      2                 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22                   soybean                      5                 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23                   soybean                      5                 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24                   soybean                      5                 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25                   soybean                      5                 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26                   soybean                      5                 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27                   soybean                      5                 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28                   soybean                      5                 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Qin [LeafQ] (micromol m^(-2) s^(-1)) A [GasEx] (micromol m^(-2) s^(-1))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                               200.141                           5.679174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                               350.106                          12.240074</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                               500.135                          16.617929</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                               649.951                          23.290614</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                               799.983                          25.430106</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6                              1099.800                          22.996635</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7                              2000.030                          35.400473</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8                               200.070                           9.276031</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9                               350.060                          14.666531</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10                              499.982                          17.009070</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11                              650.070                          26.383035</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12                              799.873                          25.472460</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13                             1099.890                          30.250627</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14                             1999.850                          47.950460</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15                              200.236                           7.849870</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16                              350.073                          12.044692</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17                              500.036                          12.106347</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18                              650.001                          16.345888</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19                              800.046                          22.218165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20                             1099.980                          25.492278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21                             2000.020                          29.614535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22                              200.029                          10.768250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23                              349.991                          17.091593</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24                              499.921                          22.068194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25                              650.108                          22.924484</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26                              799.910                          32.769396</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27                             1099.960                          36.218245</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28                             1999.980                          45.780746</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward B. Lochocki.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

