<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Process TDL cycles using a polynomial correction method — process_tdl_cycle_polynomial • PhotoGEA</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Process TDL cycles using a polynomial correction method — process_tdl_cycle_polynomial"><meta name="description" content="Uses the 12C and 13C signal from the calibration lines of a tunable diode
  laser (TDL) to determine correction factors and apply them to the sample
  lines. Applicable for a system with two or more reference tanks whose 12C and
  13C concentrations are known beforehand."><meta property="og:description" content="Uses the 12C and 13C signal from the calibration lines of a tunable diode
  laser (TDL) to determine correction factors and apply them to the sample
  lines. Applicable for a system with two or more reference tanks whose 12C and
  13C concentrations are known beforehand."><meta property="og:image" content="https://eloch216.github.io/PhotoGEA/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    padding-top: 70px;

    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PhotoGEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/PhotoGEA.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/analyzing_ball_berry_data.html">Analyzing Ball-Berry Data</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_c3_aci_curves.html">Analyzing C3 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_c4_aci_curves.html">Analyzing C4 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_gm_data.html">Analyzing Mesophyll Conductance Data</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_tdl_data.html">Analyzing TDL Data</a></li>
    <li><a class="dropdown-item" href="../articles/combining_with_other_packages.html">Combining PhotoGEA With Other Packages</a></li>
    <li><a class="dropdown-item" href="../articles/creating_your_own_processing_tools.html">Creating Your Own Processing Tools</a></li>
    <li><a class="dropdown-item" href="../articles/developing_a_data_analysis_pipeline.html">Developing a Data Analysis Pipeline</a></li>
    <li><a class="dropdown-item" href="../articles/LI6800_user_constants.html">Guide to Licor LI-6800 User Constants</a></li>
    <li><a class="dropdown-item" href="../articles/working_with_extended_data_frames.html">Working With Extended Data Frames</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/eloch216/PhotoGEA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Process TDL cycles using a polynomial correction method</h1>

      <div class="d-none name"><code>process_tdl_cycle_polynomial.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Uses the 12C and 13C signal from the calibration lines of a tunable diode
  laser (TDL) to determine correction factors and apply them to the sample
  lines. Applicable for a system with two or more reference tanks whose 12C and
  13C concentrations are known beforehand.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">process_tdl_cycle_polynomial</span><span class="op">(</span></span>
<span>    <span class="va">tdl_cycle</span>,</span>
<span>    <span class="va">poly_order</span>,</span>
<span>    <span class="va">reference_tanks</span>,</span>
<span>    reference_tank_time_points <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    valve_column_name <span class="op">=</span> <span class="st">'valve_number'</span>,</span>
<span>    raw_12c_colname <span class="op">=</span> <span class="st">'Conc12C_Avg'</span>,</span>
<span>    raw_13c_colname <span class="op">=</span> <span class="st">'Conc13C_Avg'</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-tdl-cycle">tdl_cycle<a class="anchor" aria-label="anchor" href="#arg-tdl-cycle"></a></dt>
<dd><p>An <code>exdf</code> object representing one cycle of TDL data.</p></dd>


  <dt id="arg-poly-order">poly_order<a class="anchor" aria-label="anchor" href="#arg-poly-order"></a></dt>
<dd><p>The order of the polynomial to fit, where 1 indicates a linear fit, 2
    indicates a quadratic fit, etc. This argument will be passed to
    <code><a href="https://rdrr.io/r/stats/poly.html" class="external-link">stats::poly</a></code> during the fitting procedure.</p></dd>


  <dt id="arg-reference-tanks">reference_tanks<a class="anchor" aria-label="anchor" href="#arg-reference-tanks"></a></dt>
<dd><p>A list where each element is a list with three named elements: <code>valve</code>,
    <code>conc_12C</code>, and <code>conc_13C</code>. <code>valve</code> should indicate the valve
    number for the reference tank, and the other two elements should indicate
    the known concentrations of 12C and 13C in the tank.</p></dd>


  <dt id="arg-reference-tank-time-points">reference_tank_time_points<a class="anchor" aria-label="anchor" href="#arg-reference-tank-time-points"></a></dt>
<dd><p>Either <code>NA</code> or a list where each element is a list with three named
    elements: <code>valve</code>, <code>start</code>, and <code>end</code>. <code>valve</code> should
    indicate the valve number for a reference tank, and the other two elements
    should indicate the first and last time points where the measurements from
    this valve should be averaged. The order of valves must be the same as in
    the <code>reference_tanks</code> input argument.</p></dd>


  <dt id="arg-valve-column-name">valve_column_name<a class="anchor" aria-label="anchor" href="#arg-valve-column-name"></a></dt>
<dd><p>The name of the column in <code>tdl_cycle</code> that contains the valve number.</p></dd>


  <dt id="arg-raw-c-colname">raw_12c_colname<a class="anchor" aria-label="anchor" href="#arg-raw-c-colname"></a></dt>
<dd><p>The name of the column in <code>tdl_cycle</code> that contains the 12C signal.</p></dd>


  <dt id="arg-raw-c-colname">raw_13c_colname<a class="anchor" aria-label="anchor" href="#arg-raw-c-colname"></a></dt>
<dd><p>The name of the column in <code>tdl_cycle</code> that contains the 13C signal.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function applies a simple correction to the measured values of 12C and
  13C. This correction is based on the fact that each reference tank has both a
  true concentration (which is known beforehand) and a measured concentration
  (from the TDL) of each isotope. Using this information, it is possible to
  perform a polynomial fit of true vs. measured concentrations; in other words,
  it is possible to identify a polynomial function that determines true
  concentrations from measured ones. This function can then be applied to tanks
  whose concentration is not known beforehand; in this case, it provides an
  estimate of the true concentration, otherwise referred to as a calibrated
  value.</p>
<p>When making dynamic TDL measurements, concentrations from some of the
  reference valves may be logged at multiple time points. In this case, it is
  typical to take an average value from a subset of them.
  <code>process_tdl_cycle_polynomial</code> can handle this situation when its
  <code>reference_tank_time_points</code> input argument is not <code>NA</code>.</p>
<p>This function assumes that <code>tdl_cycle</code> represents a single TDL
  measurement cycle. To process multiple cycles at once, this function is often
  used along with <code><a href="by.exdf.html">by.exdf</a></code> and <code><a href="consolidate.html">consolidate</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with two elements:</p><ul><li><p><code>tdl_data</code>: An <code>exdf</code> object containing the original content
          of <code>tdl_cycle</code> and several new columns:
          <code>'calibrated_12c'</code>, <code>'calibrated_13c'</code>, <code>'total_CO2'</code>,
          and <code>'delta_C13'</code>.</p></li>
<li><p><code>calibration_parameters</code>: An <code>exdf</code> object describing the
          fitted polynomial coefficients.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># An example of a `reference_tank_time_points` list for a situation where there</span></span></span>
<span class="r-in"><span><span class="co"># are just two reference valves (1 and 3)</span></span></span>
<span class="r-in"><span><span class="va">reference_tank_time_points</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>valve <span class="op">=</span> <span class="fl">1</span>, start <span class="op">=</span> <span class="fl">101</span>, end <span class="op">=</span> <span class="fl">300</span><span class="op">)</span>, <span class="co"># Take an average of time points 101 - 300 for valve 1</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>valve <span class="op">=</span> <span class="fl">3</span>, start <span class="op">=</span> <span class="fl">201</span>, end <span class="op">=</span> <span class="fl">300</span><span class="op">)</span>  <span class="co"># Take an average of time points 201 - 300 for valve 3</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward B. Lochocki, Coralie E. Salesse-Smith, Justin M. McGrath.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

