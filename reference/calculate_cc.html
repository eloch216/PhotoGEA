<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Calculates CO2 concentration in the chloroplast, the CO2 drawdown across the
  stomata, and the CO2 drawdown across the mesophyll. This function can
  accomodate alternative column names for the variables taken from the Licor
  file in case they change at some point in the future. This function also
  checks the units of each required column and will produce an error if any
  units are incorrect."><title>calculate_cc — calculate_cc • PhotoGEA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="calculate_cc — calculate_cc"><meta property="og:description" content="Calculates CO2 concentration in the chloroplast, the CO2 drawdown across the
  stomata, and the CO2 drawdown across the mesophyll. This function can
  accomodate alternative column names for the variables taken from the Licor
  file in case they change at some point in the future. This function also
  checks the units of each required column and will produce an error if any
  units are incorrect."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    padding-top: 70px;

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">PhotoGEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/PhotoGEA.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/analyzing_ball_berry_data.html">Analyzing Ball-Berry Data</a>
    <a class="dropdown-item" href="../articles/analyzing_tdl_data.html">Analyzing TDL Data</a>
    <a class="dropdown-item" href="../articles/developing_a_data_analysis_pipeline.html">Developing a Data Analysis Pipeline</a>
    <a class="dropdown-item" href="../articles/working_with_extended_data_frames.html">Working With Extended Data Frames</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/eloch216/PhotoGEA/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>calculate_cc</h1>
      
      <div class="d-none name"><code>calculate_cc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates CO2 concentration in the chloroplast, the CO2 drawdown across the
  stomata, and the CO2 drawdown across the mesophyll. This function can
  accomodate alternative column names for the variables taken from the Licor
  file in case they change at some point in the future. This function also
  checks the units of each required column and will produce an error if any
  units are incorrect.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calculate_cc</span><span class="op">(</span></span>
<span>    <span class="va">licor_exdf</span>,</span>
<span>    a_column_name <span class="op">=</span> <span class="st">'A'</span>,</span>
<span>    ca_column_name <span class="op">=</span> <span class="st">'Ca'</span>,</span>
<span>    ci_column_name <span class="op">=</span> <span class="st">'Ci'</span>,</span>
<span>    gmc_column_name <span class="op">=</span> <span class="st">'gmc'</span>,</span>
<span>    pa_column_name <span class="op">=</span> <span class="st">'Pa'</span>,</span>
<span>    deltapcham_column_name <span class="op">=</span> <span class="st">'DeltaPcham'</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>licor_exdf</dt>
<dd><p>An <code>exdf</code> object representing data from a Licor gas exchange
    measurement system.</p></dd>


  <dt>a_column_name</dt>
<dd><p>The name of the column in <code>licor_exdf</code> that contains the net
    assimilation in <code>micromol m^(-2) s^(-1)</code>.</p></dd>


  <dt>ca_column_name</dt>
<dd><p>The name of the column in <code>licor_exdf</code> that contains the ambient CO2
    concentration in the chamber in <code>micromol mol^(-1)</code>.</p></dd>


  <dt>ci_column_name</dt>
<dd><p>The name of the column in <code>licor_exdf</code> that contains the intercellular
    CO2 concentration in <code>micromol mol^(-1)</code>.</p></dd>


  <dt>gmc_column_name</dt>
<dd><p>The name of the column in <code>licor_exdf</code> that contains the mesophyll
    conductance to CO2 in <code>mol m^(-2) s^(-1) bar^(-1)</code>.</p></dd>


  <dt>pa_column_name</dt>
<dd><p>The name of the column in <code>licor_exdf</code> that contains the atmospheric
    pressure in <code>kPa</code>.</p></dd>


  <dt>deltapcham_column_name</dt>
<dd><p>The name of the column in <code>licor_exdf</code> that contains the chamber
    overpressure in <code>kPa</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For a C3 plant, the mesophyll conductance to CO2 (<code>gmc</code>) is said to be
  the conductance satisfying the following one-dimensional flux-conductance
  equation:</p>
<p>(1) <code>An = gmc * (PCi - PCc)</code></p>
<p>where <code>An</code> is the net CO2 assimilation rate, <code>PCi</code> is the partial
  pressure of CO2 in the intercellular spaces, and <code>PCc</code> is the partial
  pressure of CO2 in the chloroplast. (For a C4 plant, <code>Pcc</code> would be
  replaced by <code>PCm</code>, the partial pressure of CO2 in the mesophyll.) A key
  underlying assumption for this equation is that the flow of CO2 has reached a
  steady state; in this case, the flow across the stomata is equal to the flow
  across the mesophyll.</p>
<p>This equation can be rearranged to calculate <code>PCc</code>:</p>
<p>(2) <code>PCc = PCi - An / gmc</code></p>
<p>This version of the equation can be found in many places, for example, as
  Equation 4 in Sharkey et al. "Fitting photosynthetic carbon dioxide response
  curves for C3 leaves" Plant, Cell &amp; Environment 30, 1035–1040 (2007)
  [<a href="https://doi.org/10.1111/j.1365-3040.2007.01710.x" class="external-link">doi:10.1111/j.1365-3040.2007.01710.x</a>
].</p>
<p>It is common to express the partial pressures in <code>microbar</code> and the
  assimilation rate in <code>micromol m^(-2) s^(-1)</code>; in this case, the units of
  mesophyll conductance become <code>mol m^(-2) s^(-1) bar^(-1)</code>.</p>
<p>Licor measurement systems provide CO2 levels as relative concentrations with
  units of parts per million (<code>ppm</code>), or equivalently,
  <code>micromol mol^(-1)</code>. Concentrations and partial pressures are related by
  the total gas pressure according to:</p>
<p>(3) <code>partial_pressure = total_pressure * relative_concentration</code></p>
<p>Thus, it is also possible to calculate the CO2 concentration in the
  choloroplast (<code>Cc</code>) using the following equation:</p>
<p>(4) <code>Cc = Ci - An / (gmc * P)</code></p>
<p>where <code>Ci</code> is the intercellular CO2 concentration and <code>P</code> is the
  total pressure. In this function, Equation (4) is used to calculate <code>Cc</code>,
  where the total pressure is given by the sum of the atmospheric pressure and
  the chamber overpressure.</p>
<p>When a plant is photosynthesizing, it draws CO2 into its chloroplasts, and
  this flow is driven by a concentration gradient. In other words, as CO2 flows
  from the ambient air across the stomata to the intercellular spaces and then
  across the mesophyll into the chloroplast, there is a decrease in CO2
  concentration at each step. Sometimes it is useful to calculate these changes,
  which are usually referred to as "CO2 drawdown" values. So, in addition to
  <code>Ci</code>, this function also calculates the drawdown across the stomata
  (<code>drawndown_s = Ca - Ci</code>) and the drawdown across the mesophyll
  (<code>drawdown_m = Ci - Cc</code>).</p>
<p>_Note_: mesophyll conductance is not specified in typical Licor files, so it
  usually must be added using <code><a href="set_variable.html">set_variable</a></code> before calling
  <code>calculate_cc</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An <code>exdf</code> object based on <code>licor_exdf</code> that includes the following
  additional columns, calculated as described above: <code>Ci</code>,</p>
<p></p>
<p><code>drawndown_s</code>, and <code>drawdown_m</code>. The category for each of these new
  columns is <code>calculate_cc</code> to indicate that they were created using this
  function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Read an example Licor file included in the PhotoGEA package</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_licor_file.html">read_licor_file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ball_berry_1.xlsx"</span>, package <span class="op">=</span> <span class="st">"PhotoGEA"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  preamble_data_rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">11</span>, <span class="fl">13</span><span class="op">)</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="st">'time'</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Set the mesophyll conductance to 1 mol / m^2 / s / bar</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="set_variable.html">set_variable</a></span><span class="op">(</span><span class="va">licor_file</span>, <span class="st">'gmc'</span>, <span class="st">'mol m^(-2) s^(-1) bar^(-1)'</span>, value <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate Cc and drawdowns</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu">calculate_cc</span><span class="op">(</span><span class="va">licor_file</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">licor_file</span><span class="op">$</span><span class="va">units</span><span class="op">$</span><span class="va">Cc</span>      <span class="co"># View the units of the new `Cc` column</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "micromol mol^(-1)"</span>
<span class="r-in"><span><span class="va">licor_file</span><span class="op">$</span><span class="va">categories</span><span class="op">$</span><span class="va">Cc</span> <span class="co"># View the category of the new `Cc` column</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "calculate_cc"</span>
<span class="r-in"><span><span class="va">licor_file</span><span class="op">[</span>, <span class="st">'Cc'</span><span class="op">]</span>       <span class="co"># View the values of the new `Cc` column</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 216.5128 257.7110 231.1340 208.2051 261.8719 286.6935 346.7131 266.8860</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9] 276.4449 273.5312 316.1661 287.6186 307.7915 340.4040 236.9847 283.9512</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17] 293.8102 284.9079 322.5466 242.3728 323.0196 206.8106 219.7376 236.6592</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25] 270.8341 306.0797 299.8268 247.3581</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Edward B. Lochocki.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

