<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Check response curve data for common issues — check_response_curve_data • PhotoGEA</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Check response curve data for common issues — check_response_curve_data"><meta name="description" content="Checks to make sure an exdf object representing multiple
  response curves meets basic expectations."><meta property="og:description" content="Checks to make sure an exdf object representing multiple
  response curves meets basic expectations."><meta property="og:image" content="https://eloch216.github.io/PhotoGEA/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    padding-top: 70px;

    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PhotoGEA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/PhotoGEA.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-user-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">User Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-user-guides"><li><h6 class="dropdown-header" data-toc-skip>ANALYSIS GUIDES</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/analyzing_ball_berry_data.html">Analyzing Ball-Berry Data</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_c3_aci_curves.html">Analyzing C3 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_c4_aci_curves.html">Analyzing C4 A-Ci Curves</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_gm_data.html">Analyzing Mesophyll Conductance Data</a></li>
    <li><a class="dropdown-item" href="../articles/analyzing_tdl_data.html">Analyzing TDL Data</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>GENERAL PHOTOGEA ADVICE</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/combining_with_other_packages.html">Combining PhotoGEA With Other Packages</a></li>
    <li><a class="dropdown-item" href="../articles/creating_your_own_processing_tools.html">Creating Your Own Processing Tools</a></li>
    <li><a class="dropdown-item" href="../articles/developing_a_data_analysis_pipeline.html">Developing a Data Analysis Pipeline</a></li>
    <li><a class="dropdown-item" href="../articles/working_with_extended_data_frames.html">Working With Extended Data Frames</a></li>
    <li><a class="dropdown-item" href="../articles/frequent_questions.html">Frequently Asked Questions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>GENERAL GAS EXCHANGE ADVICE</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/LI6800_user_constants.html">Guide to Licor LI-6800 User Constants</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/publications.html">Publications</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/eloch216/PhotoGEA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Check response curve data for common issues</h1>

      <div class="d-none name"><code>check_response_curve_data.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Checks to make sure an <code><a href="exdf.html">exdf</a></code> object representing multiple
  response curves meets basic expectations.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">check_response_curve_data</span><span class="op">(</span></span>
<span>    <span class="va">licor_exdf</span>,</span>
<span>    <span class="va">identifier_columns</span>,</span>
<span>    expected_npts <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    driving_column <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    driving_column_tolerance <span class="op">=</span> <span class="fl">1.0</span>,</span>
<span>    col_to_ignore_for_inf <span class="op">=</span> <span class="st">'gmc'</span>,</span>
<span>    error_on_failure <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    print_information <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-licor-exdf">licor_exdf<a class="anchor" aria-label="anchor" href="#arg-licor-exdf"></a></dt>
<dd><p>An <code>exdf</code> object representing data from a Licor gas exchange
    measurement system.</p></dd>


  <dt id="arg-identifier-columns">identifier_columns<a class="anchor" aria-label="anchor" href="#arg-identifier-columns"></a></dt>
<dd><p>A vector or list of strings representing the names of columns in
    <code>licor_exdf</code> that, taken together, uniquely identify each curve. This
    often includes names like <code>plot</code>, <code>event</code>, <code>replicate</code>, etc.</p></dd>


  <dt id="arg-expected-npts">expected_npts<a class="anchor" aria-label="anchor" href="#arg-expected-npts"></a></dt>
<dd><p>The number of points that should be in each response curve. If
    <code>expected_npts</code> is set to 0, then all response curves are expected to
    have the same (unspecified) number of points. If <code>expected_npts</code> is set
    to a negative number, then this check will be skipped.</p></dd>


  <dt id="arg-driving-column">driving_column<a class="anchor" aria-label="anchor" href="#arg-driving-column"></a></dt>
<dd><p>The name of a column that is systematically varied to produce each curve;
    for example, in a light response curve, this would typically by <code>Qin</code>.
    If <code>driving_column</code> is <code>NULL</code>, then this check will be skipped.</p></dd>


  <dt id="arg-driving-column-tolerance">driving_column_tolerance<a class="anchor" aria-label="anchor" href="#arg-driving-column-tolerance"></a></dt>
<dd><p>An absolute tolerance for the deviation of each value of
    <code>driving_column</code> away from its mean across all the curves; the
    <code>driving_column_tolerance</code> can be set to <code>Inf</code> to disable this
    check.</p></dd>


  <dt id="arg-col-to-ignore-for-inf">col_to_ignore_for_inf<a class="anchor" aria-label="anchor" href="#arg-col-to-ignore-for-inf"></a></dt>
<dd><p>Any columns to ignore while checking for infinite values. Mesophyll
    conductance (<code>gmc</code>) is often set to infinity intentionally so should be
    ignored when performing this check. To completely disable this check, set
    <code>col_to_ignore_for_inf</code> to <code>NULL</code>.</p></dd>


  <dt id="arg-error-on-failure">error_on_failure<a class="anchor" aria-label="anchor" href="#arg-error-on-failure"></a></dt>
<dd><p>A logical value indicating whether to send an error message when an issue is
    detected. See details below.</p></dd>


  <dt id="arg-print-information">print_information<a class="anchor" aria-label="anchor" href="#arg-print-information"></a></dt>
<dd><p>A logical value indicating whether to print additional information to the R
    terminal when an issue is detected. See details below.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function makes a few basic checks to ensure that the Licor data includes
  the expected information and does not include any mistakes. If no problems are
  detected, this function will be silent with no return value. If a problem is
  detected and <code>error_on_failure</code> is <code>TRUE</code>, then this function will
  throw an error with a short message; if <code>error_on_failure</code> is
  <code>FALSE</code>, then this function will throw a warning instead. If a problem is
  detected and <code>print_information</code> is <code>TRUE</code>, additional information
  about the problem will be printed to the R terminal.</p>
<p>This function will perform the following checks, some of which are optional:</p><ul><li><p>If <code>col_to_ignore_for_inf</code> is not <code>NULL</code>, no numeric columns
          in <code>licor_exdf</code> should have infinite values, with the exception
          of columns designated in <code>col_to_ignore_for_inf</code>.</p></li>
<li><p>All elements of <code>identifier_columns</code> should be present as columns
          in <code>licor_exdf</code>. If <code>driving_column</code> is not <code>NULL</code>, it
          should also be present as a column in <code>licor_exdf</code>.</p></li>
<li><p><code>licor_exdf</code> will be split into chunks according to the values of
          its <code>identifier_columns</code>. If this <code>exdf</code> file represents
          response curves, then each chunk should represent a single curve and a
          few additional checks can be performed:</p><ul><li><p>If <code>expected_npts &gt;= 0</code>, then each chunk should have the
                  same number of points. If <code>expected_npts &gt; 0</code>, then each
                  chunk should have <code>expected_npts</code> points.</p></li>
<li><p>If <code>driving_column</code> is not <code>NULL</code>, then each code
                  chunk should have the same sequence of values in this column.
                  To allow for small variations, a nonzero
                  <code>driving_column_tolerance</code> can be specified.</p></li>
</ul></li>
</ul><p>Using <code>check_response_curve_data</code> is not strictly necessary, but it can
  be helpful both to you and to anyone else reading your analysis code. Here are
  a few typical use cases:</p><ul><li><p><strong>Average response curves:</strong> It is common to calculate and plot
          average response curves, either manually or by using
          <code><a href="xyplot_avg_rc.html">xyplot_avg_rc</a></code>. But, it only makes sense to do this if
          each curve followed the same sequence of the driving variable. In this
          case, <code>check_response_curve_data</code> can be used to confirm that
          each curve used the same values of <code>CO2_r_sp</code> (for an A-Ci curve)
          or <code>Qin</code> (for an A-Q curve).</p></li>
<li><p><strong>Removing recovery points:</strong> It is common to wish to remove one
          or more recovery points from a set of curves. The safest way to do
          this is to confirm that all the curves use the same sequence of
          setpoints; then you can be sure that, for example, points 9 and 10 are
          the recovery points in every curve.</p></li>
<li><p><strong>Making a statement of expectations:</strong> If you measured a set of
          A-Ci curves where each curve has 16 points and used the same sequence
          of <code>CO2_r</code> setpoints, you could record this somewhere in your
          notes. But it would be even more meaningful to use
          <code>check_response_curve_data</code> in your script with
          <code>expected_npts</code> set to 16. If this check passes, then it means
          not only that your claim is correct, but also that the identifier
          columns are being interpreted properly.</p></li>
</ul><p>Sometimes the response curves in a large data set were not all measured with
  the same sequence of setpoints. If only a few different sequences were used,
  it is possible to split them into groups and separately run
  <code>check_response_curve_data</code> on each group. This scenario is discussed in
  the Frequently Asked Questions vignette.</p>
<p>Even if none of the above situations are relevant to you, it may still be
  helpful to run <code>run check_response_curve_data</code> but with
  <code>expected_npts</code> set to 0 and <code>error_on_failure</code> set to <code>FALSE</code>.
  With these settings, if there are curves with different numbers of points, the
  function will print the number of points in each curve to the R terminal, but
  won't stop the rest of the script from running. This can be useful for
  detecting problems with the <code>curve_identifier</code> column. For example, if
  the longest curves in the set are known to have 17 points, but
  <code>check_response_curve_data</code> identifies a curve with 34 points, it is
  clear that the same identifier was accidentally used for two different curves.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The <code>check_response_curve_data</code> function does not return anything.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Read an example Licor file included in the PhotoGEA package and check it.</span></span></span>
<span class="r-in"><span><span class="co"># This file includes several 7-point light-response curves that can be uniquely</span></span></span>
<span class="r-in"><span><span class="co"># identified by the values of its 'species' and 'plot' columns. Since these are</span></span></span>
<span class="r-in"><span><span class="co"># light-response curves, each one follows a pre-set sequence of `Qin` values.</span></span></span>
<span class="r-in"><span><span class="va">licor_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_gasex_file.html">read_gasex_file</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="PhotoGEA_example_file_path.html">PhotoGEA_example_file_path</a></span><span class="op">(</span><span class="st">'ball_berry_1.xlsx'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Make sure there are no infinite values and that all curves have the same</span></span></span>
<span class="r-in"><span><span class="co"># number of points</span></span></span>
<span class="r-in"><span><span class="fu">check_response_curve_data</span><span class="op">(</span><span class="va">licor_file</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'species'</span>, <span class="st">'plot'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Make sure there are no inifinite values and that all curves have 7 points</span></span></span>
<span class="r-in"><span><span class="fu">check_response_curve_data</span><span class="op">(</span><span class="va">licor_file</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'species'</span>, <span class="st">'plot'</span><span class="op">)</span>, <span class="fl">7</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Make sure there are no infinite values, that all curves have 7 points, and</span></span></span>
<span class="r-in"><span><span class="co"># that the values of the `Qin` column follow the same sequence in all curves</span></span></span>
<span class="r-in"><span><span class="co"># (to within 1.0 micromol / m^2 / s)</span></span></span>
<span class="r-in"><span><span class="fu">check_response_curve_data</span><span class="op">(</span><span class="va">licor_file</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'species'</span>, <span class="st">'plot'</span><span class="op">)</span>, <span class="fl">7</span>, <span class="st">'Qin'</span>, <span class="fl">1.0</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edward B. Lochocki, Coralie E. Salesse-Smith, Justin M. McGrath.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

